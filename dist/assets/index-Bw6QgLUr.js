import{r as O,a as In,g as Dn,c as ue,R as Q,b as Ln}from"./vendor-CyBwq7db.js";import{u as gi,N as Mt,a as qs,L as pi,O as Un,B as Mn,R as Bn,b as ye}from"./router-CMxrBoBO.js";import{C as at,a as _t,L as Nt,B as xi,p as kt,b as ot,c as lt,A as yi,d as Ns,D as qn,P as Vn,e as Vs,f as Ws,g as zs}from"./charts-DYWOA8Ov.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();var bi={exports:{}},Jt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wn=O,zn=Symbol.for("react.element"),Hn=Symbol.for("react.fragment"),Kn=Object.prototype.hasOwnProperty,Gn=Wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Jn={key:!0,ref:!0,__self:!0,__source:!0};function vi(r,e,t){var s,n={},a=null,o=null;t!==void 0&&(a=""+t),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)Kn.call(e,s)&&!Jn.hasOwnProperty(s)&&(n[s]=e[s]);if(r&&r.defaultProps)for(s in e=r.defaultProps,e)n[s]===void 0&&(n[s]=e[s]);return{$$typeof:zn,type:r,key:a,ref:o,props:n,_owner:Gn.current}}Jt.Fragment=Hn;Jt.jsx=vi;Jt.jsxs=vi;bi.exports=Jt;var i=bi.exports,wi,vr=In;wi=vr.createRoot,vr.hydrateRoot;const Yn="modulepreload",Zn=function(r){return"/"+r},wr={},St=function(e,t,s){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=Promise.allSettled(t.map(c=>{if(c=Zn(c),c in wr)return;wr[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":Yn,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((m,y)=>{h.addEventListener("load",m),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return n.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})},Qn=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>St(async()=>{const{default:s}=await Promise.resolve().then(()=>ct);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class Hs extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class Xn extends Hs{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class jr extends Hs{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class _r extends Hs{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ks;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(ks||(ks={}));var ea=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};class ta{constructor(e,{headers:t={},customFetch:s,region:n=ks.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=Qn(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return ea(this,void 0,void 0,function*(){try{const{headers:n,method:a,body:o}=t;let l={},{region:c}=t;c||(c=this.region);const d=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let u;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(d.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),n),body:u}).catch(b=>{throw new Xn(b)}),m=h.headers.get("x-relay-error");if(m&&m==="true")throw new jr(h);if(!h.ok)throw new _r(h);let y=((s=h.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),w;return y==="application/json"?w=yield h.json():y==="application/octet-stream"?w=yield h.blob():y==="text/event-stream"?w=h:y==="multipart/form-data"?w=yield h.formData():w=yield h.text(),{data:w,error:null,response:h}}catch(n){return{data:null,error:n,response:n instanceof _r||n instanceof jr?n.context:void 0}}})}}var le={},Ks={},Yt={},Et={},Zt={},Qt={},sa=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},nt=sa();const ra=nt.fetch,ji=nt.fetch.bind(nt),_i=nt.Headers,ia=nt.Request,na=nt.Response,ct=Object.freeze(Object.defineProperty({__proto__:null,Headers:_i,Request:ia,Response:na,default:ji,fetch:ra},Symbol.toStringTag,{value:"Module"})),aa=Dn(ct);var Xt={};Object.defineProperty(Xt,"__esModule",{value:!0});let oa=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Xt.default=oa;var Ni=ue&&ue.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Qt,"__esModule",{value:!0});const la=Ni(aa),ca=Ni(Xt);let da=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=la.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var o,l,c;let d=null,u=null,h=null,m=a.status,y=a.statusText;if(a.ok){if(this.method!=="HEAD"){const j=await a.text();j===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=j:u=JSON.parse(j))}const b=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),N=(l=a.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");b&&N&&N.length>1&&(h=parseInt(N[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(d={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,m=406,y="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const b=await a.text();try{d=JSON.parse(b),Array.isArray(d)&&a.status===404&&(u=[],d=null,m=200,y="OK")}catch{a.status===404&&b===""?(m=204,y="No Content"):d={message:b}}if(d&&this.isMaybeSingle&&(!((c=d==null?void 0:d.details)===null||c===void 0)&&c.includes("0 rows"))&&(d=null,m=200,y="OK"),d&&this.shouldThrowOnError)throw new ca.default(d)}return{error:d,data:u,count:h,status:m,statusText:y}});return this.shouldThrowOnError||(n=n.catch(a=>{var o,l,c;return{error:{message:`${(o=a==null?void 0:a.name)!==null&&o!==void 0?o:"FetchError"}: ${a==null?void 0:a.message}`,details:`${(l=a==null?void 0:a.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=a==null?void 0:a.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),n.then(e,t)}returns(){return this}overrideTypes(){return this}};Qt.default=da;var ua=ue&&ue.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Zt,"__esModule",{value:!0});const ha=ua(Qt);let fa=class extends ha.default{select(e){let t=!1;const s=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:n,referencedTable:a=n}={}){const o=a?`${a}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const n=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:n=s}={}){const a=typeof n>"u"?"offset":`${n}.offset`,o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:n=!1,wal:a=!1,format:o="text"}={}){var l;const c=[e?"analyze":null,t?"verbose":null,s?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${d}"; options=${c};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Zt.default=fa;var ma=ue&&ue.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Et,"__esModule",{value:!0});const ga=ma(Zt);let pa=class extends ga.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:n}={}){let a="";n==="plain"?a="pl":n==="phrase"?a="ph":n==="websearch"&&(a="w");const o=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${a}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const n=s?`${s}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};Et.default=pa;var xa=ue&&ue.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Yt,"__esModule",{value:!0});const ht=xa(Et);let ya=class{constructor(e,{headers:t={},schema:s,fetch:n}){this.url=e,this.headers=t,this.schema=s,this.fetch=n}select(e,{head:t=!1,count:s}={}){const n=t?"HEAD":"GET";let a=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),s&&(this.headers.Prefer=`count=${s}`),new ht.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const n="POST",a=[];if(this.headers.Prefer&&a.push(this.headers.Prefer),t&&a.push(`count=${t}`),s||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const o=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new ht.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:n,defaultToNull:a=!0}={}){const o="POST",l=[`resolution=${s?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&l.push(this.headers.Prefer),n&&l.push(`count=${n}`),a||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const c=e.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new ht.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s="PATCH",n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),this.headers.Prefer=n.join(","),new ht.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new ht.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Yt.default=ya;var es={},ts={};Object.defineProperty(ts,"__esModule",{value:!0});ts.version=void 0;ts.version="0.0.0-automated";Object.defineProperty(es,"__esModule",{value:!0});es.DEFAULT_HEADERS=void 0;const ba=ts;es.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${ba.version}`};var ki=ue&&ue.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ks,"__esModule",{value:!0});const va=ki(Yt),wa=ki(Et),ja=es;let _a=class Si{constructor(e,{headers:t={},schema:s,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},ja.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=n}from(e){const t=new URL(`${this.url}/${e}`);return new va.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Si(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:n=!1,count:a}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let c;s||n?(o=s?"HEAD":"GET",Object.entries(t).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{l.searchParams.append(u,h)})):(o="POST",c=t);const d=Object.assign({},this.headers);return a&&(d.Prefer=`count=${a}`),new wa.default({method:o,url:l,headers:d,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};Ks.default=_a;var dt=ue&&ue.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(le,"__esModule",{value:!0});le.PostgrestError=le.PostgrestBuilder=le.PostgrestTransformBuilder=le.PostgrestFilterBuilder=le.PostgrestQueryBuilder=le.PostgrestClient=void 0;const Ei=dt(Ks);le.PostgrestClient=Ei.default;const Ci=dt(Yt);le.PostgrestQueryBuilder=Ci.default;const Ti=dt(Et);le.PostgrestFilterBuilder=Ti.default;const Ai=dt(Zt);le.PostgrestTransformBuilder=Ai.default;const Oi=dt(Qt);le.PostgrestBuilder=Oi.default;const $i=dt(Xt);le.PostgrestError=$i.default;var Na=le.default={PostgrestClient:Ei.default,PostgrestQueryBuilder:Ci.default,PostgrestFilterBuilder:Ti.default,PostgrestTransformBuilder:Ai.default,PostgrestBuilder:Oi.default,PostgrestError:$i.default};const{PostgrestClient:ka,PostgrestQueryBuilder:$d,PostgrestFilterBuilder:Pd,PostgrestTransformBuilder:Fd,PostgrestBuilder:Rd,PostgrestError:Id}=Na;class Sa{static dynamicRequire(e){try{return typeof process<"u"&&process.versions&&process.versions.node&&typeof require<"u"?require(e):null}catch{return null}}static detectEnvironment(){var e,t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const s=parseInt(process.versions.node.split(".")[0]);if(s>=22)try{if(typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};const n=this.dynamicRequire("undici");if(n&&n.WebSocket)return{type:"native",constructor:n.WebSocket};throw new Error("undici not available")}catch{return{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:'Install the "ws" package or check your Node.js installation.'}}try{const n=this.dynamicRequire("ws");if(n)return{type:"ws",constructor:(t=n.WebSocket)!==null&&t!==void 0?t:n};throw new Error("ws package not available")}catch{return{type:"unsupported",error:`Node.js ${s} detected without WebSocket support.`,workaround:'Install the "ws" package: npm install ws'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const s=this.getWebSocketConstructor();return new s(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Ea="2.15.0",Ca=`realtime-js/${Ea}`,Ta="1.0.0",Ss=1e4,Aa=1e3,Oa=100;var pt;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(pt||(pt={}));var J;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(J||(J={}));var fe;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(fe||(fe={}));var Es;(function(r){r.websocket="websocket"})(Es||(Es={}));var Be;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(Be||(Be={}));class $a{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const n=t.getUint8(1),a=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=s.decode(e.slice(o,o+n));o=o+n;const c=s.decode(e.slice(o,o+a));o=o+a;const d=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class Pi{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var V;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(V||(V={}));const Nr=(r,e,t={})=>{var s;const n=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((a,o)=>(a[o]=Pa(o,r,e,n),a),{})},Pa=(r,e,t,s)=>{const n=e.find(l=>l.name===r),a=n==null?void 0:n.type,o=t[r];return a&&!s.includes(a)?Fi(a,o):Cs(o)},Fi=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return Da(e,t)}switch(r){case V.bool:return Fa(e);case V.float4:case V.float8:case V.int2:case V.int4:case V.int8:case V.numeric:case V.oid:return Ra(e);case V.json:case V.jsonb:return Ia(e);case V.timestamp:return La(e);case V.abstime:case V.date:case V.daterange:case V.int4range:case V.int8range:case V.money:case V.reltime:case V.text:case V.time:case V.timestamptz:case V.timetz:case V.tsrange:case V.tstzrange:return Cs(e);default:return Cs(e)}},Cs=r=>r,Fa=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Ra=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},Ia=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},Da=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,s=r[t];if(r[0]==="{"&&s==="}"){let a;const o=r.slice(1,t);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>Fi(e,l))}return r},La=r=>typeof r=="string"?r.replace(" ","T"):r,Ri=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class hs{constructor(e,t,s={},n=Ss){this.channel=e,this.event=t,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var kr;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(kr||(kr={}));class xt{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=xt.syncState(this.state,n,a,o),this.pendingDiffs.forEach(c=>{this.state=xt.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},n=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=xt.syncDiff(this.state,n,a,o),l())}),this.onJoin((n,a,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:o})}),this.onLeave((n,a,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,n){const a=this.cloneDeep(e),o=this.transformState(t),l={},c={};return this.map(a,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const h=a[d];if(h){const m=u.map(N=>N.presence_ref),y=h.map(N=>N.presence_ref),w=u.filter(N=>y.indexOf(N.presence_ref)<0),b=h.filter(N=>m.indexOf(N.presence_ref)<0);w.length>0&&(l[d]=w),b.length>0&&(c[d]=b)}else l[d]=u}),this.syncDiff(a,{joins:l,leaves:c},s,n)}static syncDiff(e,t,s,n){const{joins:a,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(a,(l,c)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),u.length>0){const h=e[l].map(y=>y.presence_ref),m=u.filter(y=>h.indexOf(y.presence_ref)<0);e[l].unshift(...m)}s(l,u,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),e[l]=d,n(l,d,c),d.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const n=e[s];return"metas"in n?t[s]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[s]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Sr;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(Sr||(Sr={}));var yt;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(yt||(yt={}));var Ee;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Ee||(Ee={}));class Gs{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=J.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new hs(this,fe.join,this.params,this.timeout),this.rejoinTimer=new Pi(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=J.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=J.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this._on(fe.reply,{},(n,a)=>{this._trigger(this._replyEventName(a),n)}),this.presence=new xt(this),this.broadcastEndpointURL=Ri(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.state==J.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,c=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(m=>m.filter))!==null&&n!==void 0?n:[],d=!!this.bindings[yt.PRESENCE]&&this.bindings[yt.PRESENCE].length>0,u={},h={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:d}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(m=>e==null?void 0:e(Ee.CHANNEL_ERROR,m)),this._onClose(()=>e==null?void 0:e(Ee.CLOSED)),this.updateJoinPayload(Object.assign({config:h},u)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:m})=>{var y;if(this.socket.setAuth(),m===void 0){e==null||e(Ee.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,b=(y=w==null?void 0:w.length)!==null&&y!==void 0?y:0,N=[];for(let j=0;j<b;j++){const x=w[j],{filter:{event:v,schema:C,table:A,filter:$}}=x,F=m&&m[j];if(F&&F.event===v&&F.schema===C&&F.table===A&&F.filter===$)N.push(Object.assign(Object.assign({},x),{id:F.id}));else{this.unsubscribe(),this.state=J.errored,e==null||e(Ee.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=N,e&&e(Ee.SUBSCRIBED);return}}).receive("error",m=>{this.state=J.errored,e==null||e(Ee.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Ee.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===J.joined&&e===yt.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,s)}async send(e,t={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=d.body)===null||n===void 0?void 0:n.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),d.receive("ok",()=>a("ok")),d.receive("error",()=>a("error")),d.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=J.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(fe.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new hs(this,fe.leave,{},e),s.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=J.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const n=new AbortController,a=setTimeout(()=>n.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(a),o}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new hs(this,e,t,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Oa){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var n,a;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=fe;if(s&&[l,c,d,u].indexOf(o)>=0&&s!==this._joinRef())return;let m=this._onMessage(o,t,s);if(t&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(y=>{var w,b,N;return((w=y.filter)===null||w===void 0?void 0:w.event)==="*"||((N=(b=y.filter)===null||b===void 0?void 0:b.event)===null||N===void 0?void 0:N.toLocaleLowerCase())===o}).map(y=>y.callback(m,s)):(a=this.bindings[o])===null||a===void 0||a.filter(y=>{var w,b,N,j,x,v;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in y){const C=y.id,A=(w=y.filter)===null||w===void 0?void 0:w.event;return C&&((b=t.ids)===null||b===void 0?void 0:b.includes(C))&&(A==="*"||(A==null?void 0:A.toLocaleLowerCase())===((N=t.data)===null||N===void 0?void 0:N.type.toLocaleLowerCase()))}else{const C=(x=(j=y==null?void 0:y.filter)===null||j===void 0?void 0:j.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return C==="*"||C===((v=t==null?void 0:t.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===o}).map(y=>{if(typeof m=="object"&&"ids"in m){const w=m.data,{schema:b,table:N,commit_timestamp:j,type:x,errors:v}=w;m=Object.assign(Object.assign({},{schema:b,table:N,commit_timestamp:j,eventType:x,new:{},old:{},errors:v}),this._getPayloadRecords(w))}y.callback(m,s)})}_isClosed(){return this.state===J.closed}_isJoined(){return this.state===J.joined}_isJoining(){return this.state===J.joining}_isLeaving(){return this.state===J.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const n=e.toLocaleLowerCase(),a={type:n,filter:t,callback:s};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&Gs.isEqual(n.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(fe.close,{},e)}_onError(e){this._on(fe.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=J.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Nr(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Nr(e.columns,e.old_record)),t}}const Er=()=>{},$t={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Ua=[1e3,2e3,5e3,1e4],Ma=1e4,Ba=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class qa{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ss,this.transport=null,this.heartbeatIntervalMs=$t.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Er,this.ref=0,this.reconnectTimer=null,this.logger=Er,this.conn=null,this.sendBuffer=[],this.serializer=new $a,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>{let a;return n?a=n:typeof fetch>"u"?a=(...o)=>St(async()=>{const{default:l}=await Promise.resolve().then(()=>ct);return{default:l}},void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...o)=>a(...o)},!(!((s=t==null?void 0:t.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Es.websocket}`,this.httpEndpoint=Ri(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Sa.createWebSocket(this.endpointURL())}catch(e){throw this._setConnectionState("disconnected"),new Error(`WebSocket not available: ${e.message}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Ta}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case pt.connecting:return Be.Connecting;case pt.open:return Be.Open;case pt.closing:return Be.Closing;default:return Be.Closed}}isConnected(){return this.connectionState()===Be.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(a=>a.topic===s);if(n)return n;{const a=new Gs(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:s,payload:n,ref:a}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${s} (${a})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Aa,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},$t.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:n,payload:a,ref:o}=t,l=o?`(${o})`:"",c=a.status||"";this.log("receive",`${c} ${s} ${n} ${l}`.trim(),a),this.channels.filter(d=>d._isMember(s)).forEach(d=>d._trigger(n,a,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(fe.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${s}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([Ba],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const n={access_token:t,version:Ca};t&&s.updateJoinPayload(n),s.joinedOnce&&s._isJoined()&&s._push(fe.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new Pi(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},$t.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,n,a,o,l,c,d;if(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:Ss,this.heartbeatIntervalMs=(n=e==null?void 0:e.heartbeatIntervalMs)!==null&&n!==void 0?n:$t.HEARTBEAT_INTERVAL,this.worker=(a=e==null?void 0:e.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e==null?void 0:e.reconnectAfterMs)!==null&&l!==void 0?l:u=>Ua[u-1]||Ma,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(u,h)=>h(JSON.stringify(u)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Js extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Z(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class Va extends Js{constructor(e,t,s){super(e),this.name="StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Ts extends Js{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Wa=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const Ii=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>St(async()=>{const{default:s}=await Promise.resolve().then(()=>ct);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},za=()=>Wa(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield St(()=>Promise.resolve().then(()=>ct),void 0)).Response:Response}),As=r=>{if(Array.isArray(r))return r.map(t=>As(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,s])=>{const n=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[n]=As(s)}),e},Ha=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)};var He=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const fs=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Ka=(r,e,t)=>He(void 0,void 0,void 0,function*(){const s=yield za();r instanceof s&&!(t!=null&&t.noResolveJson)?r.json().then(n=>{const a=r.status||500,o=(n==null?void 0:n.statusCode)||a+"";e(new Va(fs(n),a,o))}).catch(n=>{e(new Ts(fs(n),n))}):e(new Ts(fs(r),r))}),Ga=(r,e,t,s)=>{const n={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"||!s?n:(Ha(s)?(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s)):n.body=s,Object.assign(Object.assign({},n),t))};function Ct(r,e,t,s,n,a){return He(this,void 0,void 0,function*(){return new Promise((o,l)=>{r(t,Ga(e,s,n,a)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>Ka(c,l,s))})})}function Bt(r,e,t,s){return He(this,void 0,void 0,function*(){return Ct(r,"GET",e,t,s)})}function Ce(r,e,t,s,n){return He(this,void 0,void 0,function*(){return Ct(r,"POST",e,s,n,t)})}function Os(r,e,t,s,n){return He(this,void 0,void 0,function*(){return Ct(r,"PUT",e,s,n,t)})}function Ja(r,e,t,s){return He(this,void 0,void 0,function*(){return Ct(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function Di(r,e,t,s,n){return He(this,void 0,void 0,function*(){return Ct(r,"DELETE",e,s,n,t)})}var ie=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const Ya={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Cr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Za{constructor(e,t={},s,n){this.url=e,this.headers=t,this.bucketId=s,this.fetch=Ii(n)}uploadOrUpdate(e,t,s,n){return ie(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},Cr),n);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&s instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",s)):typeof FormData<"u"&&s instanceof FormData?(a=s,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c))):(a=s,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),n!=null&&n.headers&&(l=Object.assign(Object.assign({},l),n.headers));const d=this._removeEmptyFolders(t),u=this._getFinalPath(d),h=yield(e=="PUT"?Os:Ce)(this.fetch,`${this.url}/object/${u}`,a,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:h.Id,fullPath:h.Key},error:null}}catch(a){if(Z(a))return{data:null,error:a};throw a}})}upload(e,t,s){return ie(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,n){return ie(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let c;const d=Object.assign({upsert:Cr.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",d.cacheControl)):(c=s,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield Os(this.fetch,l.toString(),c,{headers:u});return{data:{path:a,fullPath:h.Key},error:null}}catch(c){if(Z(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return ie(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);t!=null&&t.upsert&&(n["x-upsert"]="true");const a=yield Ce(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new Js("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(s){if(Z(s))return{data:null,error:s};throw s}})}update(e,t,s){return ie(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return ie(this,void 0,void 0,function*(){try{return{data:yield Ce(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Z(n))return{data:null,error:n};throw n}})}copy(e,t,s){return ie(this,void 0,void 0,function*(){try{return{data:{path:(yield Ce(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Z(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,s){return ie(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),a=yield Ce(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(n){if(Z(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,s){return ie(this,void 0,void 0,function*(){try{const n=yield Ce(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(n){if(Z(n))return{data:null,error:n};throw n}})}download(e,t){return ie(this,void 0,void 0,function*(){const n=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=a?`?${a}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Bt(this.fetch,`${this.url}/${n}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(Z(l))return{data:null,error:l};throw l}})}info(e){return ie(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield Bt(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:As(s),error:null}}catch(s){if(Z(s))return{data:null,error:s};throw s}})}exists(e){return ie(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Ja(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(Z(s)&&s instanceof Ts){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),n=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&n.push(a);const l=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});c!==""&&n.push(c);let d=n.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${d}`)}}}remove(e){return ie(this,void 0,void 0,function*(){try{return{data:yield Di(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Z(t))return{data:null,error:t};throw t}})}list(e,t,s){return ie(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Ya),t),{prefix:e||""});return{data:yield Ce(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(Z(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Qa="2.10.4",Xa={"X-Client-Info":`storage-js/${Qa}`};var Je=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};class eo{constructor(e,t={},s,n){const a=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},Xa),t),this.fetch=Ii(s)}listBuckets(){return Je(this,void 0,void 0,function*(){try{return{data:yield Bt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Z(e))return{data:null,error:e};throw e}})}getBucket(e){return Je(this,void 0,void 0,function*(){try{return{data:yield Bt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Z(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Je(this,void 0,void 0,function*(){try{return{data:yield Ce(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Z(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return Je(this,void 0,void 0,function*(){try{return{data:yield Os(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Z(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Je(this,void 0,void 0,function*(){try{return{data:yield Ce(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Z(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Je(this,void 0,void 0,function*(){try{return{data:yield Di(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Z(t))return{data:null,error:t};throw t}})}}class to extends eo{constructor(e,t={},s,n){super(e,t,s,n)}from(e){return new Za(this.url,this.headers,e,this.fetch)}}const so="2.54.0";let gt="";typeof Deno<"u"?gt="deno":typeof document<"u"?gt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?gt="react-native":gt="node";const ro={"X-Client-Info":`supabase-js-${gt}/${so}`},io={headers:ro},no={schema:"public"},ao={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},oo={};var lo=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const co=r=>{let e;return r?e=r:typeof fetch>"u"?e=ji:e=fetch,(...t)=>e(...t)},uo=()=>typeof Headers>"u"?_i:Headers,ho=(r,e,t)=>{const s=co(t),n=uo();return(a,o)=>lo(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:r;let d=new n(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",r),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),s(a,Object.assign(Object.assign({},o),{headers:d}))})};var fo=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};function mo(r){return r.endsWith("/")?r:r+"/"}function go(r,e){var t,s;const{db:n,auth:a,realtime:o,global:l}=r,{db:c,auth:d,realtime:u,global:h}=e,m={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},d),a),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(t=h==null?void 0:h.headers)!==null&&t!==void 0?t:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>fo(this,void 0,void 0,function*(){return""})};return r.accessToken?m.accessToken=r.accessToken:delete m.accessToken,m}const Li="2.71.1",st=30*1e3,$s=3,ms=$s*st,po="http://localhost:9999",xo="supabase.auth.token",yo={"X-Client-Info":`gotrue-js/${Li}`},Ps="X-Supabase-Api-Version",Ui={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},bo=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,vo=10*60*1e3;class Ys extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function P(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class wo extends Ys{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function jo(r){return P(r)&&r.name==="AuthApiError"}class Mi extends Ys{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Re extends Ys{constructor(e,t,s,n){super(e,s,n),this.name=t,this.status=s}}class Oe extends Re{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function _o(r){return P(r)&&r.name==="AuthSessionMissingError"}class Pt extends Re{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ft extends Re{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Rt extends Re{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function No(r){return P(r)&&r.name==="AuthImplicitGrantRedirectError"}class Tr extends Re{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Fs extends Re{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function gs(r){return P(r)&&r.name==="AuthRetryableFetchError"}class Ar extends Re{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class Rs extends Re{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const qt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Or=` 	
\r=`.split(""),ko=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<Or.length;e+=1)r[Or[e].charCodeAt(0)]=-2;for(let e=0;e<qt.length;e+=1)r[qt[e].charCodeAt(0)]=e;return r})();function $r(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(qt[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(qt[s]),e.queuedBits-=6}}function Bi(r,e,t){const s=ko[r];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function Pr(r){const e=[],t=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},a=o=>{Co(o,s,t)};for(let o=0;o<r.length;o+=1)Bi(r.charCodeAt(o),n,a);return e.join("")}function So(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function Eo(r,e){for(let t=0;t<r.length;t+=1){let s=r.charCodeAt(t);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(r.charCodeAt(t+1)-56320&65535|n)+65536,t+=1}So(s,e)}}function Co(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let s=1;s<6;s+=1)if(!(r>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function To(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<r.length;n+=1)Bi(r.charCodeAt(n),t,s);return new Uint8Array(e)}function Ao(r){const e=[];return Eo(r,t=>e.push(t)),new Uint8Array(e)}function Oo(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};return r.forEach(n=>$r(n,t,s)),$r(null,t,s),e.join("")}function $o(r){return Math.round(Date.now()/1e3)+r}function Po(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const he=()=>typeof window<"u"&&typeof document<"u",Le={tested:!1,writable:!1},qi=()=>{if(!he())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Le.tested)return Le.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Le.tested=!0,Le.writable=!0}catch{Le.tested=!0,Le.writable=!1}return Le.writable};function Fo(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,a)=>{e[a]=n})}catch{}return t.searchParams.forEach((s,n)=>{e[n]=s}),e}const Vi=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>St(async()=>{const{default:s}=await Promise.resolve().then(()=>ct);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Ro=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",rt=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},Ue=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Ae=async(r,e)=>{await r.removeItem(e)};class ss{constructor(){this.promise=new ss.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}ss.promiseConstructor=Promise;function ps(r){const e=r.split(".");if(e.length!==3)throw new Rs("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!bo.test(e[s]))throw new Rs("JWT not in base64url format");return{header:JSON.parse(Pr(e[0])),payload:JSON.parse(Pr(e[1])),signature:To(e[2]),raw:{header:e[0],payload:e[1]}}}async function Io(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function Do(r,e){return new Promise((s,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await r(a);if(!e(a,null,o)){s(o);return}}catch(o){if(!e(a,o)){n(o);return}}})()})}function Lo(r){return("0"+r.toString(16)).substr(-2)}function Uo(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let n="";for(let a=0;a<56;a++)n+=t.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,Lo).join("")}async function Mo(r){const t=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(s);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}async function Bo(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await Mo(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ye(r,e,t=!1){const s=Uo();let n=s;t&&(n+="/PASSWORD_RECOVERY"),await rt(r,`${e}-code-verifier`,n);const a=await Bo(s);return[a,s===a?"plain":"s256"]}const qo=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Vo(r){const e=r.headers.get(Ps);if(!e||!e.match(qo))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Wo(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function zo(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Ho=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ze(r){if(!Ho.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function xs(){const r={};return new Proxy(r,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const s=t.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Fr(r){return JSON.parse(JSON.stringify(r))}var Ko=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};const Me=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Go=[502,503,504];async function Rr(r){var e;if(!Ro(r))throw new Fs(Me(r),0);if(Go.includes(r.status))throw new Fs(Me(r),r.status);let t;try{t=await r.json()}catch(a){throw new Mi(Me(a),a)}let s;const n=Vo(r);if(n&&n.getTime()>=Ui["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new Ar(Me(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Oe}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new Ar(Me(t),r.status,t.weak_password.reasons);throw new wo(Me(t),r.status||500,s)}const Jo=(r,e,t,s)=>{const n={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),t))};async function I(r,e,t,s){var n;const a=Object.assign({},s==null?void 0:s.headers);a[Ps]||(a[Ps]=Ui["2024-01-01"].name),s!=null&&s.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const o=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await Yo(r,e,t+l,{headers:a,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function Yo(r,e,t,s,n,a){const o=Jo(e,s,n,a);let l;try{l=await r(t,Object.assign({},o))}catch(c){throw console.error(c),new Fs(Me(c),0)}if(l.ok||await Rr(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await Rr(c)}}function Se(r){var e;let t=null;el(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=$o(r.expires_in)));const s=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:s},error:null}}function Ir(r){const e=Se(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=r.weak_password),e}function $e(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function Zo(r){return{data:r,error:null}}function Qo(r){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:a}=r,o=Ko(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Xo(r){return r}function el(r){return r.access_token&&r.refresh_token&&r.expires_in}const ys=["global","local","others"];var tl=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};class sl{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=Vi(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=ys[0]){if(ys.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ys.join(", ")}`);try{return await I(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(P(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await I(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:$e})}catch(s){if(P(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=tl(e,["options"]),n=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await I(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Qo,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(P(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await I(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:$e})}catch(t){if(P(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,n,a,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await I(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:Xo});if(u.error)throw u.error;const h=await u.json(),m=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,y=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return y.length>0&&(y.forEach(w=>{const b=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(w.split(";")[1].split("=")[1]);d[`${N}Page`]=b}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(P(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Ze(e);try{return await I(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:$e})}catch(t){if(P(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Ze(e);try{return await I(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:$e})}catch(s){if(P(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){Ze(e);try{return await I(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:$e})}catch(s){if(P(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Ze(e.userId);try{const{data:t,error:s}=await I(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:s}}catch(t){if(P(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Ze(e.userId),Ze(e.id);try{return{data:await I(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(P(t))return{data:null,error:t};throw t}}}function Dr(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function rl(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Qe={debug:!!(globalThis&&qi()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Wi extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class il extends Wi{}async function nl(r,e,t){Qe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Qe.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){Qe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,n.name);try{return await t()}finally{Qe.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,n.name)}}else{if(e===0)throw Qe.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new il(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(Qe.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}rl();const al={url:po,storageKey:xo,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:yo,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Lr(r,e,t){return await t()}const Xe={};class wt{constructor(e){var t,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=wt.nextInstanceID,wt.nextInstanceID+=1,this.instanceID>0&&he()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},al),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new sl({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Vi(n.fetch),this.lock=n.lock||Lr,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:he()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=nl:this.lock=Lr,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:qi()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Dr(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=Dr(this.memoryStorage)),he()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=Xe[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Xe[this.storageKey]=Object.assign(Object.assign({},Xe[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Xe[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Xe[this.storageKey]=Object.assign(Object.assign({},Xe[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Li}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Fo(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),he()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:a}=await this._getSessionFromURL(t,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),No(a)){const c=(e=a.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return P(t)?{error:t}:{error:new Mi("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,n;try{const a=await I(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:Se}),{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(P(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,s,n;try{let a;if("email"in e){const{email:u,password:h,options:m}=e;let y=null,w=null;this.flowType==="pkce"&&([y,w]=await Ye(this.storage,this.storageKey)),a=await I(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:u,password:h,data:(t=m==null?void 0:m.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:y,code_challenge_method:w},xform:Se})}else if("phone"in e){const{phone:u,password:h,options:m}=e;a=await I(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=m==null?void 0:m.data)!==null&&s!==void 0?s:{},channel:(n=m==null?void 0:m.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:Se})}else throw new Ft("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(P(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:o,options:l}=e;t=await I(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Ir})}else if("phone"in e){const{phone:a,password:o,options:l}=e;t=await I(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Ir})}else throw new Ft("You must provide either an email or phone number and a password");const{data:s,error:n}=t;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Pt}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(t){if(P(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,n,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,n,a,o,l,c,d,u,h,m,y;let w,b;if("message"in e)w=e.message,b=e.signature;else{const{chain:N,wallet:j,statement:x,options:v}=e;let C;if(he())if(typeof j=="object")C=j;else{const $=window;if("solana"in $&&typeof $.solana=="object"&&("signIn"in $.solana&&typeof $.solana.signIn=="function"||"signMessage"in $.solana&&typeof $.solana.signMessage=="function"))C=$.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof j!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=j}const A=new URL((t=v==null?void 0:v.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in C&&C.signIn){const $=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:A.host,uri:A.href}),x?{statement:x}:null));let F;if(Array.isArray($)&&$[0]&&typeof $[0]=="object")F=$[0];else if($&&typeof $=="object"&&"signedMessage"in $&&"signature"in $)F=$;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in F&&"signature"in F&&(typeof F.signedMessage=="string"||F.signedMessage instanceof Uint8Array)&&F.signature instanceof Uint8Array)w=typeof F.signedMessage=="string"?F.signedMessage:new TextDecoder().decode(F.signedMessage),b=F.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${A.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),...x?["",x,""]:[""],"Version: 1",`URI: ${A.href}`,`Issued At: ${(n=(s=v==null?void 0:v.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((a=v==null?void 0:v.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((o=v==null?void 0:v.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((l=v==null?void 0:v.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((d=v==null?void 0:v.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((h=(u=v==null?void 0:v.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...v.signInWithSolana.resources.map(F=>`- ${F}`)]:[]].join(`
`);const $=await C.signMessage(new TextEncoder().encode(w),"utf8");if(!$||!($ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=$}}try{const{data:N,error:j}=await I(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:Oo(b)},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Se});if(j)throw j;return!N||!N.session||!N.user?{data:{user:null,session:null},error:new Pt}:(N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),{data:Object.assign({},N),error:j})}catch(N){if(P(N))return{data:{user:null,session:null},error:N};throw N}}async _exchangeCodeForSession(e){const t=await Ue(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(t??"").split("/");try{const{data:a,error:o}=await I(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Se});if(await Ae(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Pt}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:o})}catch(a){if(P(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:s,token:n,access_token:a,nonce:o}=e,l=await I(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Se}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Pt}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(t){if(P(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,n,a,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Ye(this.storage,this.storageKey));const{error:h}=await I(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:u}=await I(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new Ft("You must provide either an email or phone number.")}catch(l){if(P(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var t,s;try{let n,a;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:l}=await I(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:Se});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(n){if(P(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,s,n;try{let a=null,o=null;return this.flowType==="pkce"&&([a,o]=await Ye(this.storage,this.storageKey)),await I(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:Zo})}catch(a){if(P(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Oe;const{error:n}=await I(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(P(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:a}=e,{error:o}=await I(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:n,options:a}=e,{data:o,error:l}=await I(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Ft("You must provide either an email or phone number and a type")}catch(t){if(P(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Ue(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<ms:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await Ue(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=xs()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,d,u)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:e},error:null}}const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await I(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:$e}):await this._useSession(async t=>{var s,n,a;const{data:o,error:l}=t;if(l)throw l;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Oe}:await I(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:$e})})}catch(t){if(P(t))return _o(t)&&(await this._removeSession(),await Ae(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:n,error:a}=s;if(a)throw a;if(!n.session)throw new Oe;const o=n.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Ye(this.storage,this.storageKey));const{data:d,error:u}=await I(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:$e});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(P(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Oe;const t=Date.now()/1e3;let s=t,n=!0,a=null;const{payload:o}=ps(e.access_token);if(o.exp&&(s=o.exp,n=s<=t),n){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(P(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Oe;const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(P(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!he())throw new Rt("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Rt(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Tr("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Rt("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Tr("No code detected.");const{data:x,error:v}=await this._exchangeCodeForSession(e.code);if(v)throw v;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!a||!l||!o||!d)throw new Rt("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let m=u+h;c&&(m=parseInt(c));const y=m-u;y*1e3<=st&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${h}s`);const w=m-h;u-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,m,u):u-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,m,u);const{data:b,error:N}=await this._getUser(a);if(N)throw N;const j={provider_token:s,provider_refresh_token:n,access_token:a,expires_in:h,expires_at:m,refresh_token:o,token_type:d,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:j,redirectType:e.type},error:null}}catch(s){if(P(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Ue(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:n,error:a}=t;if(a)return{error:a};const o=(s=n.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(jo(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Ae(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Po(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,n;try{const{data:{session:a},error:o}=t;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await Ye(this.storage,this.storageKey,!0));try{return await I(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(P(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(P(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:n}=await this._useSession(async a=>{var o,l,c,d,u;const{data:h,error:m}=a;if(m)throw m;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await I(this.fetch,"GET",y,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return he()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(P(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,n;const{data:a,error:o}=t;if(o)throw o;return await I(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(P(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await Do(async n=>(n>0&&await Io(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await I(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Se})),(n,a)=>{const o=200*Math.pow(2,n);return a&&gs(a)&&Date.now()+o-s<st})}catch(s){if(this._debug(t,"error",s),P(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),he()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await Ue(this.storage,this.storageKey);if(n&&this.userStorage){let o=await Ue(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await rt(this.userStorage,this.storageKey+"-user",o)),n.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:xs()}else if(n&&!n.user&&!n.user){const o=await Ue(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(n.user=o.user,await Ae(this.storage,this.storageKey+"-user"),await rt(this.storage,this.storageKey,n)):n.user=xs()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const a=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<ms;if(this._debug(s,`session has${a?"":" not"} expired with margin of ${ms}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),gs(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(n.access_token);!l&&(o!=null&&o.user)?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Oe;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new ss;const{data:a,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!a.session)throw new Oe;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={session:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(n,"error",a),P(a)){const o={session:null,error:a};return gs(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),s=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&t.user&&await rt(this.userStorage,this.storageKey+"-user",{user:t.user});const n=Object.assign({},t);delete n.user;const a=Fr(n);await rt(this.storage,this.storageKey,a)}else{const n=Fr(t);await rt(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await Ae(this.storage,this.storageKey),await Ae(this.storage,this.storageKey+"-code-verifier"),await Ae(this.storage,this.storageKey+"-user"),this.userStorage&&await Ae(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&he()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),st);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/st);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${st}ms, refresh threshold is ${$s} ticks`),n<=$s&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Wi)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!he()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const n=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,o]=await Ye(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(l.toString())}if(s!=null&&s.queryParams){const a=new URLSearchParams(s.queryParams);n.push(a.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;return a?{data:null,error:a}:await I(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(P(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,n;const{data:a,error:o}=t;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:d}=await I(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(t){if(P(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;if(a)return{data:null,error:a};const{data:o,error:l}=await I(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(t){if(P(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;return a?{data:null,error:a}:await I(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(P(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],n=s.filter(o=>o.factor_type==="totp"&&o.status==="verified"),a=s.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:s,totp:n,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:n},error:a}=e;if(a)return{data:null,error:a};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=ps(n.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((s=(t=n.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(l=>l.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(l=>l.kid===e),s&&this.jwks_cached_at+vo>n)return s;const{data:a,error:o}=await I(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=n,s=a.keys.find(l=>l.kid===e),!s)?null:s}async getClaims(e,t={}){try{let s=e;if(!s){const{data:y,error:w}=await this.getSession();if(w||!y.session)return{data:null,error:w};s=y.session.access_token}const{header:n,payload:a,signature:o,raw:{header:l,payload:c}}=ps(s);t!=null&&t.allowExpired||Wo(a.exp);const d=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!d){const{error:y}=await this.getUser(s);if(y)throw y;return{data:{claims:a,header:n,signature:o},error:null}}const u=zo(n.alg),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,Ao(`${l}.${c}`)))throw new Rs("Invalid JWT signature");return{data:{claims:a,header:n,signature:o},error:null}}catch(s){if(P(s))return{data:null,error:s};throw s}}}wt.nextInstanceID=0;const ol=wt;class ll extends ol{constructor(e){super(e)}}var cl=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};class dl{constructor(e,t,s){var n,a,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const l=mo(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,u={db:no,realtime:oo,auth:Object.assign(Object.assign({},ao),{storageKey:d}),global:io},h=go(s??{},u);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=h.global.headers)!==null&&a!==void 0?a:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(m,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=ho(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new ka(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new to(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new ta(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return cl(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,storageKey:a,flowType:o,lock:l,debug:c},d,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ll({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),d),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,flowType:o,lock:l,debug:c,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new qa(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ul=(r,e,t)=>new dl(r,e,t);function hl(){if(typeof window<"u"||typeof process>"u")return!1;const r=process.version;if(r==null)return!1;const e=r.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}hl()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const fl="https://wzwrrgwxmrmczqszzspn.supabase.co",ml="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind6d3JyZ3d4bXJtY3pxc3p6c3BuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ5MDQ3OTIsImV4cCI6MjA3MDQ4MDc5Mn0.A70qpMVNMjYB4xi9tsCIdsdWxpQuZF4Ph9j4R-9Tz2U",X=ul(fl,ml),zi=O.createContext(void 0),pe=()=>{const r=O.useContext(zi);if(r===void 0)throw new Error("useAuth must be used within an AuthProvider");return r},gl=({children:r})=>{const[e,t]=O.useState(null),[s,n]=O.useState(null),[a,o]=O.useState(!0),[l,c]=O.useState(!1);O.useEffect(()=>{X.auth.getSession().then(({data:{session:b}})=>{n(b),t((b==null?void 0:b.user)??null),b!=null&&b.user&&d(b.user.id),o(!1)});const{data:{subscription:w}}=X.auth.onAuthStateChange(async(b,N)=>{n(N),t((N==null?void 0:N.user)??null),N!=null&&N.user?d(N.user.id):c(!1),o(!1)});return()=>w.unsubscribe()},[]);const d=async w=>{try{const{data:b,error:N}=await X.from("user_profiles").select("is_admin").eq("id",w).single();!N&&b&&c(b.is_admin||!1)}catch(b){console.error("Error checking admin status:",b)}},y={user:e,session:s,loading:a,signUp:async(w,b,N)=>{const{data:j,error:x}=await X.auth.signUp({email:w,password:b,options:{data:{full_name:N}}});return{data:j,error:x}},signIn:async(w,b)=>{const{data:N,error:j}=await X.auth.signInWithPassword({email:w,password:b});return{data:N,error:j}},signOut:async()=>{const{error:w}=await X.auth.signOut();if(w)throw w},isAdmin:l};return i.jsx(zi.Provider,{value:y,children:r})},Ur=({children:r,requireAdmin:e=!1})=>{const{user:t,loading:s,isAdmin:n}=pe(),a=gi();return s?i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 flex items-center justify-center",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):t?e&&!n?i.jsx(Mt,{to:"/dashboard",replace:!0}):i.jsx(i.Fragment,{children:r}):i.jsx(Mt,{to:"/login",state:{from:a},replace:!0})};var Tt=r=>r.type==="checkbox",qe=r=>r instanceof Date,te=r=>r==null;const Hi=r=>typeof r=="object";var z=r=>!te(r)&&!Array.isArray(r)&&Hi(r)&&!qe(r),pl=r=>z(r)&&r.target?Tt(r.target)?r.target.checked:r.target.value:r,xl=r=>r.substring(0,r.search(/\.\d+(\.|$)/))||r,yl=(r,e)=>r.has(xl(e)),bl=r=>{const e=r.constructor&&r.constructor.prototype;return z(e)&&e.hasOwnProperty("isPrototypeOf")},Zs=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Y(r){let e;const t=Array.isArray(r),s=typeof FileList<"u"?r instanceof FileList:!1;if(r instanceof Date)e=new Date(r);else if(!(Zs&&(r instanceof Blob||s))&&(t||z(r)))if(e=t?[]:Object.create(Object.getPrototypeOf(r)),!t&&!bl(r))e=r;else for(const n in r)r.hasOwnProperty(n)&&(e[n]=Y(r[n]));else return r;return e}var rs=r=>/^\w*$/.test(r),K=r=>r===void 0,Qs=r=>Array.isArray(r)?r.filter(Boolean):[],Xs=r=>Qs(r.replace(/["|']|\]/g,"").split(/\.|\[/)),E=(r,e,t)=>{if(!e||!z(r))return t;const s=(rs(e)?[e]:Xs(e)).reduce((n,a)=>te(n)?n:n[a],r);return K(s)||s===r?K(r[e])?t:r[e]:s},be=r=>typeof r=="boolean",B=(r,e,t)=>{let s=-1;const n=rs(e)?[e]:Xs(e),a=n.length,o=a-1;for(;++s<a;){const l=n[s];let c=t;if(s!==o){const d=r[l];c=z(d)||Array.isArray(d)?d:isNaN(+n[s+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;r[l]=c,r=r[l]}};const Mr={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},me={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ne={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},vl=Q.createContext(null);vl.displayName="HookFormContext";var wl=(r,e,t,s=!0)=>{const n={defaultValues:e._defaultValues};for(const a in r)Object.defineProperty(n,a,{get:()=>{const o=a;return e._proxyFormState[o]!==me.all&&(e._proxyFormState[o]=!s||me.all),r[o]}});return n};const jl=typeof window<"u"?Q.useLayoutEffect:Q.useEffect;var je=r=>typeof r=="string",_l=(r,e,t,s,n)=>je(r)?(s&&e.watch.add(r),E(t,r,n)):Array.isArray(r)?r.map(a=>(s&&e.watch.add(a),E(t,a))):(s&&(e.watchAll=!0),t),Is=r=>te(r)||!Hi(r);function Pe(r,e,t=new WeakSet){if(Is(r)||Is(e))return r===e;if(qe(r)&&qe(e))return r.getTime()===e.getTime();const s=Object.keys(r),n=Object.keys(e);if(s.length!==n.length)return!1;if(t.has(r)||t.has(e))return!0;t.add(r),t.add(e);for(const a of s){const o=r[a];if(!n.includes(a))return!1;if(a!=="ref"){const l=e[a];if(qe(o)&&qe(l)||z(o)&&z(l)||Array.isArray(o)&&Array.isArray(l)?!Pe(o,l,t):o!==l)return!1}}return!0}var Ki=(r,e,t,s,n)=>e?{...t[r],types:{...t[r]&&t[r].types?t[r].types:{},[s]:n||!0}}:{},bt=r=>Array.isArray(r)?r:[r],Br=()=>{let r=[];return{get observers(){return r},next:n=>{for(const a of r)a.next&&a.next(n)},subscribe:n=>(r.push(n),{unsubscribe:()=>{r=r.filter(a=>a!==n)}}),unsubscribe:()=>{r=[]}}},oe=r=>z(r)&&!Object.keys(r).length,er=r=>r.type==="file",ge=r=>typeof r=="function",Vt=r=>{if(!Zs)return!1;const e=r?r.ownerDocument:0;return r instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},Gi=r=>r.type==="select-multiple",tr=r=>r.type==="radio",Nl=r=>tr(r)||Tt(r),bs=r=>Vt(r)&&r.isConnected;function kl(r,e){const t=e.slice(0,-1).length;let s=0;for(;s<t;)r=K(r)?s++:r[e[s++]];return r}function Sl(r){for(const e in r)if(r.hasOwnProperty(e)&&!K(r[e]))return!1;return!0}function H(r,e){const t=Array.isArray(e)?e:rs(e)?[e]:Xs(e),s=t.length===1?r:kl(r,t),n=t.length-1,a=t[n];return s&&delete s[a],n!==0&&(z(s)&&oe(s)||Array.isArray(s)&&Sl(s))&&H(r,t.slice(0,-1)),r}var Ji=r=>{for(const e in r)if(ge(r[e]))return!0;return!1};function Wt(r,e={}){const t=Array.isArray(r);if(z(r)||t)for(const s in r)Array.isArray(r[s])||z(r[s])&&!Ji(r[s])?(e[s]=Array.isArray(r[s])?[]:{},Wt(r[s],e[s])):te(r[s])||(e[s]=!0);return e}function Yi(r,e,t){const s=Array.isArray(r);if(z(r)||s)for(const n in r)Array.isArray(r[n])||z(r[n])&&!Ji(r[n])?K(e)||Is(t[n])?t[n]=Array.isArray(r[n])?Wt(r[n],[]):{...Wt(r[n])}:Yi(r[n],te(e)?{}:e[n],t[n]):t[n]=!Pe(r[n],e[n]);return t}var ft=(r,e)=>Yi(r,e,Wt(e));const qr={value:!1,isValid:!1},Vr={value:!0,isValid:!0};var Zi=r=>{if(Array.isArray(r)){if(r.length>1){const e=r.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return r[0].checked&&!r[0].disabled?r[0].attributes&&!K(r[0].attributes.value)?K(r[0].value)||r[0].value===""?Vr:{value:r[0].value,isValid:!0}:Vr:qr}return qr},Qi=(r,{valueAsNumber:e,valueAsDate:t,setValueAs:s})=>K(r)?r:e?r===""?NaN:r&&+r:t&&je(r)?new Date(r):s?s(r):r;const Wr={isValid:!1,value:null};var Xi=r=>Array.isArray(r)?r.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,Wr):Wr;function zr(r){const e=r.ref;return er(e)?e.files:tr(e)?Xi(r.refs).value:Gi(e)?[...e.selectedOptions].map(({value:t})=>t):Tt(e)?Zi(r.refs).value:Qi(K(e.value)?r.ref.value:e.value,r)}var El=(r,e,t,s)=>{const n={};for(const a of r){const o=E(e,a);o&&B(n,a,o._f)}return{criteriaMode:t,names:[...r],fields:n,shouldUseNativeValidation:s}},zt=r=>r instanceof RegExp,mt=r=>K(r)?r:zt(r)?r.source:z(r)?zt(r.value)?r.value.source:r.value:r,Hr=r=>({isOnSubmit:!r||r===me.onSubmit,isOnBlur:r===me.onBlur,isOnChange:r===me.onChange,isOnAll:r===me.all,isOnTouch:r===me.onTouched});const Kr="AsyncFunction";var Cl=r=>!!r&&!!r.validate&&!!(ge(r.validate)&&r.validate.constructor.name===Kr||z(r.validate)&&Object.values(r.validate).find(e=>e.constructor.name===Kr)),Tl=r=>r.mount&&(r.required||r.min||r.max||r.maxLength||r.minLength||r.pattern||r.validate),Gr=(r,e,t)=>!t&&(e.watchAll||e.watch.has(r)||[...e.watch].some(s=>r.startsWith(s)&&/^\.\w+/.test(r.slice(s.length))));const vt=(r,e,t,s)=>{for(const n of t||Object.keys(r)){const a=E(r,n);if(a){const{_f:o,...l}=a;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],n)&&!s)return!0;if(o.ref&&e(o.ref,o.name)&&!s)return!0;if(vt(l,e))break}else if(z(l)&&vt(l,e))break}}};function Jr(r,e,t){const s=E(r,t);if(s||rs(t))return{error:s,name:t};const n=t.split(".");for(;n.length;){const a=n.join("."),o=E(e,a),l=E(r,a);if(o&&!Array.isArray(o)&&t!==a)return{name:t};if(l&&l.type)return{name:a,error:l};if(l&&l.root&&l.root.type)return{name:`${a}.root`,error:l.root};n.pop()}return{name:t}}var Al=(r,e,t,s)=>{t(r);const{name:n,...a}=r;return oe(a)||Object.keys(a).length>=Object.keys(e).length||Object.keys(a).find(o=>e[o]===(!s||me.all))},Ol=(r,e,t)=>!r||!e||r===e||bt(r).some(s=>s&&(t?s===e:s.startsWith(e)||e.startsWith(s))),$l=(r,e,t,s,n)=>n.isOnAll?!1:!t&&n.isOnTouch?!(e||r):(t?s.isOnBlur:n.isOnBlur)?!r:(t?s.isOnChange:n.isOnChange)?r:!0,Pl=(r,e)=>!Qs(E(r,e)).length&&H(r,e),Fl=(r,e,t)=>{const s=bt(E(r,t));return B(s,"root",e[t]),B(r,t,s),r},Dt=r=>je(r);function Yr(r,e,t="validate"){if(Dt(r)||Array.isArray(r)&&r.every(Dt)||be(r)&&!r)return{type:t,message:Dt(r)?r:"",ref:e}}var et=r=>z(r)&&!zt(r)?r:{value:r,message:""},Zr=async(r,e,t,s,n,a)=>{const{ref:o,refs:l,required:c,maxLength:d,minLength:u,min:h,max:m,pattern:y,validate:w,name:b,valueAsNumber:N,mount:j}=r._f,x=E(t,b);if(!j||e.has(b))return{};const v=l?l[0]:o,C=R=>{n&&v.reportValidity&&(v.setCustomValidity(be(R)?"":R||""),v.reportValidity())},A={},$=tr(o),F=Tt(o),De=$||F,G=(N||er(o))&&K(o.value)&&K(x)||Vt(o)&&o.value===""||x===""||Array.isArray(x)&&!x.length,ce=Ki.bind(null,b,s,A),M=(R,D,W,ee=Ne.maxLength,re=Ne.minLength)=>{const xe=R?D:W;A[b]={type:R?ee:re,message:xe,ref:o,...ce(R?ee:re,xe)}};if(a?!Array.isArray(x)||!x.length:c&&(!De&&(G||te(x))||be(x)&&!x||F&&!Zi(l).isValid||$&&!Xi(l).isValid)){const{value:R,message:D}=Dt(c)?{value:!!c,message:c}:et(c);if(R&&(A[b]={type:Ne.required,message:D,ref:v,...ce(Ne.required,D)},!s))return C(D),A}if(!G&&(!te(h)||!te(m))){let R,D;const W=et(m),ee=et(h);if(!te(x)&&!isNaN(x)){const re=o.valueAsNumber||x&&+x;te(W.value)||(R=re>W.value),te(ee.value)||(D=re<ee.value)}else{const re=o.valueAsDate||new Date(x),xe=At=>new Date(new Date().toDateString()+" "+At),ut=o.type=="time",Ge=o.type=="week";je(W.value)&&x&&(R=ut?xe(x)>xe(W.value):Ge?x>W.value:re>new Date(W.value)),je(ee.value)&&x&&(D=ut?xe(x)<xe(ee.value):Ge?x<ee.value:re<new Date(ee.value))}if((R||D)&&(M(!!R,W.message,ee.message,Ne.max,Ne.min),!s))return C(A[b].message),A}if((d||u)&&!G&&(je(x)||a&&Array.isArray(x))){const R=et(d),D=et(u),W=!te(R.value)&&x.length>+R.value,ee=!te(D.value)&&x.length<+D.value;if((W||ee)&&(M(W,R.message,D.message),!s))return C(A[b].message),A}if(y&&!G&&je(x)){const{value:R,message:D}=et(y);if(zt(R)&&!x.match(R)&&(A[b]={type:Ne.pattern,message:D,ref:o,...ce(Ne.pattern,D)},!s))return C(D),A}if(w){if(ge(w)){const R=await w(x,t),D=Yr(R,v);if(D&&(A[b]={...D,...ce(Ne.validate,D.message)},!s))return C(D.message),A}else if(z(w)){let R={};for(const D in w){if(!oe(R)&&!s)break;const W=Yr(await w[D](x,t),v,D);W&&(R={...W,...ce(D,W.message)},C(W.message),s&&(A[b]=R))}if(!oe(R)&&(A[b]={ref:v,...R},!s))return A}}return C(!0),A};const Rl={mode:me.onSubmit,reValidateMode:me.onChange,shouldFocusError:!0};function Il(r={}){let e={...Rl,...r},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:ge(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},s={},n=z(e.defaultValues)||z(e.values)?Y(e.defaultValues||e.values)||{}:{},a=e.shouldUnregister?{}:Y(n),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,d=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let h={...u};const m={array:Br(),state:Br()},y=e.criteriaMode===me.all,w=f=>g=>{clearTimeout(d),d=setTimeout(f,g)},b=async f=>{if(!e.disabled&&(u.isValid||h.isValid||f)){const g=e.resolver?oe((await F()).errors):await G(s,!0);g!==t.isValid&&m.state.next({isValid:g})}},N=(f,g)=>{!e.disabled&&(u.isValidating||u.validatingFields||h.isValidating||h.validatingFields)&&((f||Array.from(l.mount)).forEach(p=>{p&&(g?B(t.validatingFields,p,g):H(t.validatingFields,p))}),m.state.next({validatingFields:t.validatingFields,isValidating:!oe(t.validatingFields)}))},j=(f,g=[],p,S,k=!0,_=!0)=>{if(S&&p&&!e.disabled){if(o.action=!0,_&&Array.isArray(E(s,f))){const T=p(E(s,f),S.argA,S.argB);k&&B(s,f,T)}if(_&&Array.isArray(E(t.errors,f))){const T=p(E(t.errors,f),S.argA,S.argB);k&&B(t.errors,f,T),Pl(t.errors,f)}if((u.touchedFields||h.touchedFields)&&_&&Array.isArray(E(t.touchedFields,f))){const T=p(E(t.touchedFields,f),S.argA,S.argB);k&&B(t.touchedFields,f,T)}(u.dirtyFields||h.dirtyFields)&&(t.dirtyFields=ft(n,a)),m.state.next({name:f,isDirty:M(f,g),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else B(a,f,g)},x=(f,g)=>{B(t.errors,f,g),m.state.next({errors:t.errors})},v=f=>{t.errors=f,m.state.next({errors:t.errors,isValid:!1})},C=(f,g,p,S)=>{const k=E(s,f);if(k){const _=E(a,f,K(p)?E(n,f):p);K(_)||S&&S.defaultChecked||g?B(a,f,g?_:zr(k._f)):W(f,_),o.mount&&b()}},A=(f,g,p,S,k)=>{let _=!1,T=!1;const U={name:f};if(!e.disabled){if(!p||S){(u.isDirty||h.isDirty)&&(T=t.isDirty,t.isDirty=U.isDirty=M(),_=T!==U.isDirty);const q=Pe(E(n,f),g);T=!!E(t.dirtyFields,f),q?H(t.dirtyFields,f):B(t.dirtyFields,f,!0),U.dirtyFields=t.dirtyFields,_=_||(u.dirtyFields||h.dirtyFields)&&T!==!q}if(p){const q=E(t.touchedFields,f);q||(B(t.touchedFields,f,p),U.touchedFields=t.touchedFields,_=_||(u.touchedFields||h.touchedFields)&&q!==p)}_&&k&&m.state.next(U)}return _?U:{}},$=(f,g,p,S)=>{const k=E(t.errors,f),_=(u.isValid||h.isValid)&&be(g)&&t.isValid!==g;if(e.delayError&&p?(c=w(()=>x(f,p)),c(e.delayError)):(clearTimeout(d),c=null,p?B(t.errors,f,p):H(t.errors,f)),(p?!Pe(k,p):k)||!oe(S)||_){const T={...S,..._&&be(g)?{isValid:g}:{},errors:t.errors,name:f};t={...t,...T},m.state.next(T)}},F=async f=>{N(f,!0);const g=await e.resolver(a,e.context,El(f||l.mount,s,e.criteriaMode,e.shouldUseNativeValidation));return N(f),g},De=async f=>{const{errors:g}=await F(f);if(f)for(const p of f){const S=E(g,p);S?B(t.errors,p,S):H(t.errors,p)}else t.errors=g;return g},G=async(f,g,p={valid:!0})=>{for(const S in f){const k=f[S];if(k){const{_f:_,...T}=k;if(_){const U=l.array.has(_.name),q=k._f&&Cl(k._f);q&&u.validatingFields&&N([S],!0);const de=await Zr(k,l.disabled,a,y,e.shouldUseNativeValidation&&!g,U);if(q&&u.validatingFields&&N([S]),de[_.name]&&(p.valid=!1,g))break;!g&&(E(de,_.name)?U?Fl(t.errors,de,_.name):B(t.errors,_.name,de[_.name]):H(t.errors,_.name))}!oe(T)&&await G(T,g,p)}}return p.valid},ce=()=>{for(const f of l.unMount){const g=E(s,f);g&&(g._f.refs?g._f.refs.every(p=>!bs(p)):!bs(g._f.ref))&&os(f)}l.unMount=new Set},M=(f,g)=>!e.disabled&&(f&&g&&B(a,f,g),!Pe(At(),n)),R=(f,g,p)=>_l(f,l,{...o.mount?a:K(g)?n:je(f)?{[f]:g}:g},p,g),D=f=>Qs(E(o.mount?a:n,f,e.shouldUnregister?E(n,f,[]):[])),W=(f,g,p={})=>{const S=E(s,f);let k=g;if(S){const _=S._f;_&&(!_.disabled&&B(a,f,Qi(g,_)),k=Vt(_.ref)&&te(g)?"":g,Gi(_.ref)?[..._.ref.options].forEach(T=>T.selected=k.includes(T.value)):_.refs?Tt(_.ref)?_.refs.forEach(T=>{(!T.defaultChecked||!T.disabled)&&(Array.isArray(k)?T.checked=!!k.find(U=>U===T.value):T.checked=k===T.value||!!k)}):_.refs.forEach(T=>T.checked=T.value===k):er(_.ref)?_.ref.value="":(_.ref.value=k,_.ref.type||m.state.next({name:f,values:Y(a)})))}(p.shouldDirty||p.shouldTouch)&&A(f,k,p.shouldTouch,p.shouldDirty,!0),p.shouldValidate&&Ge(f)},ee=(f,g,p)=>{for(const S in g){if(!g.hasOwnProperty(S))return;const k=g[S],_=f+"."+S,T=E(s,_);(l.array.has(f)||z(k)||T&&!T._f)&&!qe(k)?ee(_,k,p):W(_,k,p)}},re=(f,g,p={})=>{const S=E(s,f),k=l.array.has(f),_=Y(g);B(a,f,_),k?(m.array.next({name:f,values:Y(a)}),(u.isDirty||u.dirtyFields||h.isDirty||h.dirtyFields)&&p.shouldDirty&&m.state.next({name:f,dirtyFields:ft(n,a),isDirty:M(f,_)})):S&&!S._f&&!te(_)?ee(f,_,p):W(f,_,p),Gr(f,l)&&m.state.next({...t,name:f}),m.state.next({name:o.mount?f:void 0,values:Y(a)})},xe=async f=>{o.mount=!0;const g=f.target;let p=g.name,S=!0;const k=E(s,p),_=q=>{S=Number.isNaN(q)||qe(q)&&isNaN(q.getTime())||Pe(q,E(a,p,q))},T=Hr(e.mode),U=Hr(e.reValidateMode);if(k){let q,de;const Ot=g.type?zr(k._f):pl(f),Te=f.type===Mr.BLUR||f.type===Mr.FOCUS_OUT,Pn=!Tl(k._f)&&!e.resolver&&!E(t.errors,p)&&!k._f.deps||$l(Te,E(t.touchedFields,p),t.isSubmitted,U,T),ds=Gr(p,l,Te);B(a,p,Ot),Te?(!g||!g.readOnly)&&(k._f.onBlur&&k._f.onBlur(f),c&&c(0)):k._f.onChange&&k._f.onChange(f);const us=A(p,Ot,Te),Fn=!oe(us)||ds;if(!Te&&m.state.next({name:p,type:f.type,values:Y(a)}),Pn)return(u.isValid||h.isValid)&&(e.mode==="onBlur"?Te&&b():Te||b()),Fn&&m.state.next({name:p,...ds?{}:us});if(!Te&&ds&&m.state.next({...t}),e.resolver){const{errors:yr}=await F([p]);if(_(Ot),S){const Rn=Jr(t.errors,s,p),br=Jr(yr,s,Rn.name||p);q=br.error,p=br.name,de=oe(yr)}}else N([p],!0),q=(await Zr(k,l.disabled,a,y,e.shouldUseNativeValidation))[p],N([p]),_(Ot),S&&(q?de=!1:(u.isValid||h.isValid)&&(de=await G(s,!0)));S&&(k._f.deps&&Ge(k._f.deps),$(p,de,q,us))}},ut=(f,g)=>{if(E(t.errors,g)&&f.focus)return f.focus(),1},Ge=async(f,g={})=>{let p,S;const k=bt(f);if(e.resolver){const _=await De(K(f)?f:k);p=oe(_),S=f?!k.some(T=>E(_,T)):p}else f?(S=(await Promise.all(k.map(async _=>{const T=E(s,_);return await G(T&&T._f?{[_]:T}:T)}))).every(Boolean),!(!S&&!t.isValid)&&b()):S=p=await G(s);return m.state.next({...!je(f)||(u.isValid||h.isValid)&&p!==t.isValid?{}:{name:f},...e.resolver||!f?{isValid:p}:{},errors:t.errors}),g.shouldFocus&&!S&&vt(s,ut,f?k:l.mount),S},At=f=>{const g={...o.mount?a:n};return K(f)?g:je(f)?E(g,f):f.map(p=>E(g,p))},dr=(f,g)=>({invalid:!!E((g||t).errors,f),isDirty:!!E((g||t).dirtyFields,f),error:E((g||t).errors,f),isValidating:!!E(t.validatingFields,f),isTouched:!!E((g||t).touchedFields,f)}),Sn=f=>{f&&bt(f).forEach(g=>H(t.errors,g)),m.state.next({errors:f?t.errors:{}})},ur=(f,g,p)=>{const S=(E(s,f,{_f:{}})._f||{}).ref,k=E(t.errors,f)||{},{ref:_,message:T,type:U,...q}=k;B(t.errors,f,{...q,...g,ref:S}),m.state.next({name:f,errors:t.errors,isValid:!1}),p&&p.shouldFocus&&S&&S.focus&&S.focus()},En=(f,g)=>ge(f)?m.state.subscribe({next:p=>"values"in p&&f(R(void 0,g),p)}):R(f,g,!0),hr=f=>m.state.subscribe({next:g=>{Ol(f.name,g.name,f.exact)&&Al(g,f.formState||u,$n,f.reRenderRoot)&&f.callback({values:{...a},...t,...g,defaultValues:n})}}).unsubscribe,Cn=f=>(o.mount=!0,h={...h,...f.formState},hr({...f,formState:h})),os=(f,g={})=>{for(const p of f?bt(f):l.mount)l.mount.delete(p),l.array.delete(p),g.keepValue||(H(s,p),H(a,p)),!g.keepError&&H(t.errors,p),!g.keepDirty&&H(t.dirtyFields,p),!g.keepTouched&&H(t.touchedFields,p),!g.keepIsValidating&&H(t.validatingFields,p),!e.shouldUnregister&&!g.keepDefaultValue&&H(n,p);m.state.next({values:Y(a)}),m.state.next({...t,...g.keepDirty?{isDirty:M()}:{}}),!g.keepIsValid&&b()},fr=({disabled:f,name:g})=>{(be(f)&&o.mount||f||l.disabled.has(g))&&(f?l.disabled.add(g):l.disabled.delete(g))},ls=(f,g={})=>{let p=E(s,f);const S=be(g.disabled)||be(e.disabled);return B(s,f,{...p||{},_f:{...p&&p._f?p._f:{ref:{name:f}},name:f,mount:!0,...g}}),l.mount.add(f),p?fr({disabled:be(g.disabled)?g.disabled:e.disabled,name:f}):C(f,!0,g.value),{...S?{disabled:g.disabled||e.disabled}:{},...e.progressive?{required:!!g.required,min:mt(g.min),max:mt(g.max),minLength:mt(g.minLength),maxLength:mt(g.maxLength),pattern:mt(g.pattern)}:{},name:f,onChange:xe,onBlur:xe,ref:k=>{if(k){ls(f,g),p=E(s,f);const _=K(k.value)&&k.querySelectorAll&&k.querySelectorAll("input,select,textarea")[0]||k,T=Nl(_),U=p._f.refs||[];if(T?U.find(q=>q===_):_===p._f.ref)return;B(s,f,{_f:{...p._f,...T?{refs:[...U.filter(bs),_,...Array.isArray(E(n,f))?[{}]:[]],ref:{type:_.type,name:f}}:{ref:_}}}),C(f,!1,void 0,_)}else p=E(s,f,{}),p._f&&(p._f.mount=!1),(e.shouldUnregister||g.shouldUnregister)&&!(yl(l.array,f)&&o.action)&&l.unMount.add(f)}}},cs=()=>e.shouldFocusError&&vt(s,ut,l.mount),Tn=f=>{be(f)&&(m.state.next({disabled:f}),vt(s,(g,p)=>{const S=E(s,p);S&&(g.disabled=S._f.disabled||f,Array.isArray(S._f.refs)&&S._f.refs.forEach(k=>{k.disabled=S._f.disabled||f}))},0,!1))},mr=(f,g)=>async p=>{let S;p&&(p.preventDefault&&p.preventDefault(),p.persist&&p.persist());let k=Y(a);if(m.state.next({isSubmitting:!0}),e.resolver){const{errors:_,values:T}=await F();t.errors=_,k=Y(T)}else await G(s);if(l.disabled.size)for(const _ of l.disabled)H(k,_);if(H(t.errors,"root"),oe(t.errors)){m.state.next({errors:{}});try{await f(k,p)}catch(_){S=_}}else g&&await g({...t.errors},p),cs(),setTimeout(cs);if(m.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:oe(t.errors)&&!S,submitCount:t.submitCount+1,errors:t.errors}),S)throw S},An=(f,g={})=>{E(s,f)&&(K(g.defaultValue)?re(f,Y(E(n,f))):(re(f,g.defaultValue),B(n,f,Y(g.defaultValue))),g.keepTouched||H(t.touchedFields,f),g.keepDirty||(H(t.dirtyFields,f),t.isDirty=g.defaultValue?M(f,Y(E(n,f))):M()),g.keepError||(H(t.errors,f),u.isValid&&b()),m.state.next({...t}))},gr=(f,g={})=>{const p=f?Y(f):n,S=Y(p),k=oe(f),_=k?n:S;if(g.keepDefaultValues||(n=p),!g.keepValues){if(g.keepDirtyValues){const T=new Set([...l.mount,...Object.keys(ft(n,a))]);for(const U of Array.from(T))E(t.dirtyFields,U)?B(_,U,E(a,U)):re(U,E(_,U))}else{if(Zs&&K(f))for(const T of l.mount){const U=E(s,T);if(U&&U._f){const q=Array.isArray(U._f.refs)?U._f.refs[0]:U._f.ref;if(Vt(q)){const de=q.closest("form");if(de){de.reset();break}}}}if(g.keepFieldsRef)for(const T of l.mount)re(T,E(_,T));else s={}}a=e.shouldUnregister?g.keepDefaultValues?Y(n):{}:Y(_),m.array.next({values:{..._}}),m.state.next({values:{..._}})}l={mount:g.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!u.isValid||!!g.keepIsValid||!!g.keepDirtyValues,o.watch=!!e.shouldUnregister,m.state.next({submitCount:g.keepSubmitCount?t.submitCount:0,isDirty:k?!1:g.keepDirty?t.isDirty:!!(g.keepDefaultValues&&!Pe(f,n)),isSubmitted:g.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:k?{}:g.keepDirtyValues?g.keepDefaultValues&&a?ft(n,a):t.dirtyFields:g.keepDefaultValues&&f?ft(n,f):g.keepDirty?t.dirtyFields:{},touchedFields:g.keepTouched?t.touchedFields:{},errors:g.keepErrors?t.errors:{},isSubmitSuccessful:g.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:n})},pr=(f,g)=>gr(ge(f)?f(a):f,g),On=(f,g={})=>{const p=E(s,f),S=p&&p._f;if(S){const k=S.refs?S.refs[0]:S.ref;k.focus&&(k.focus(),g.shouldSelect&&ge(k.select)&&k.select())}},$n=f=>{t={...t,...f}},xr={control:{register:ls,unregister:os,getFieldState:dr,handleSubmit:mr,setError:ur,_subscribe:hr,_runSchema:F,_focusError:cs,_getWatch:R,_getDirty:M,_setValid:b,_setFieldArray:j,_setDisabledField:fr,_setErrors:v,_getFieldArray:D,_reset:gr,_resetDefaultValues:()=>ge(e.defaultValues)&&e.defaultValues().then(f=>{pr(f,e.resetOptions),m.state.next({isLoading:!1})}),_removeUnmounted:ce,_disableForm:Tn,_subjects:m,_proxyFormState:u,get _fields(){return s},get _formValues(){return a},get _state(){return o},set _state(f){o=f},get _defaultValues(){return n},get _names(){return l},set _names(f){l=f},get _formState(){return t},get _options(){return e},set _options(f){e={...e,...f}}},subscribe:Cn,trigger:Ge,register:ls,handleSubmit:mr,watch:En,setValue:re,getValues:At,reset:pr,resetField:An,clearErrors:Sn,unregister:os,setError:ur,setFocus:On,getFieldState:dr};return{...xr,formControl:xr}}function en(r={}){const e=Q.useRef(void 0),t=Q.useRef(void 0),[s,n]=Q.useState({isDirty:!1,isValidating:!1,isLoading:ge(r.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1,isReady:!1,defaultValues:ge(r.defaultValues)?void 0:r.defaultValues});if(!e.current)if(r.formControl)e.current={...r.formControl,formState:s},r.defaultValues&&!ge(r.defaultValues)&&r.formControl.reset(r.defaultValues,r.resetOptions);else{const{formControl:o,...l}=Il(r);e.current={...l,formState:s}}const a=e.current.control;return a._options=r,jl(()=>{const o=a._subscribe({formState:a._proxyFormState,callback:()=>n({...a._formState}),reRenderRoot:!0});return n(l=>({...l,isReady:!0})),a._formState.isReady=!0,o},[a]),Q.useEffect(()=>a._disableForm(r.disabled),[a,r.disabled]),Q.useEffect(()=>{r.mode&&(a._options.mode=r.mode),r.reValidateMode&&(a._options.reValidateMode=r.reValidateMode)},[a,r.mode,r.reValidateMode]),Q.useEffect(()=>{r.errors&&(a._setErrors(r.errors),a._focusError())},[a,r.errors]),Q.useEffect(()=>{r.shouldUnregister&&a._subjects.state.next({values:a._getWatch()})},[a,r.shouldUnregister]),Q.useEffect(()=>{if(a._proxyFormState.isDirty){const o=a._getDirty();o!==s.isDirty&&a._subjects.state.next({isDirty:o})}},[a,s.isDirty]),Q.useEffect(()=>{r.values&&!Pe(r.values,t.current)?(a._reset(r.values,{keepFieldsRef:!0,...a._options.resetOptions}),t.current=r.values,n(o=>({...o}))):a._resetDefaultValues()},[a,r.values]),Q.useEffect(()=>{a._state.mount||(a._setValid(),a._state.mount=!0),a._state.watch&&(a._state.watch=!1,a._subjects.state.next({...a._formState})),a._removeUnmounted()}),e.current.formState=wl(s,a),e.current}const Qr=(r,e,t)=>{if(r&&"reportValidity"in r){const s=E(t,e);r.setCustomValidity(s&&s.message||""),r.reportValidity()}},tn=(r,e)=>{for(const t in e.fields){const s=e.fields[t];s&&s.ref&&"reportValidity"in s.ref?Qr(s.ref,t,r):s&&s.refs&&s.refs.forEach(n=>Qr(n,t,r))}},Dl=(r,e)=>{e.shouldUseNativeValidation&&tn(r,e);const t={};for(const s in r){const n=E(e.fields,s),a=Object.assign(r[s]||{},{ref:n&&n.ref});if(Ll(e.names||Object.keys(r),s)){const o=Object.assign({},E(t,s));B(o,"root",a),B(t,s,o)}else B(t,s,a)}return t},Ll=(r,e)=>{const t=Xr(e);return r.some(s=>Xr(s).match(`^${t}\\.\\d+`))};function Xr(r){return r.replace(/\]|\[/g,"")}function sn(r,e,t){return t===void 0&&(t={}),function(s,n,a){try{return Promise.resolve(function(o,l){try{var c=(e!=null&&e.context,Promise.resolve(r[t.mode==="sync"?"validateSync":"validate"](s,Object.assign({abortEarly:!1},e,{context:n}))).then(function(d){return a.shouldUseNativeValidation&&tn({},a),{values:t.raw?Object.assign({},s):d,errors:{}}}))}catch(d){return l(d)}return c&&c.then?c.then(void 0,l):c}(0,function(o){if(!o.inner)throw o;return{values:{},errors:Dl((l=o,c=!a.shouldUseNativeValidation&&a.criteriaMode==="all",(l.inner||[]).reduce(function(d,u){if(d[u.path]||(d[u.path]={message:u.message,type:u.type}),c){var h=d[u.path].types,m=h&&h[u.type];d[u.path]=Ki(u.path,c,d,u.type,m?[].concat(m,u.message):u.message)}return d},{})),a)};var l,c}))}catch(o){return Promise.reject(o)}}}function Ke(r){this._maxSize=r,this.clear()}Ke.prototype.clear=function(){this._size=0,this._values=Object.create(null)};Ke.prototype.get=function(r){return this._values[r]};Ke.prototype.set=function(r,e){return this._size>=this._maxSize&&this.clear(),r in this._values||this._size++,this._values[r]=e};var Ul=/[^.^\]^[]+|(?=\[\]|\.\.)/g,rn=/^\d+$/,Ml=/^\d/,Bl=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,ql=/^\s*(['"]?)(.*?)(\1)\s*$/,sr=512,ei=new Ke(sr),ti=new Ke(sr),si=new Ke(sr),ze={Cache:Ke,split:Ds,normalizePath:vs,setter:function(r){var e=vs(r);return ti.get(r)||ti.set(r,function(s,n){for(var a=0,o=e.length,l=s;a<o-1;){var c=e[a];if(c==="__proto__"||c==="constructor"||c==="prototype")return s;l=l[e[a++]]}l[e[a]]=n})},getter:function(r,e){var t=vs(r);return si.get(r)||si.set(r,function(n){for(var a=0,o=t.length;a<o;)if(n!=null||!e)n=n[t[a++]];else return;return n})},join:function(r){return r.reduce(function(e,t){return e+(rr(t)||rn.test(t)?"["+t+"]":(e?".":"")+t)},"")},forEach:function(r,e,t){Vl(Array.isArray(r)?r:Ds(r),e,t)}};function vs(r){return ei.get(r)||ei.set(r,Ds(r).map(function(e){return e.replace(ql,"$2")}))}function Ds(r){return r.match(Ul)||[""]}function Vl(r,e,t){var s=r.length,n,a,o,l;for(a=0;a<s;a++)n=r[a],n&&(Hl(n)&&(n='"'+n+'"'),l=rr(n),o=!l&&/^\d+$/.test(n),e.call(t,n,l,o,a,r))}function rr(r){return typeof r=="string"&&r&&["'",'"'].indexOf(r.charAt(0))!==-1}function Wl(r){return r.match(Ml)&&!r.match(rn)}function zl(r){return Bl.test(r)}function Hl(r){return!rr(r)&&(Wl(r)||zl(r))}const Kl=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,is=r=>r.match(Kl)||[],ns=r=>r[0].toUpperCase()+r.slice(1),ir=(r,e)=>is(r).join(e).toLowerCase(),nn=r=>is(r).reduce((e,t)=>`${e}${e?t[0].toUpperCase()+t.slice(1).toLowerCase():t.toLowerCase()}`,""),Gl=r=>ns(nn(r)),Jl=r=>ir(r,"_"),Yl=r=>ir(r,"-"),Zl=r=>ns(ir(r," ")),Ql=r=>is(r).map(ns).join(" ");var ws={words:is,upperFirst:ns,camelCase:nn,pascalCase:Gl,snakeCase:Jl,kebabCase:Yl,sentenceCase:Zl,titleCase:Ql},nr={exports:{}};nr.exports=function(r){return an(Xl(r),r)};nr.exports.array=an;function an(r,e){var t=r.length,s=new Array(t),n={},a=t,o=ec(e),l=tc(r);for(e.forEach(function(d){if(!l.has(d[0])||!l.has(d[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});a--;)n[a]||c(r[a],a,new Set);return s;function c(d,u,h){if(h.has(d)){var m;try{m=", node was:"+JSON.stringify(d)}catch{m=""}throw new Error("Cyclic dependency"+m)}if(!l.has(d))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(d));if(!n[u]){n[u]=!0;var y=o.get(d)||new Set;if(y=Array.from(y),u=y.length){h.add(d);do{var w=y[--u];c(w,l.get(w),h)}while(u);h.delete(d)}s[--t]=d}}}function Xl(r){for(var e=new Set,t=0,s=r.length;t<s;t++){var n=r[t];e.add(n[0]),e.add(n[1])}return Array.from(e)}function ec(r){for(var e=new Map,t=0,s=r.length;t<s;t++){var n=r[t];e.has(n[0])||e.set(n[0],new Set),e.has(n[1])||e.set(n[1],new Set),e.get(n[0]).add(n[1])}return e}function tc(r){for(var e=new Map,t=0,s=r.length;t<s;t++)e.set(r[t],t);return e}var sc=nr.exports;const rc=Ln(sc),ic=Object.prototype.toString,nc=Error.prototype.toString,ac=RegExp.prototype.toString,oc=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",lc=/^Symbol\((.*)\)(.*)$/;function cc(r){return r!=+r?"NaN":r===0&&1/r<0?"-0":""+r}function ri(r,e=!1){if(r==null||r===!0||r===!1)return""+r;const t=typeof r;if(t==="number")return cc(r);if(t==="string")return e?`"${r}"`:r;if(t==="function")return"[Function "+(r.name||"anonymous")+"]";if(t==="symbol")return oc.call(r).replace(lc,"Symbol($1)");const s=ic.call(r).slice(8,-1);return s==="Date"?isNaN(r.getTime())?""+r:r.toISOString(r):s==="Error"||r instanceof Error?"["+nc.call(r)+"]":s==="RegExp"?ac.call(r):null}function Fe(r,e){let t=ri(r,e);return t!==null?t:JSON.stringify(r,function(s,n){let a=ri(this[s],e);return a!==null?a:n},2)}function on(r){return r==null?[]:[].concat(r)}let ln,cn,dn,dc=/\$\{\s*(\w+)\s*\}/g;ln=Symbol.toStringTag;class ii{constructor(e,t,s,n){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[ln]="Error",this.name="ValidationError",this.value=t,this.path=s,this.type=n,this.errors=[],this.inner=[],on(e).forEach(a=>{if(se.isError(a)){this.errors.push(...a.errors);const o=a.inner.length?a.inner:[a];this.inner.push(...o)}else this.errors.push(a)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}cn=Symbol.hasInstance;dn=Symbol.toStringTag;class se extends Error{static formatError(e,t){const s=t.label||t.path||"this";return t=Object.assign({},t,{path:s,originalPath:t.path}),typeof e=="string"?e.replace(dc,(n,a)=>Fe(t[a])):typeof e=="function"?e(t):e}static isError(e){return e&&e.name==="ValidationError"}constructor(e,t,s,n,a){const o=new ii(e,t,s,n);if(a)return o;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[dn]="Error",this.name=o.name,this.message=o.message,this.type=o.type,this.value=o.value,this.path=o.path,this.errors=o.errors,this.inner=o.inner,Error.captureStackTrace&&Error.captureStackTrace(this,se)}static[cn](e){return ii[Symbol.hasInstance](e)||super[Symbol.hasInstance](e)}}let ve={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:r,type:e,value:t,originalValue:s})=>{const n=s!=null&&s!==t?` (cast from the value \`${Fe(s,!0)}\`).`:".";return e!=="mixed"?`${r} must be a \`${e}\` type, but the final value was: \`${Fe(t,!0)}\``+n:`${r} must match the configured type. The validated value was: \`${Fe(t,!0)}\``+n}},ae={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},uc={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},Ls={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},hc={isValue:"${path} field must be ${value}"},Lt={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},fc={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},mc={notType:r=>{const{path:e,value:t,spec:s}=r,n=s.types.length;if(Array.isArray(t)){if(t.length<n)return`${e} tuple value has too few items, expected a length of ${n} but got ${t.length} for value: \`${Fe(t,!0)}\``;if(t.length>n)return`${e} tuple value has too many items, expected a length of ${n} but got ${t.length} for value: \`${Fe(t,!0)}\``}return se.formatError(ve.notType,r)}};Object.assign(Object.create(null),{mixed:ve,string:ae,number:uc,date:Ls,object:Lt,array:fc,boolean:hc,tuple:mc});const ar=r=>r&&r.__isYupSchema__;class Ht{static fromOptions(e,t){if(!t.then&&!t.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:s,then:n,otherwise:a}=t,o=typeof s=="function"?s:(...l)=>l.every(c=>c===s);return new Ht(e,(l,c)=>{var d;let u=o(...l)?n:a;return(d=u==null?void 0:u(c))!=null?d:c})}constructor(e,t){this.fn=void 0,this.refs=e,this.refs=e,this.fn=t}resolve(e,t){let s=this.refs.map(a=>a.getValue(t==null?void 0:t.value,t==null?void 0:t.parent,t==null?void 0:t.context)),n=this.fn(s,e,t);if(n===void 0||n===e)return e;if(!ar(n))throw new TypeError("conditions must return a schema object");return n.resolve(t)}}const It={context:"$",value:"."};function gc(r,e){return new Ie(r,e)}class Ie{constructor(e,t={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof e!="string")throw new TypeError("ref must be a string, got: "+e);if(this.key=e.trim(),e==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===It.context,this.isValue=this.key[0]===It.value,this.isSibling=!this.isContext&&!this.isValue;let s=this.isContext?It.context:this.isValue?It.value:"";this.path=this.key.slice(s.length),this.getter=this.path&&ze.getter(this.path,!0),this.map=t.map}getValue(e,t,s){let n=this.isContext?s:this.isValue?e:t;return this.getter&&(n=this.getter(n||{})),this.map&&(n=this.map(n)),n}cast(e,t){return this.getValue(e,t==null?void 0:t.parent,t==null?void 0:t.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(e){return e&&e.__isYupRef}}Ie.prototype.__isYupRef=!0;const Ve=r=>r==null;function tt(r){function e({value:t,path:s="",options:n,originalValue:a,schema:o},l,c){const{name:d,test:u,params:h,message:m,skipAbsent:y}=r;let{parent:w,context:b,abortEarly:N=o.spec.abortEarly,disableStackTrace:j=o.spec.disableStackTrace}=n;const x={value:t,parent:w,context:b};function v(M={}){const R=un(Object.assign({value:t,originalValue:a,label:o.spec.label,path:M.path||s,spec:o.spec,disableStackTrace:M.disableStackTrace||j},h,M.params),x),D=new se(se.formatError(M.message||m,R),t,R.path,M.type||d,R.disableStackTrace);return D.params=R,D}const C=N?l:c;let A={path:s,parent:w,type:d,from:n.from,createError:v,resolve(M){return hn(M,x)},options:n,originalValue:a,schema:o};const $=M=>{se.isError(M)?C(M):M?c(null):C(v())},F=M=>{se.isError(M)?C(M):l(M)};if(y&&Ve(t))return $(!0);let G;try{var ce;if(G=u.call(A,t,A),typeof((ce=G)==null?void 0:ce.then)=="function"){if(n.sync)throw new Error(`Validation test of type: "${A.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(G).then($,F)}}catch(M){F(M);return}$(G)}return e.OPTIONS=r,e}function un(r,e){if(!r)return r;for(const t of Object.keys(r))r[t]=hn(r[t],e);return r}function hn(r,e){return Ie.isRef(r)?r.getValue(e.value,e.parent,e.context):r}function pc(r,e,t,s=t){let n,a,o;return e?(ze.forEach(e,(l,c,d)=>{let u=c?l.slice(1,l.length-1):l;r=r.resolve({context:s,parent:n,value:t});let h=r.type==="tuple",m=d?parseInt(u,10):0;if(r.innerType||h){if(h&&!d)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${o}" must contain an index to the tuple element, e.g. "${o}[0]"`);if(t&&m>=t.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${l}, in the path: ${e}. because there is no value at that index. `);n=t,t=t&&t[m],r=h?r.spec.types[m]:r.innerType}if(!d){if(!r.fields||!r.fields[u])throw new Error(`The schema does not contain the path: ${e}. (failed at: ${o} which is a type: "${r.type}")`);n=t,t=t&&t[u],r=r.fields[u]}a=u,o=c?"["+l+"]":"."+l}),{schema:r,parent:n,parentPath:a}):{parent:n,parentPath:e,schema:r}}class Kt extends Set{describe(){const e=[];for(const t of this.values())e.push(Ie.isRef(t)?t.describe():t);return e}resolveAll(e){let t=[];for(const s of this.values())t.push(e(s));return t}clone(){return new Kt(this.values())}merge(e,t){const s=this.clone();return e.forEach(n=>s.add(n)),t.forEach(n=>s.delete(n)),s}}function it(r,e=new Map){if(ar(r)||!r||typeof r!="object")return r;if(e.has(r))return e.get(r);let t;if(r instanceof Date)t=new Date(r.getTime()),e.set(r,t);else if(r instanceof RegExp)t=new RegExp(r),e.set(r,t);else if(Array.isArray(r)){t=new Array(r.length),e.set(r,t);for(let s=0;s<r.length;s++)t[s]=it(r[s],e)}else if(r instanceof Map){t=new Map,e.set(r,t);for(const[s,n]of r.entries())t.set(s,it(n,e))}else if(r instanceof Set){t=new Set,e.set(r,t);for(const s of r)t.add(it(s,e))}else if(r instanceof Object){t={},e.set(r,t);for(const[s,n]of Object.entries(r))t[s]=it(n,e)}else throw Error(`Unable to clone ${r}`);return t}function xc(r){if(!(r!=null&&r.length))return;const e=[];let t="",s=!1,n=!1;for(let a=0;a<r.length;a++){const o=r[a];if(o==="["&&!n){t&&(e.push(...t.split(".").filter(Boolean)),t=""),s=!0;continue}if(o==="]"&&!n){t&&(/^\d+$/.test(t)?e.push(t):e.push(t.replace(/^"|"$/g,"")),t=""),s=!1;continue}if(o==='"'){n=!n;continue}if(o==="."&&!s&&!n){t&&(e.push(t),t="");continue}t+=o}return t&&e.push(...t.split(".").filter(Boolean)),e}function yc(r,e){const t=e?`${e}.${r.path}`:r.path;return r.errors.map(s=>({message:s,path:xc(t)}))}function fn(r,e){var t;if(!((t=r.inner)!=null&&t.length)&&r.errors.length)return yc(r,e);const s=e?`${e}.${r.path}`:r.path;return r.inner.flatMap(n=>fn(n,s))}class _e{constructor(e){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new Kt,this._blacklist=new Kt,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(ve.notType)}),this.type=e.type,this._typeCheck=e.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},e==null?void 0:e.spec),this.withMutation(t=>{t.nonNullable()})}get _type(){return this.type}clone(e){if(this._mutate)return e&&Object.assign(this.spec,e),this;const t=Object.create(Object.getPrototypeOf(this));return t.type=this.type,t._typeCheck=this._typeCheck,t._whitelist=this._whitelist.clone(),t._blacklist=this._blacklist.clone(),t.internalTests=Object.assign({},this.internalTests),t.exclusiveTests=Object.assign({},this.exclusiveTests),t.deps=[...this.deps],t.conditions=[...this.conditions],t.tests=[...this.tests],t.transforms=[...this.transforms],t.spec=it(Object.assign({},this.spec,e)),t}label(e){let t=this.clone();return t.spec.label=e,t}meta(...e){if(e.length===0)return this.spec.meta;let t=this.clone();return t.spec.meta=Object.assign(t.spec.meta||{},e[0]),t}withMutation(e){let t=this._mutate;this._mutate=!0;let s=e(this);return this._mutate=t,s}concat(e){if(!e||e===this)return this;if(e.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${e.type}`);let t=this,s=e.clone();const n=Object.assign({},t.spec,s.spec);return s.spec=n,s.internalTests=Object.assign({},t.internalTests,s.internalTests),s._whitelist=t._whitelist.merge(e._whitelist,e._blacklist),s._blacklist=t._blacklist.merge(e._blacklist,e._whitelist),s.tests=t.tests,s.exclusiveTests=t.exclusiveTests,s.withMutation(a=>{e.tests.forEach(o=>{a.test(o.OPTIONS)})}),s.transforms=[...t.transforms,...s.transforms],s}isType(e){return e==null?!!(this.spec.nullable&&e===null||this.spec.optional&&e===void 0):this._typeCheck(e)}resolve(e){let t=this;if(t.conditions.length){let s=t.conditions;t=t.clone(),t.conditions=[],t=s.reduce((n,a)=>a.resolve(n,e),t),t=t.resolve(e)}return t}resolveOptions(e){var t,s,n,a;return Object.assign({},e,{from:e.from||[],strict:(t=e.strict)!=null?t:this.spec.strict,abortEarly:(s=e.abortEarly)!=null?s:this.spec.abortEarly,recursive:(n=e.recursive)!=null?n:this.spec.recursive,disableStackTrace:(a=e.disableStackTrace)!=null?a:this.spec.disableStackTrace})}cast(e,t={}){let s=this.resolve(Object.assign({value:e},t)),n=t.assert==="ignore-optionality",a=s._cast(e,t);if(t.assert!==!1&&!s.isType(a)){if(n&&Ve(a))return a;let o=Fe(e),l=Fe(a);throw new TypeError(`The value of ${t.path||"field"} could not be cast to a value that satisfies the schema type: "${s.type}". 

attempted value: ${o} 
`+(l!==o?`result of cast: ${l}`:""))}return a}_cast(e,t){let s=e===void 0?e:this.transforms.reduce((n,a)=>a.call(this,n,e,this),e);return s===void 0&&(s=this.getDefault(t)),s}_validate(e,t={},s,n){let{path:a,originalValue:o=e,strict:l=this.spec.strict}=t,c=e;l||(c=this._cast(c,Object.assign({assert:!1},t)));let d=[];for(let u of Object.values(this.internalTests))u&&d.push(u);this.runTests({path:a,value:c,originalValue:o,options:t,tests:d},s,u=>{if(u.length)return n(u,c);this.runTests({path:a,value:c,originalValue:o,options:t,tests:this.tests},s,n)})}runTests(e,t,s){let n=!1,{tests:a,value:o,originalValue:l,path:c,options:d}=e,u=b=>{n||(n=!0,t(b,o))},h=b=>{n||(n=!0,s(b,o))},m=a.length,y=[];if(!m)return h([]);let w={value:o,originalValue:l,path:c,options:d,schema:this};for(let b=0;b<a.length;b++){const N=a[b];N(w,u,function(x){x&&(Array.isArray(x)?y.push(...x):y.push(x)),--m<=0&&h(y)})}}asNestedTest({key:e,index:t,parent:s,parentPath:n,originalParent:a,options:o}){const l=e??t;if(l==null)throw TypeError("Must include `key` or `index` for nested validations");const c=typeof l=="number";let d=s[l];const u=Object.assign({},o,{strict:!0,parent:s,value:d,originalValue:a[l],key:void 0,[c?"index":"key"]:l,path:c||l.includes(".")?`${n||""}[${c?l:`"${l}"`}]`:(n?`${n}.`:"")+e});return(h,m,y)=>this.resolve(u)._validate(d,u,m,y)}validate(e,t){var s;let n=this.resolve(Object.assign({},t,{value:e})),a=(s=t==null?void 0:t.disableStackTrace)!=null?s:n.spec.disableStackTrace;return new Promise((o,l)=>n._validate(e,t,(c,d)=>{se.isError(c)&&(c.value=d),l(c)},(c,d)=>{c.length?l(new se(c,d,void 0,void 0,a)):o(d)}))}validateSync(e,t){var s;let n=this.resolve(Object.assign({},t,{value:e})),a,o=(s=t==null?void 0:t.disableStackTrace)!=null?s:n.spec.disableStackTrace;return n._validate(e,Object.assign({},t,{sync:!0}),(l,c)=>{throw se.isError(l)&&(l.value=c),l},(l,c)=>{if(l.length)throw new se(l,e,void 0,void 0,o);a=c}),a}isValid(e,t){return this.validate(e,t).then(()=>!0,s=>{if(se.isError(s))return!1;throw s})}isValidSync(e,t){try{return this.validateSync(e,t),!0}catch(s){if(se.isError(s))return!1;throw s}}_getDefault(e){let t=this.spec.default;return t==null?t:typeof t=="function"?t.call(this,e):it(t)}getDefault(e){return this.resolve(e||{})._getDefault(e)}default(e){return arguments.length===0?this._getDefault():this.clone({default:e})}strict(e=!0){return this.clone({strict:e})}nullability(e,t){const s=this.clone({nullable:e});return s.internalTests.nullable=tt({message:t,name:"nullable",test(n){return n===null?this.schema.spec.nullable:!0}}),s}optionality(e,t){const s=this.clone({optional:e});return s.internalTests.optionality=tt({message:t,name:"optionality",test(n){return n===void 0?this.schema.spec.optional:!0}}),s}optional(){return this.optionality(!0)}defined(e=ve.defined){return this.optionality(!1,e)}nullable(){return this.nullability(!0)}nonNullable(e=ve.notNull){return this.nullability(!1,e)}required(e=ve.required){return this.clone().withMutation(t=>t.nonNullable(e).defined(e))}notRequired(){return this.clone().withMutation(e=>e.nullable().optional())}transform(e){let t=this.clone();return t.transforms.push(e),t}test(...e){let t;if(e.length===1?typeof e[0]=="function"?t={test:e[0]}:t=e[0]:e.length===2?t={name:e[0],test:e[1]}:t={name:e[0],message:e[1],test:e[2]},t.message===void 0&&(t.message=ve.default),typeof t.test!="function")throw new TypeError("`test` is a required parameters");let s=this.clone(),n=tt(t),a=t.exclusive||t.name&&s.exclusiveTests[t.name]===!0;if(t.exclusive&&!t.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return t.name&&(s.exclusiveTests[t.name]=!!t.exclusive),s.tests=s.tests.filter(o=>!(o.OPTIONS.name===t.name&&(a||o.OPTIONS.test===n.OPTIONS.test))),s.tests.push(n),s}when(e,t){!Array.isArray(e)&&typeof e!="string"&&(t=e,e=".");let s=this.clone(),n=on(e).map(a=>new Ie(a));return n.forEach(a=>{a.isSibling&&s.deps.push(a.key)}),s.conditions.push(typeof t=="function"?new Ht(n,t):Ht.fromOptions(n,t)),s}typeError(e){let t=this.clone();return t.internalTests.typeError=tt({message:e,name:"typeError",skipAbsent:!0,test(s){return this.schema._typeCheck(s)?!0:this.createError({params:{type:this.schema.type}})}}),t}oneOf(e,t=ve.oneOf){let s=this.clone();return e.forEach(n=>{s._whitelist.add(n),s._blacklist.delete(n)}),s.internalTests.whiteList=tt({message:t,name:"oneOf",skipAbsent:!0,test(n){let a=this.schema._whitelist,o=a.resolveAll(this.resolve);return o.includes(n)?!0:this.createError({params:{values:Array.from(a).join(", "),resolved:o}})}}),s}notOneOf(e,t=ve.notOneOf){let s=this.clone();return e.forEach(n=>{s._blacklist.add(n),s._whitelist.delete(n)}),s.internalTests.blacklist=tt({message:t,name:"notOneOf",test(n){let a=this.schema._blacklist,o=a.resolveAll(this.resolve);return o.includes(n)?this.createError({params:{values:Array.from(a).join(", "),resolved:o}}):!0}}),s}strip(e=!0){let t=this.clone();return t.spec.strip=e,t}describe(e){const t=(e?this.resolve(e):this).clone(),{label:s,meta:n,optional:a,nullable:o}=t.spec;return{meta:n,label:s,optional:a,nullable:o,default:t.getDefault(e),type:t.type,oneOf:t._whitelist.describe(),notOneOf:t._blacklist.describe(),tests:t.tests.filter((c,d,u)=>u.findIndex(h=>h.OPTIONS.name===c.OPTIONS.name)===d).map(c=>{const d=c.OPTIONS.params&&e?un(Object.assign({},c.OPTIONS.params),e):c.OPTIONS.params;return{name:c.OPTIONS.name,params:d}})}}get"~standard"(){const e=this;return{version:1,vendor:"yup",async validate(s){try{return{value:await e.validate(s,{abortEarly:!1})}}catch(n){if(n instanceof se)return{issues:fn(n)};throw n}}}}}_e.prototype.__isYupSchema__=!0;for(const r of["validate","validateSync"])_e.prototype[`${r}At`]=function(e,t,s={}){const{parent:n,parentPath:a,schema:o}=pc(this,e,t,s.context);return o[r](n&&n[a],Object.assign({},s,{parent:n,path:e}))};for(const r of["equals","is"])_e.prototype[r]=_e.prototype.oneOf;for(const r of["not","nope"])_e.prototype[r]=_e.prototype.notOneOf;const bc=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function vc(r){const e=Us(r);if(!e)return Date.parse?Date.parse(r):Number.NaN;if(e.z===void 0&&e.plusMinus===void 0)return new Date(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond).valueOf();let t=0;return e.z!=="Z"&&e.plusMinus!==void 0&&(t=e.hourOffset*60+e.minuteOffset,e.plusMinus==="+"&&(t=0-t)),Date.UTC(e.year,e.month,e.day,e.hour,e.minute+t,e.second,e.millisecond)}function Us(r){var e,t;const s=bc.exec(r);return s?{year:ke(s[1]),month:ke(s[2],1)-1,day:ke(s[3],1),hour:ke(s[4]),minute:ke(s[5]),second:ke(s[6]),millisecond:s[7]?ke(s[7].substring(0,3)):0,precision:(e=(t=s[7])==null?void 0:t.length)!=null?e:void 0,z:s[8]||void 0,plusMinus:s[9]||void 0,hourOffset:ke(s[10]),minuteOffset:ke(s[11])}:null}function ke(r,e=0){return Number(r)||e}let wc=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,jc=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,_c=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,Nc="^\\d{4}-\\d{2}-\\d{2}",kc="\\d{2}:\\d{2}:\\d{2}",Sc="(([+-]\\d{2}(:?\\d{2})?)|Z)",Ec=new RegExp(`${Nc}T${kc}(\\.\\d+)?${Sc}$`),Cc=r=>Ve(r)||r===r.trim(),Tc={}.toString();function We(){return new mn}class mn extends _e{constructor(){super({type:"string",check(e){return e instanceof String&&(e=e.valueOf()),typeof e=="string"}}),this.withMutation(()=>{this.transform((e,t,s)=>{if(!s.spec.coerce||s.isType(e)||Array.isArray(e))return e;const n=e!=null&&e.toString?e.toString():e;return n===Tc?e:n})})}required(e){return super.required(e).withMutation(t=>t.test({message:e||ve.required,name:"required",skipAbsent:!0,test:s=>!!s.length}))}notRequired(){return super.notRequired().withMutation(e=>(e.tests=e.tests.filter(t=>t.OPTIONS.name!=="required"),e))}length(e,t=ae.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(s){return s.length===this.resolve(e)}})}min(e,t=ae.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(s){return s.length>=this.resolve(e)}})}max(e,t=ae.max){return this.test({name:"max",exclusive:!0,message:t,params:{max:e},skipAbsent:!0,test(s){return s.length<=this.resolve(e)}})}matches(e,t){let s=!1,n,a;return t&&(typeof t=="object"?{excludeEmptyString:s=!1,message:n,name:a}=t:n=t),this.test({name:a||"matches",message:n||ae.matches,params:{regex:e},skipAbsent:!0,test:o=>o===""&&s||o.search(e)!==-1})}email(e=ae.email){return this.matches(wc,{name:"email",message:e,excludeEmptyString:!0})}url(e=ae.url){return this.matches(jc,{name:"url",message:e,excludeEmptyString:!0})}uuid(e=ae.uuid){return this.matches(_c,{name:"uuid",message:e,excludeEmptyString:!1})}datetime(e){let t="",s,n;return e&&(typeof e=="object"?{message:t="",allowOffset:s=!1,precision:n=void 0}=e:t=e),this.matches(Ec,{name:"datetime",message:t||ae.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:t||ae.datetime_offset,params:{allowOffset:s},skipAbsent:!0,test:a=>{if(!a||s)return!0;const o=Us(a);return o?!!o.z:!1}}).test({name:"datetime_precision",message:t||ae.datetime_precision,params:{precision:n},skipAbsent:!0,test:a=>{if(!a||n==null)return!0;const o=Us(a);return o?o.precision===n:!1}})}ensure(){return this.default("").transform(e=>e===null?"":e)}trim(e=ae.trim){return this.transform(t=>t!=null?t.trim():t).test({message:e,name:"trim",test:Cc})}lowercase(e=ae.lowercase){return this.transform(t=>Ve(t)?t:t.toLowerCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Ve(t)||t===t.toLowerCase()})}uppercase(e=ae.uppercase){return this.transform(t=>Ve(t)?t:t.toUpperCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Ve(t)||t===t.toUpperCase()})}}We.prototype=mn.prototype;let Ac=new Date(""),Oc=r=>Object.prototype.toString.call(r)==="[object Date]";class as extends _e{constructor(){super({type:"date",check(e){return Oc(e)&&!isNaN(e.getTime())}}),this.withMutation(()=>{this.transform((e,t,s)=>!s.spec.coerce||s.isType(e)||e===null?e:(e=vc(e),isNaN(e)?as.INVALID_DATE:new Date(e)))})}prepareParam(e,t){let s;if(Ie.isRef(e))s=e;else{let n=this.cast(e);if(!this._typeCheck(n))throw new TypeError(`\`${t}\` must be a Date or a value that can be \`cast()\` to a Date`);s=n}return s}min(e,t=Ls.min){let s=this.prepareParam(e,"min");return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(n){return n>=this.resolve(s)}})}max(e,t=Ls.max){let s=this.prepareParam(e,"max");return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(n){return n<=this.resolve(s)}})}}as.INVALID_DATE=Ac;as.prototype;function $c(r,e=[]){let t=[],s=new Set,n=new Set(e.map(([o,l])=>`${o}-${l}`));function a(o,l){let c=ze.split(o)[0];s.add(c),n.has(`${l}-${c}`)||t.push([l,c])}for(const o of Object.keys(r)){let l=r[o];s.add(o),Ie.isRef(l)&&l.isSibling?a(l.path,o):ar(l)&&"deps"in l&&l.deps.forEach(c=>a(c,o))}return rc.array(Array.from(s),t).reverse()}function ni(r,e){let t=1/0;return r.some((s,n)=>{var a;if((a=e.path)!=null&&a.includes(s))return t=n,!0}),t}function gn(r){return(e,t)=>ni(r,e)-ni(r,t)}const Pc=(r,e,t)=>{if(typeof r!="string")return r;let s=r;try{s=JSON.parse(r)}catch{}return t.isType(s)?s:r};function Ut(r){if("fields"in r){const e={};for(const[t,s]of Object.entries(r.fields))e[t]=Ut(s);return r.setFields(e)}if(r.type==="array"){const e=r.optional();return e.innerType&&(e.innerType=Ut(e.innerType)),e}return r.type==="tuple"?r.optional().clone({types:r.spec.types.map(Ut)}):"optional"in r?r.optional():r}const Fc=(r,e)=>{const t=[...ze.normalizePath(e)];if(t.length===1)return t[0]in r;let s=t.pop(),n=ze.getter(ze.join(t),!0)(r);return!!(n&&s in n)};let ai=r=>Object.prototype.toString.call(r)==="[object Object]";function oi(r,e){let t=Object.keys(r.fields);return Object.keys(e).filter(s=>t.indexOf(s)===-1)}const Rc=gn([]);function or(r){return new pn(r)}class pn extends _e{constructor(e){super({type:"object",check(t){return ai(t)||typeof t=="function"}}),this.fields=Object.create(null),this._sortErrors=Rc,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{e&&this.shape(e)})}_cast(e,t={}){var s;let n=super._cast(e,t);if(n===void 0)return this.getDefault(t);if(!this._typeCheck(n))return n;let a=this.fields,o=(s=t.stripUnknown)!=null?s:this.spec.noUnknown,l=[].concat(this._nodes,Object.keys(n).filter(h=>!this._nodes.includes(h))),c={},d=Object.assign({},t,{parent:c,__validating:t.__validating||!1}),u=!1;for(const h of l){let m=a[h],y=h in n;if(m){let w,b=n[h];d.path=(t.path?`${t.path}.`:"")+h,m=m.resolve({value:b,context:t.context,parent:c});let N=m instanceof _e?m.spec:void 0,j=N==null?void 0:N.strict;if(N!=null&&N.strip){u=u||h in n;continue}w=!t.__validating||!j?m.cast(n[h],d):n[h],w!==void 0&&(c[h]=w)}else y&&!o&&(c[h]=n[h]);(y!==h in c||c[h]!==n[h])&&(u=!0)}return u?c:n}_validate(e,t={},s,n){let{from:a=[],originalValue:o=e,recursive:l=this.spec.recursive}=t;t.from=[{schema:this,value:o},...a],t.__validating=!0,t.originalValue=o,super._validate(e,t,s,(c,d)=>{if(!l||!ai(d)){n(c,d);return}o=o||d;let u=[];for(let h of this._nodes){let m=this.fields[h];!m||Ie.isRef(m)||u.push(m.asNestedTest({options:t,key:h,parent:d,parentPath:t.path,originalParent:o}))}this.runTests({tests:u,value:d,originalValue:o,options:t},s,h=>{n(h.sort(this._sortErrors).concat(c),d)})})}clone(e){const t=super.clone(e);return t.fields=Object.assign({},this.fields),t._nodes=this._nodes,t._excludedEdges=this._excludedEdges,t._sortErrors=this._sortErrors,t}concat(e){let t=super.concat(e),s=t.fields;for(let[n,a]of Object.entries(this.fields)){const o=s[n];s[n]=o===void 0?a:o}return t.withMutation(n=>n.setFields(s,[...this._excludedEdges,...e._excludedEdges]))}_getDefault(e){if("default"in this.spec)return super._getDefault(e);if(!this._nodes.length)return;let t={};return this._nodes.forEach(s=>{var n;const a=this.fields[s];let o=e;(n=o)!=null&&n.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[s]})),t[s]=a&&"getDefault"in a?a.getDefault(o):void 0}),t}setFields(e,t){let s=this.clone();return s.fields=e,s._nodes=$c(e,t),s._sortErrors=gn(Object.keys(e)),t&&(s._excludedEdges=t),s}shape(e,t=[]){return this.clone().withMutation(s=>{let n=s._excludedEdges;return t.length&&(Array.isArray(t[0])||(t=[t]),n=[...s._excludedEdges,...t]),s.setFields(Object.assign(s.fields,e),n)})}partial(){const e={};for(const[t,s]of Object.entries(this.fields))e[t]="optional"in s&&s.optional instanceof Function?s.optional():s;return this.setFields(e)}deepPartial(){return Ut(this)}pick(e){const t={};for(const s of e)this.fields[s]&&(t[s]=this.fields[s]);return this.setFields(t,this._excludedEdges.filter(([s,n])=>e.includes(s)&&e.includes(n)))}omit(e){const t=[];for(const s of Object.keys(this.fields))e.includes(s)||t.push(s);return this.pick(t)}from(e,t,s){let n=ze.getter(e,!0);return this.transform(a=>{if(!a)return a;let o=a;return Fc(a,e)&&(o=Object.assign({},a),s||delete o[e],o[t]=n(a)),o})}json(){return this.transform(Pc)}exact(e){return this.test({name:"exact",exclusive:!0,message:e||Lt.exact,test(t){if(t==null)return!0;const s=oi(this.schema,t);return s.length===0||this.createError({params:{properties:s.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(e=!0,t=Lt.noUnknown){typeof e!="boolean"&&(t=e,e=!0);let s=this.test({name:"noUnknown",exclusive:!0,message:t,test(n){if(n==null)return!0;const a=oi(this.schema,n);return!e||a.length===0||this.createError({params:{unknown:a.join(", ")}})}});return s.spec.noUnknown=e,s}unknown(e=!0,t=Lt.noUnknown){return this.noUnknown(!e,t)}transformKeys(e){return this.transform(t=>{if(!t)return t;const s={};for(const n of Object.keys(t))s[e(n)]=t[n];return s})}camelCase(){return this.transformKeys(ws.camelCase)}snakeCase(){return this.transformKeys(ws.snakeCase)}constantCase(){return this.transformKeys(e=>ws.snakeCase(e).toUpperCase())}describe(e){const t=(e?this.resolve(e):this).clone(),s=super.describe(e);s.fields={};for(const[a,o]of Object.entries(t.fields)){var n;let l=e;(n=l)!=null&&n.value&&(l=Object.assign({},l,{parent:l.value,value:l.value[a]})),s.fields[a]=o.describe(l)}return s}}or.prototype=pn.prototype;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ic={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dc=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),L=(r,e)=>{const t=O.forwardRef(({color:s="currentColor",size:n=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:l="",children:c,...d},u)=>O.createElement("svg",{ref:u,...Ic,width:n,height:n,stroke:s,strokeWidth:o?Number(a)*24/Number(n):a,className:["lucide",`lucide-${Dc(r)}`,l].join(" "),...d},[...e.map(([h,m])=>O.createElement(h,m)),...Array.isArray(c)?c:[c]]));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xn=L("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lc=L("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=L("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=L("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=L("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uc=L("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mc=L("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=L("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bn=L("Factory",[["path",{d:"M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"159hny"}],["path",{d:"M17 18h1",key:"uldtlt"}],["path",{d:"M12 18h1",key:"s9uhes"}],["path",{d:"M7 18h1",key:"1neino"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=L("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=L("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=L("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=L("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qc=L("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vc=L("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=L("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wc=L("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zc=L("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hc=L("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=L("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kc=L("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=L("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=L("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gc=L("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jc=L("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jn=L("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=L("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const li=L("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=L("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=L("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=L("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Zc=or({email:We().email("Invalid email").required("Email is required"),password:We().min(6,"Password must be at least 6 characters").required("Password is required")}),Qc=()=>{const[r,e]=O.useState(!1),[t,s]=O.useState(null),{signIn:n}=pe(),a=qs(),{register:o,handleSubmit:l,formState:{errors:c}}=en({resolver:sn(Zc)}),d=async u=>{try{e(!0),s(null);const{error:h}=await n(u.email,u.password);if(h)throw h;a("/dashboard")}catch(h){s(h.message)}finally{e(!1)}};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"max-w-md w-full space-y-8",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"flex justify-center",children:i.jsx("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 p-3 rounded-full",children:i.jsx(qc,{className:"h-8 w-8 text-white"})})}),i.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Sign in to your account"}),i.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Or"," ",i.jsx(pi,{to:"/register",className:"font-medium text-green-600 hover:text-green-500",children:"create a new account"})]})]}),i.jsxs("form",{className:"mt-8 space-y-6",onSubmit:l(d),children:[t&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center space-x-2",children:[i.jsx(xn,{className:"h-5 w-5 text-red-500"}),i.jsx("span",{className:"text-red-700",children:t})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),i.jsxs("div",{className:"mt-1 relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(wn,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{...o("email"),type:"email",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter your email"})]}),c.email&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.email.message})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),i.jsxs("div",{className:"mt-1 relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Ms,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{...o("password"),type:"password",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter your password"})]}),c.password&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.password.message})]})]}),i.jsx("div",{children:i.jsx("button",{type:"submit",disabled:r,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:r?"Signing in...":"Sign in"})})]})]})})},Xc=or({fullName:We().required("Full name is required"),email:We().email("Invalid email").required("Email is required"),password:We().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:We().oneOf([gc("password")],"Passwords must match").required("Please confirm your password")}),ed=()=>{const[r,e]=O.useState(!1),[t,s]=O.useState(null),[n,a]=O.useState(!1),{signUp:o}=pe(),l=qs(),{register:c,handleSubmit:d,formState:{errors:u}}=en({resolver:sn(Xc)}),h=async m=>{try{e(!0),s(null);const{error:y}=await o(m.email,m.password,m.fullName);if(y)throw y;a(!0),setTimeout(()=>l("/login"),2e3)}catch(y){s(y.message)}finally{e(!1)}};return n?i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:i.jsx("div",{className:"max-w-md w-full text-center",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[i.jsx("div",{className:"flex justify-center mb-4",children:i.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:i.jsx(li,{className:"h-8 w-8 text-green-600"})})}),i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Registration Successful!"}),i.jsx("p",{className:"text-gray-600",children:"Please check your email to verify your account."})]})})}):i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"max-w-md w-full space-y-8",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"flex justify-center",children:i.jsx("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 p-3 rounded-full",children:i.jsx(li,{className:"h-8 w-8 text-white"})})}),i.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Create your account"}),i.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Or"," ",i.jsx(pi,{to:"/login",className:"font-medium text-green-600 hover:text-green-500",children:"sign in to your existing account"})]})]}),i.jsxs("form",{className:"mt-8 space-y-6",onSubmit:d(h),children:[t&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center space-x-2",children:[i.jsx(xn,{className:"h-5 w-5 text-red-500"}),i.jsx("span",{className:"text-red-700",children:t})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),i.jsxs("div",{className:"mt-1 relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(_n,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{...c("fullName"),type:"text",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter your full name"})]}),u.fullName&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.fullName.message})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),i.jsxs("div",{className:"mt-1 relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(wn,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{...c("email"),type:"email",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter your email"})]}),u.email&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.email.message})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),i.jsxs("div",{className:"mt-1 relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Ms,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{...c("password"),type:"password",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter your password"})]}),u.password&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.password.message})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),i.jsxs("div",{className:"mt-1 relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Ms,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{...c("confirmPassword"),type:"password",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Confirm your password"})]}),u.confirmPassword&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.confirmPassword.message})]})]}),i.jsx("div",{children:i.jsx("button",{type:"submit",disabled:r,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:r?"Creating account...":"Create account"})})]})]})})},td=()=>{var d;const{user:r,signOut:e,isAdmin:t}=pe(),s=qs(),n=gi(),a=async()=>{try{await e(),s("/login")}catch(u){console.error("Error signing out:",u)}},o=[{id:"calculations",label:"Calculations",icon:we,path:"/dashboard/calculations"},{id:"estimations",label:"Estimations",icon:cr,path:"/dashboard/estimations"},{id:"recommendations",label:"Recommendations",icon:Gt,path:"/dashboard/recommendations"},{id:"history",label:"History",icon:Bc,path:"/dashboard/history"}],l=[{id:"admin",label:"Admin Panel",icon:Kc,path:"/dashboard/admin"}],c=u=>n.pathname===u;return i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50",children:[i.jsx("header",{className:"bg-white shadow-lg sticky top-0 z-50",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4",children:i.jsxs("div",{className:"flex items-center justify-between h-16",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(jt,{className:"h-8 w-8 text-green-500"}),i.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-green-600 to-blue-600 bg-clip-text text-transparent",children:"Energy Audit Pro"})]}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[i.jsx(_n,{className:"h-5 w-5"}),i.jsx("span",{className:"text-sm font-medium",children:((d=r==null?void 0:r.user_metadata)==null?void 0:d.full_name)||(r==null?void 0:r.email)}),t&&i.jsx("span",{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full",children:"Admin"})]}),i.jsxs("button",{onClick:a,className:"flex items-center space-x-2 text-gray-600 hover:text-red-600 transition-colors duration-200",children:[i.jsx(Vc,{className:"h-5 w-5"}),i.jsx("span",{className:"text-sm",children:"Sign Out"})]})]})]})})}),i.jsx("nav",{className:"bg-white shadow-sm border-t border-gray-200",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4",children:i.jsxs("div",{className:"flex space-x-1 overflow-x-auto py-2",children:[o.map(u=>{const h=u.icon;return i.jsxs("button",{onClick:()=>s(u.path),className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all duration-200 whitespace-nowrap ${c(u.path)?"bg-gradient-to-r from-green-500 to-blue-500 text-white shadow-md":"text-gray-600 hover:bg-gray-100 hover:text-gray-800"}`,children:[i.jsx(h,{className:"h-4 w-4"}),i.jsx("span",{className:"font-medium",children:u.label})]},u.id)}),t&&l.map(u=>{const h=u.icon;return i.jsxs("button",{onClick:()=>s(u.path),className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all duration-200 whitespace-nowrap ${c(u.path)?"bg-gradient-to-r from-red-500 to-pink-500 text-white shadow-md":"text-red-600 hover:bg-red-50 hover:text-red-700"}`,children:[i.jsx(h,{className:"h-4 w-4"}),i.jsx("span",{className:"font-medium",children:u.label})]},u.id)})]})})}),i.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:i.jsx(Un,{})}),i.jsx("footer",{className:"bg-gray-800 text-white py-6 mt-12",children:i.jsxs("div",{className:"max-w-7xl mx-auto px-4 text-center",children:[i.jsx("p",{className:"text-gray-300",children:"Energy Audit Pro - Comprehensive energy analysis and recommendations for sustainable living"}),i.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Calculate  Analyze  Optimize  Save Energy"})]})})]})},sd=[{threshold:30,rate:1.9},{threshold:75,rate:3},{threshold:125,rate:4.5},{threshold:225,rate:6},{threshold:400,rate:8.75},{threshold:1/0,rate:9.75}],rd=[{threshold:50,rate:5.4},{threshold:100,rate:7.65},{threshold:300,rate:9.05},{threshold:500,rate:9.6},{threshold:1/0,rate:10.15}],id=75,nd=75,ad=6.7;function Nn(r,e){let t=0,s=0;const n=[];for(let a=0;a<e.length;a++){const{threshold:o,rate:l}=e[a];if(r<=s)break;const c=Math.min(r,o)-s;if(c>0){const d=c*l;t+=d;const u=s+1,h=Math.min(r,o),m=u===h?`${u}`:`${u}-${h}`;n.push({slab:m,units:c,rate:l,amount:d})}s=o}return{bill:t,breakdown:n}}function ci(r,e){const t=r.reduce((c,d)=>c+d.rating*d.quantity*d.hours,0),s=e.reduce((c,d)=>c+d.rating*d.quantity*d.hours,0),a=(t*30+s)/1e3,{bill:o,breakdown:l}=Nn(a,sd);return{totalUnits:a,totalBill:o,breakdown:l}}function di(r,e){const t=e*id,{bill:s,breakdown:n}=Nn(r,rd);return{fixedCharge:t,energyCharge:s,totalBill:t+s,breakdown:n}}function ui(r,e){const t=e*nd,s=r*ad;return{fixedCharge:t,energyCharge:s,totalBill:t+s}}function od(r,e=6.5){if(!(r>4e3))return{recommendSolar:!1,requiredKW:0,estimatedGeneration:0,savings:0,investment:0,paybackPeriod:0};const n=r/e/30,a=Math.max(1,Math.round(n/4)),o=a*4*30,l=o*e*.9,c=a*5e4,d=c/(l*12);return{recommendSolar:!0,requiredKW:a,estimatedGeneration:o,savings:l,investment:c,paybackPeriod:d}}at.register(_t,Nt,xi,kt,ot,lt,yi);const kn=({data:r})=>{const e={labels:r.map(a=>a.slab),datasets:[{label:"Bill Amount ()",data:r.map(a=>a.amount),backgroundColor:["#10B981","#3B82F6","#F59E0B","#EF4444","#8B5CF6","#F97316"],borderColor:["#059669","#2563EB","#D97706","#DC2626","#7C3AED","#EA580C"],borderWidth:2}]},t={labels:r.map(a=>`${a.slab} units`),datasets:[{data:r.map(a=>a.amount),backgroundColor:["#10B981","#3B82F6","#F59E0B","#EF4444","#8B5CF6","#F97316"],borderWidth:2,borderColor:"#fff"}]},s={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:"Bill Breakdown by Tariff Slabs",font:{size:16,weight:"bold"}}},scales:{y:{beginAtZero:!0,ticks:{callback:function(a){return""+a.toLocaleString()}}}}},n={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"},title:{display:!0,text:"Bill Distribution",font:{size:16,weight:"bold"}},tooltip:{callbacks:{label:function(a){const o=a.parsed,l=a.dataset.data.reduce((d,u)=>d+u,0),c=(o/l*100).toFixed(1);return`${a.label}: ${o.toLocaleString()} (${c}%)`}}}}};return i.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[i.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:i.jsx("div",{className:"h-80",children:i.jsx(Ns,{data:e,options:s})})}),i.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:i.jsx("div",{className:"h-80",children:i.jsx(qn,{data:t,options:n})})})]})};at.register(yi,ot,lt);const ld=({dailyAppliances:r,occasionalAppliances:e})=>{const s=[...r.map(l=>({...l,type:"daily"})),...e.map(l=>({...l,type:"occasional"}))].map(l=>({name:l.name||"Unnamed",energy:l.type==="daily"?l.rating*l.quantity*l.hours*30:l.rating*l.quantity*l.hours,type:l.type})).filter(l=>l.energy>0);if(s.length===0)return i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Energy Distribution"}),i.jsx("div",{className:"flex items-center justify-center h-64 text-gray-500",children:"Add appliances to see energy distribution"})]});const n=["#10B981","#3B82F6","#F59E0B","#EF4444","#8B5CF6","#F97316","#06B6D4","#84CC16","#F43F5E","#6366F1","#14B8A6","#F59E0B"],a={labels:s.map(l=>l.name),datasets:[{data:s.map(l=>l.energy),backgroundColor:n.slice(0,s.length),borderColor:n.slice(0,s.length).map(l=>l+"80"),borderWidth:2}]},o={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{maxWidth:150,usePointStyle:!0}},title:{display:!0,text:"Monthly Energy Consumption by Appliance",font:{size:16,weight:"bold"}},tooltip:{callbacks:{label:function(l){const c=l.parsed,d=l.dataset.data.reduce((h,m)=>h+m,0),u=(c/d*100).toFixed(1);return`${l.label}: ${c.toLocaleString()} Wh (${u}%)`}}}}};return i.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:i.jsx("div",{className:"h-96",children:i.jsx(Vn,{data:a,options:o})})})},hi=({appliances:r,type:e,title:t,icon:s,addAppliance:n,removeAppliance:a,updateAppliance:o})=>i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(s,{className:"h-5 w-5 text-green-500"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t})]}),i.jsxs("button",{onClick:()=>n(e),className:"flex items-center space-x-2 bg-gradient-to-r from-green-500 to-blue-500 text-white px-4 py-2 rounded-lg hover:shadow-md transition-all duration-200",children:[i.jsx(zc,{className:"h-4 w-4"}),i.jsx("span",{children:"Add Appliance"})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-50",children:[i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Appliance"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Rating (W)"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Quantity"}),i.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:["Hours (",e==="daily"?"per day":"per month",")"]}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Energy (Wh)"}),i.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-700",children:"Action"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map((l,c)=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-3",children:i.jsx("input",{type:"text",value:l.name,onChange:d=>o(e,c,"name",d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Appliance name"})}),i.jsx("td",{className:"px-4 py-3",children:i.jsx("input",{type:"number",value:l.rating,onChange:d=>o(e,c,"rating",parseFloat(d.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",min:"0"})}),i.jsx("td",{className:"px-4 py-3",children:i.jsx("input",{type:"number",value:l.quantity,onChange:d=>o(e,c,"quantity",parseInt(d.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",min:"1"})}),i.jsx("td",{className:"px-4 py-3",children:i.jsx("input",{type:"number",value:l.hours,onChange:d=>o(e,c,"hours",parseFloat(d.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",min:"0",step:"0.1"})}),i.jsx("td",{className:"px-4 py-3 text-gray-600",children:(l.rating*l.quantity*l.hours).toLocaleString()}),i.jsx("td",{className:"px-4 py-3 text-center",children:i.jsx("button",{onClick:()=>a(e,c),className:"text-red-500 hover:text-red-700 transition-colors duration-200",children:i.jsx(jn,{className:"h-4 w-4"})})})]},c))})]})})]}),fi=()=>{const{user:r}=pe(),[e,t]=O.useState([{name:"LED Light",rating:10,quantity:5,hours:6},{name:"Fan",rating:75,quantity:3,hours:8}]),[s,n]=O.useState([{name:"Washing Machine",rating:500,quantity:1,hours:5}]),[a,o]=O.useState(ci(e,s)),l=h=>{const m={name:"",rating:0,quantity:1,hours:1};h==="daily"?t([...e,m]):n([...s,m])},c=(h,m)=>{if(h==="daily"){const y=e.filter((w,b)=>b!==m);t(y)}else{const y=s.filter((w,b)=>b!==m);n(y)}},d=(h,m,y,w)=>{if(h==="daily"){const b=[...e];b[m]={...b[m],[y]:w},t(b)}else{const b=[...s];b[m]={...b[m],[y]:w},n(b)}};Q.useEffect(()=>{const h=ci(e,s);o(h),r&&(e.length>0||s.length>0)&&u(h)},[e,s]);const u=async h=>{try{await X.from("calculation_history").insert({user_id:r==null?void 0:r.id,calculation_type:"domestic",inputs:{dailyAppliances:e,occasionalAppliances:s},results:h})}catch(m){console.error("Error saving calculation history:",m)}};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-xl p-6",children:[i.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Domestic Energy Calculator"}),i.jsx("p",{className:"text-green-100",children:"Calculate your monthly electricity bill based on your appliances usage"})]}),i.jsx(hi,{appliances:e,type:"daily",title:"Daily Appliances",icon:vn,addAppliance:l,removeAppliance:c,updateAppliance:d}),i.jsx(hi,{appliances:s,type:"occasional",title:"Occasional Appliances",icon:jt,addAppliance:l,removeAppliance:c,updateAppliance:d}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Bill Summary"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Total Monthly Units:"}),i.jsxs("span",{className:"font-semibold",children:[a.totalUnits.toFixed(2)," kWh"]})]}),i.jsxs("div",{className:"flex justify-between text-lg font-bold text-green-600",children:[i.jsx("span",{children:"Total Bill:"}),i.jsxs("span",{children:["",a.totalBill.toFixed(2)]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Tariff Breakdown"}),i.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:a.breakdown.map((h,m)=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsxs("span",{className:"text-gray-600",children:[h.slab," units @ ",h.rate]}),i.jsxs("span",{className:"font-semibold",children:["",h.amount.toFixed(2)]})]},m))})]})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[i.jsx(kn,{data:a.breakdown}),i.jsx(ld,{dailyAppliances:e,occasionalAppliances:s})]})]})},cd=()=>{const{user:r}=pe(),[e,t]=O.useState(100),[s,n]=O.useState(10),[a,o]=O.useState(di(100,10)),l=()=>{const d=di(e,s);o(d),r&&c(d)};Q.useEffect(()=>{l()},[e,s]);const c=async d=>{try{await X.from("calculation_history").insert({user_id:r==null?void 0:r.id,calculation_type:"commercial",inputs:{totalUnits:e,sanctionedLoad:s},results:d})}catch(u){console.error("Error saving calculation history:",u)}};return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl p-6",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(yn,{className:"h-8 w-8"}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Commercial Energy Calculator"}),i.jsx("p",{className:"text-blue-100",children:"Calculate commercial electricity bills with fixed and energy charges"})]})]})}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsxs("h3",{className:"text-lg font-semibold mb-4 text-gray-800 flex items-center",children:[i.jsx(we,{className:"h-5 w-5 mr-2 text-blue-500"}),"Input Parameters"]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total Units Consumed (kWh)"}),i.jsx("input",{type:"number",value:e,onChange:d=>t(parseFloat(d.target.value)||0),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0",step:"0.1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sanctioned Load (kW)"}),i.jsx("input",{type:"number",value:s,onChange:d=>n(parseFloat(d.target.value)||0),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0",step:"0.1"})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Bill Summary"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[i.jsx("span",{className:"text-gray-600",children:"Fixed Charges:"}),i.jsxs("span",{className:"font-semibold text-gray-800",children:["",a.fixedCharge.toFixed(2)]})]}),i.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[i.jsx("span",{className:"text-gray-600",children:"Energy Charges:"}),i.jsxs("span",{className:"font-semibold text-gray-800",children:["",a.energyCharge.toFixed(2)]})]}),i.jsxs("div",{className:"flex justify-between items-center py-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg px-4",children:[i.jsx("span",{className:"text-lg font-bold text-gray-800",children:"Total Bill:"}),i.jsxs("span",{className:"text-xl font-bold text-blue-600",children:["",a.totalBill.toFixed(2)]})]})]})]})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Energy Charge Breakdown"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-blue-50",children:[i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Unit Breakdown"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Slab Rate (/unit)"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Difference in Units"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Calculated Price ()"})]})}),i.jsxs("tbody",{className:"divide-y divide-gray-200",children:[a.breakdown.map((d,u)=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-3 text-sm text-gray-800 font-medium",children:d.slab}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:d.rate.toFixed(2)}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:d.units.toFixed(2)}),i.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-gray-800",children:["",d.amount.toFixed(2)]})]},u)),i.jsxs("tr",{className:"bg-gray-50 font-semibold",children:[i.jsx("td",{className:"px-4 py-3 text-sm text-gray-800",children:"Total"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:""}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.toFixed(2)}),i.jsxs("td",{className:"px-4 py-3 text-sm text-gray-800",children:["",a.energyCharge.toFixed(2)]})]})]})]})})]}),i.jsx(kn,{data:a.breakdown})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Commercial Tariff Structure"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-blue-50",children:[i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Units Range"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Fixed Charge (/kW/Month)"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Energy Charge (/kWh)"})]})}),i.jsxs("tbody",{className:"divide-y divide-gray-200",children:[i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-2",children:"0-50"}),i.jsx("td",{className:"px-4 py-2",children:"75"}),i.jsx("td",{className:"px-4 py-2",children:"5.40"})]}),i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-2",children:"51-100"}),i.jsx("td",{className:"px-4 py-2",children:"75"}),i.jsx("td",{className:"px-4 py-2",children:"7.65"})]}),i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-2",children:"101-300"}),i.jsx("td",{className:"px-4 py-2",children:"75"}),i.jsx("td",{className:"px-4 py-2",children:"9.05"})]}),i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-2",children:"301-500"}),i.jsx("td",{className:"px-4 py-2",children:"75"}),i.jsx("td",{className:"px-4 py-2",children:"9.60"})]}),i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-2",children:"500"}),i.jsx("td",{className:"px-4 py-2",children:"75"}),i.jsx("td",{className:"px-4 py-2",children:"10.15"})]})]})]})})]})]})},dd=()=>{const{user:r}=pe(),[e,t]=O.useState(1e3),[s,n]=O.useState(50),[a,o]=O.useState(ui(1e3,50));Q.useEffect(()=>{const c=ui(e,s);o(c),r&&l(c)},[e,s]);const l=async c=>{try{await X.from("calculation_history").insert({user_id:r==null?void 0:r.id,calculation_type:"industrial",inputs:{totalUnits:e,sanctionedLoad:s},results:c})}catch(d){console.error("Error saving calculation history:",d)}};return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-xl p-6",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(bn,{className:"h-8 w-8"}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Industrial Energy Calculator"}),i.jsx("p",{className:"text-orange-100",children:"Calculate industrial electricity bills with fixed and energy charges"})]})]})}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsxs("h3",{className:"text-lg font-semibold mb-4 text-gray-800 flex items-center",children:[i.jsx(Bs,{className:"h-5 w-5 mr-2 text-orange-500"}),"Input Parameters"]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total Units Consumed (kWh)"}),i.jsx("input",{type:"number",value:e,onChange:c=>t(parseFloat(c.target.value)||0),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent",min:"0",step:"0.1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sanctioned Load (kW)"}),i.jsx("input",{type:"number",value:s,onChange:c=>n(parseFloat(c.target.value)||0),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent",min:"0",step:"0.1"})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Bill Summary"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[i.jsx("span",{className:"text-gray-600",children:"Fixed Charges:"}),i.jsxs("span",{className:"font-semibold text-gray-800",children:["",a.fixedCharge.toFixed(2)]})]}),i.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[i.jsx("span",{className:"text-gray-600",children:"Energy Charges:"}),i.jsxs("span",{className:"font-semibold text-gray-800",children:["",a.energyCharge.toFixed(2)]})]}),i.jsxs("div",{className:"flex justify-between items-center py-3 bg-gradient-to-r from-orange-50 to-red-50 rounded-lg px-4",children:[i.jsx("span",{className:"text-lg font-bold text-gray-800",children:"Total Bill:"}),i.jsxs("span",{className:"text-xl font-bold text-orange-600",children:["",a.totalBill.toFixed(2)]})]})]})]})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Calculation Details"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Fixed Charges Calculation"}),i.jsxs("div",{className:"font-mono text-sm",children:[s," kW  75/kW = ",a.fixedCharge.toFixed(2)]})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Energy Charges Calculation"}),i.jsxs("div",{className:"font-mono text-sm",children:[e," kWh  6.70/kWh = ",a.energyCharge.toFixed(2)]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Industrial Tariff Structure"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[i.jsx("div",{className:"font-semibold text-orange-800",children:"Fixed Charges"}),i.jsx("div",{className:"text-orange-700",children:"75 per kW per month"})]}),i.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[i.jsx("div",{className:"font-semibold text-red-800",children:"Energy Charges"}),i.jsx("div",{className:"text-red-700",children:"6.70 per kWh"})]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Bill Composition"}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-orange-100 to-orange-200 rounded-lg",children:[i.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[(a.fixedCharge/a.totalBill*100).toFixed(1),"%"]}),i.jsx("div",{className:"text-orange-800",children:"Fixed Charges"})]}),i.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-red-100 to-red-200 rounded-lg",children:[i.jsxs("div",{className:"text-2xl font-bold text-red-600",children:[(a.energyCharge/a.totalBill*100).toFixed(1),"%"]}),i.jsx("div",{className:"text-red-800",children:"Energy Charges"})]})]})]})]})},ud=()=>{var n;const[r,e]=O.useState("domestic"),t=[{id:"domestic",label:"Domestic",icon:vn,component:fi},{id:"commercial",label:"Commercial",icon:yn,component:cd},{id:"industrial",label:"Industrial",icon:bn,component:dd}],s=((n=t.find(a=>a.id===r))==null?void 0:n.component)||fi;return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex flex-wrap gap-2",children:t.map(a=>{const o=a.icon;return i.jsxs("button",{onClick:()=>e(a.id),className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all duration-200 ${r===a.id?"bg-gradient-to-r from-green-500 to-blue-500 text-white shadow-md":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-200"}`,children:[i.jsx(o,{className:"h-4 w-4"}),i.jsx("span",{className:"font-medium",children:a.label})]},a.id)})}),i.jsx(s,{})]})};at.register(_t,Nt,Vs,Ws,kt,ot,lt);const hd=({initialInvestment:r,monthlySavings:e,paybackPeriod:t})=>{const s=Math.ceil(t)+2,n=Array.from({length:s*12},(d,u)=>u+1),a=n.map(d=>e*d),o=a.map(d=>d-r),l={labels:n.map(d=>`${Math.floor((d-1)/12)}Y ${(d-1)%12}M`),datasets:[{label:"Cumulative Savings ()",data:a,borderColor:"#10B981",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.1,fill:!1},{label:"Initial Investment ()",data:n.map(()=>r),borderColor:"#EF4444",backgroundColor:"rgba(239, 68, 68, 0.1)",borderDash:[5,5],tension:0,fill:!1},{label:"Net Value ()",data:o,borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.1,fill:"origin"}]},c={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:`Payback Analysis - Break-even at ${t.toFixed(1)} years`,font:{size:16,weight:"bold"}},tooltip:{callbacks:{label:function(d){return`${d.dataset.label}: ${d.parsed.y.toLocaleString()}`}}}},scales:{x:{title:{display:!0,text:"Time Period"},ticks:{maxTicksLimit:12}},y:{title:{display:!0,text:"Amount ()"},ticks:{callback:function(d){return""+d.toLocaleString()}}}},interaction:{intersect:!1}};return i.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:i.jsx("div",{className:"h-96",children:i.jsx(zs,{data:l,options:c})})})};at.register(_t,Nt,Vs,Ws,kt,ot,lt);const fd=({fixedCosts:r,variableCostPerUnit:e,pricePerUnit:t,breakEvenUnits:s})=>{const n=Math.max(s*1.5,1e3),a=Array.from({length:20},(u,h)=>h*n/19),o=a.map(u=>r+e*u),l=a.map(u=>t*u),c={labels:a.map(u=>Math.round(u).toLocaleString()),datasets:[{label:"Total Revenue",data:l,borderColor:"#10B981",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.1},{label:"Total Costs",data:o,borderColor:"#EF4444",backgroundColor:"rgba(239, 68, 68, 0.1)",tension:.1},{label:"Fixed Costs",data:a.map(()=>r),borderColor:"#F59E0B",backgroundColor:"rgba(245, 158, 11, 0.1)",borderDash:[5,5],tension:0}]},d={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:`Break-even Analysis - Break-even at ${Math.ceil(s).toLocaleString()} units`,font:{size:16,weight:"bold"}},tooltip:{callbacks:{label:function(u){return`${u.dataset.label}: ${u.parsed.y.toLocaleString()}`}}}},scales:{x:{title:{display:!0,text:"Units Sold"}},y:{title:{display:!0,text:"Amount ()"},ticks:{callback:function(u){return""+u.toLocaleString()}}}},interaction:{intersect:!1}};return i.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:i.jsx("div",{className:"h-96",children:i.jsx(zs,{data:c,options:d})})})};at.register(_t,Nt,xi,kt,ot,lt);const md=({initialInvestment:r,annualSavings:e,projectLifetime:t,discountRate:s})=>{const n=Array.from({length:t+1},(h,m)=>m),a=n.map(h=>h===0?-r:e/Math.pow(1+s,h)),o=n.map((h,m)=>a.slice(0,m+1).reduce((y,w)=>y+w,0)),l={labels:n.map(h=>`Year ${h}`),datasets:[{label:"Annual Cash Flow (Present Value)",data:a,backgroundColor:a.map(h=>h>=0?"#10B981":"#EF4444"),borderColor:a.map(h=>h>=0?"#059669":"#DC2626"),borderWidth:2}]},c={labels:n.map(h=>`Year ${h}`),datasets:[{label:"Cumulative NPV",data:o,backgroundColor:o.map(h=>h>=0?"#3B82F6":"#F59E0B"),borderColor:o.map(h=>h>=0?"#2563EB":"#D97706"),borderWidth:2}]},d={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:"Annual Cash Flows (Present Value)",font:{size:14,weight:"bold"}},tooltip:{callbacks:{label:function(h){return`${h.dataset.label}: ${h.parsed.y.toLocaleString()}`}}}},scales:{y:{beginAtZero:!1,ticks:{callback:function(h){return""+h.toLocaleString()}}}}},u={...d,plugins:{...d.plugins,title:{...d.plugins.title,text:"Cumulative Net Present Value"}}};return i.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[i.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:i.jsx("div",{className:"h-80",children:i.jsx(Ns,{data:l,options:d})})}),i.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:i.jsx("div",{className:"h-80",children:i.jsx(Ns,{data:c,options:u})})})]})},gd=()=>{const{user:r}=pe(),[e,t]=O.useState(5e5),[s,n]=O.useState(96e3),[a,o]=O.useState(8e3),[l,c]=O.useState(10),[d,u]=O.useState(8),h=O.useMemo(()=>{if(e>0&&s>0){const j=e/s,x=s*25,v=j,C=s/e*100,A=(x-e)/e*100,$=x-e;return{paybackPeriod:j,totalSavings25Years:x,breakEvenYear:v,annualROI:C,cumulativeROI25Years:A,netProfit25Years:$}}return{paybackPeriod:0,totalSavings25Years:0,breakEvenYear:0,annualROI:0,cumulativeROI25Years:0,netProfit25Years:0}},[e,s]);O.useEffect(()=>{if(!r||e<=0||s<=0)return;const j=setTimeout(()=>{N({installationCost:e,annualSaving:s,projectLifetime:l,discountRate:d},h)},800);return()=>clearTimeout(j)},[r,e,s,l,d,h]),O.useEffect(()=>{o(s/12)},[s]);const m=j=>`${j.toLocaleString("en-IN")}`,y=j=>`${j.toFixed(2)}%`,w=j=>j<1?`${(j*12).toFixed(1)} months`:`${j.toFixed(1)} years`,b=O.useMemo(()=>{const j=[];for(let x=1;x<=25;x++){const v=s*x,C=v-e,A=(v-e)/e*100;j.push({year:x,cumulativeSavings:v,netPosition:C,roi:A,isBreakEven:x>=h.breakEvenYear})}return j},[s,e,h.breakEvenYear]),N=async(j,x)=>{try{await X.from("estimation_history").insert({user_id:r==null?void 0:r.id,estimation_type:"unified",inputs:j,results:x})}catch(v){console.error("Error saving estimation history:",v)}};return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl p-6",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(cr,{className:"h-8 w-8"}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Unified Solar Investment Estimator"}),i.jsx("p",{className:"text-blue-100",children:"Comprehensive analysis with all financial metrics and visualizations"})]})]})}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsxs("h3",{className:"text-lg font-semibold mb-4 text-gray-800 flex items-center",children:[i.jsx(Mc,{className:"h-5 w-5 mr-2 text-green-500"}),"Investment Parameters"]}),i.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Installation Cost ()"}),i.jsx("input",{type:"number",value:e,onChange:j=>t(parseFloat(j.target.value)||0),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0",placeholder:"Enter installation cost"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Annual Saving ()"}),i.jsx("input",{type:"number",value:s,onChange:j=>n(parseFloat(j.target.value)||0),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0",placeholder:"Enter annual savings"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Lifetime (years)"}),i.jsx("input",{type:"number",value:l,onChange:j=>c(parseInt(j.target.value)||0),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"1",placeholder:"Project lifetime"})]})]}),i.jsxs("div",{className:"mt-6",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Discount Rate (%)"}),i.jsx("input",{type:"number",value:d,onChange:j=>u(parseFloat(j.target.value)||0),className:"w-full md:w-1/3 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0",max:"20",step:"0.1",placeholder:"Discount rate"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-blue-500",children:[i.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[i.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:i.jsx(Uc,{className:"h-6 w-6 text-blue-600"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Payback Period"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:w(h.paybackPeriod)}),i.jsx("div",{className:"text-sm text-gray-600 mb-3",children:"Time to recover investment"}),i.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:i.jsxs("div",{className:"text-sm text-blue-700",children:[i.jsxs("div",{children:["Monthly: ",m(s/12)]}),i.jsxs("div",{children:["Annual: ",m(s)]})]})})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-green-500",children:[i.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[i.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:i.jsx(Lc,{className:"h-6 w-6 text-green-600"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Cost Benefit"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:m(h.totalSavings25Years)}),i.jsx("div",{className:"text-sm text-gray-600 mb-3",children:"Total savings over 25 years"}),i.jsx("div",{className:"bg-green-50 p-3 rounded-lg",children:i.jsxs("div",{className:"text-sm text-green-700",children:[i.jsxs("div",{children:["Net Profit: ",m(h.netProfit25Years)]}),i.jsxs("div",{children:["Benefit Ratio: ",(h.totalSavings25Years/e).toFixed(2),":1"]})]})})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-orange-500",children:[i.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[i.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:i.jsx(Gc,{className:"h-6 w-6 text-orange-600"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Break-even"})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"text-3xl font-bold text-orange-600 mb-2",children:["Year ",h.breakEvenYear.toFixed(1)]}),i.jsx("div",{className:"text-sm text-gray-600 mb-3",children:"When savings = investment"}),i.jsx("div",{className:"bg-orange-50 p-3 rounded-lg",children:i.jsxs("div",{className:"text-sm text-orange-700",children:[i.jsxs("div",{children:["Break-even: ",w(h.breakEvenYear)]}),i.jsxs("div",{children:["After: ",m(e)]})]})})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-purple-500",children:[i.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[i.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:i.jsx(Wc,{className:"h-6 w-6 text-purple-600"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Return on Investment"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:y(h.annualROI)}),i.jsx("div",{className:"text-sm text-gray-600 mb-3",children:"Annual return rate"}),i.jsx("div",{className:"bg-purple-50 p-3 rounded-lg",children:i.jsxs("div",{className:"text-sm text-purple-700",children:[i.jsxs("div",{children:["25-year ROI: ",y(h.cumulativeROI25Years)]}),i.jsxs("div",{children:["Net Profit: ",m(h.netProfit25Years)]})]})})]})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Payback Period Analysis"}),i.jsx("div",{className:"h-96",children:i.jsx(hd,{initialInvestment:e,monthlySavings:a,paybackPeriod:h.paybackPeriod})})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Solar Investment Break-even Analysis"}),i.jsx("div",{className:"h-96",children:i.jsx(fd,{fixedCosts:e,variableCostPerUnit:0,pricePerUnit:s,breakEvenUnits:h.breakEvenYear})})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Net Present Value Analysis"}),i.jsx("div",{className:"h-96",children:i.jsx(md,{initialInvestment:e,annualSavings:s,projectLifetime:l,discountRate:d/100})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Payback & Break-even Timeline"}),i.jsxs("div",{className:"h-64 bg-gray-50 rounded-lg p-4",children:[i.jsx("div",{className:"flex items-end justify-between h-full space-x-1",children:b.slice(0,10).map(j=>i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:`w-8 rounded-t-sm transition-all duration-300 ${j.isBreakEven?"bg-green-500":"bg-blue-500"}`,style:{height:`${Math.min(j.cumulativeSavings/(e*2)*200,200)}px`}}),i.jsx("div",{className:"text-xs text-gray-600 mt-1",children:j.year})]},j.year))}),i.jsxs("div",{className:"relative mt-4",children:[i.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-red-500 border-dashed border-red-500"}),i.jsxs("div",{className:"text-xs text-red-600 mt-1",children:["Installation Cost: ",m(e)]})]}),i.jsx("div",{className:"text-center mt-4",children:i.jsxs("div",{className:"text-sm text-gray-600",children:["Break-even at Year ",h.breakEvenYear.toFixed(1)," (",w(h.breakEvenYear),")"]})})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"ROI Growth Over Time"}),i.jsxs("div",{className:"h-64 bg-gray-50 rounded-lg p-4",children:[i.jsx("div",{className:"flex items-end justify-between h-full space-x-1",children:b.slice(0,10).map(j=>i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"w-8 bg-purple-500 rounded-t-sm transition-all duration-300",style:{height:`${Math.min(j.roi/100*200,200)}px`}}),i.jsx("div",{className:"text-xs text-gray-600 mt-1",children:j.year})]},j.year))}),i.jsx("div",{className:"text-center mt-4",children:i.jsxs("div",{className:"text-sm text-gray-600",children:["ROI reaches ",y(h.cumulativeROI25Years)," after 25 years"]})})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Cost Benefit Growth (25 Years)"}),i.jsxs("div",{className:"h-80 bg-gray-50 rounded-lg p-4",children:[i.jsx("div",{className:"flex items-end justify-between h-full space-x-1",children:b.map(j=>i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:`w-3 rounded-t-sm transition-all duration-300 ${j.isBreakEven?"bg-green-500":"bg-blue-500"}`,style:{height:`${Math.min(j.cumulativeSavings/(s*25)*300,300)}px`}}),j.year%5===0&&i.jsx("div",{className:"text-xs text-gray-600 mt-1",children:j.year})]},j.year))}),i.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4 text-center",children:[i.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[i.jsx("div",{className:"text-sm font-semibold text-blue-600",children:"Total Investment"}),i.jsx("div",{className:"text-lg font-bold text-blue-700",children:m(e)})]}),i.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[i.jsx("div",{className:"text-sm font-semibold text-green-600",children:"25-Year Savings"}),i.jsx("div",{className:"text-lg font-bold text-green-700",children:m(h.totalSavings25Years)})]}),i.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[i.jsx("div",{className:"text-sm font-semibold text-purple-600",children:"Net Profit"}),i.jsx("div",{className:"text-lg font-bold text-purple-700",children:m(h.netProfit25Years)})]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Investment Timeline Analysis"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b border-gray-200",children:[i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Year"}),i.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-700",children:"Annual Savings"}),i.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-700",children:"Cumulative Savings"}),i.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-700",children:"Net Position"}),i.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-700",children:"ROI"})]})}),i.jsx("tbody",{children:[1,2,3,4,5,10,15,20,25].map(j=>{const x=s,v=x*j,C=v-e,A=j>=h.breakEvenYear,$=(v-e)/e*100;return i.jsxs("tr",{className:`border-b border-gray-100 ${A?"bg-green-50":""}`,children:[i.jsxs("td",{className:"py-3 px-4 font-medium",children:["Year ",j,A&&j===Math.ceil(h.breakEvenYear)&&i.jsx("span",{className:"ml-2 text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full",children:"Break-even"})]}),i.jsx("td",{className:"py-3 px-4 text-right",children:m(x)}),i.jsx("td",{className:"py-3 px-4 text-right",children:m(v)}),i.jsx("td",{className:`py-3 px-4 text-right font-semibold ${C>=0?"text-green-600":"text-red-600"}`,children:m(C)}),i.jsx("td",{className:`py-3 px-4 text-right ${$>=0?"text-green-600":"text-red-600"}`,children:y($)})]},j)})})]})})]}),i.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Key Investment Insights"}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),i.jsxs("span",{className:"text-sm text-gray-700",children:[i.jsx("strong",{children:"Payback Period:"})," Your investment will be recovered in ",w(h.paybackPeriod)]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),i.jsxs("span",{className:"text-sm text-gray-700",children:[i.jsx("strong",{children:"25-Year Benefit:"})," Total savings of ",m(h.totalSavings25Years)," over system lifetime"]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),i.jsxs("span",{className:"text-sm text-gray-700",children:[i.jsx("strong",{children:"Break-even Point:"})," You'll start profiting from year ",h.breakEvenYear.toFixed(1)]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),i.jsxs("span",{className:"text-sm text-gray-700",children:[i.jsx("strong",{children:"Annual ROI:"})," ",y(h.annualROI)," return on your investment"]})]})]})]})]})]})},pd=()=>i.jsx("div",{className:"space-y-6",children:i.jsx(gd,{})}),mi=()=>{const r=[{category:"Lighting System",icon:Gt,color:"yellow",tips:["One of the best energy-saving devices is the light switch. Turn off lights when not required.","Use automatic devices like infrared sensors, motion sensors, timers, dimmers and solar cells to control lighting.","Use task lighting to focus light only where needed instead of lighting entire rooms.","Dirty tube lights and bulbs can absorb up to 50% of light; dust them regularly.","Fluorescent tubes and CFLs are up to 5x more efficient than ordinary bulbs and can save ~70% electricity.","Incandescent bulbs convert ~90% of energy to heat, not light; avoid them.","Replace incandescent bulbs with CFLs/LEDs; CFLs can use up to 75% less electricity.","A 15W CFL can produce the same light as a 60W incandescent bulb."]},{category:"Room Air Conditioners",icon:Jc,color:"red",tips:["Use ceiling or table fans first; they cost far less to operate than ACs.","Reduce AC use up to 40% by shading windows and walls; plant trees and shrubs.","Set AC thermostat to 25C; each degree above 22C can save ~35% energy.","Use ceiling or room fans with AC to feel cooler at higher set points.","Cool and dehumidify rooms with timers; a good AC needs ~30 minutes.","Keep doors to air-conditioned rooms closed as often as possible.","Clean AC filters monthly to maintain airflow and efficiency.","Consider replacing old, inefficient ACs; newer models are more efficient over lifecycle."]},{category:"Refrigerators",icon:jt,color:"blue",tips:["Keep refrigerators away from heat sources like sunlight, ovens, and ranges; check door seals with a flashlight test.","Ensure space around the fridge for airflow; trapped heat increases energy use.","Allow adequate air circulation inside; avoid overpacking.","Plan before opening the door to minimize open time.","Cool and cover hot foods before storing to reduce energy use and condensation.","Keep rubber door seals clean and tight; replace if they fail the paper test.","Clean condenser coils regularly to help the motor run efficiently.","Defrost manual units regularly; ice build-up insulates and reduces cooling power."]},{category:"Water Heater",icon:lr,color:"orange",tips:["Insulate hot water pipes, especially in unheated areas (never insulate plastic pipes).","Reduce thermostat from 60C to 50C to save over 18% energy."]},{category:"Microwave Ovens & Electric Kettles",icon:jt,color:"blue",tips:["Microwaves can cut cooking energy by up to 50% versus conventional ovens for small quantities.","Place larger/thicker items on the outer edge for even microwave cooking.","Use electric kettles for heating water; they are more efficient than cooktops.","Choose kettles with auto shut-off and heat-resistant handles.","Clean kettles regularly with boiling water and vinegar to remove deposits.","Dont overfill kettles; heat only the amount of water needed."]},{category:"Computers",icon:Yc,color:"green",tips:["Turn off home office equipment when not in use; always-on devices can use significant power.","If leaving computers on, at least turn off the monitor; it uses over half the systems energy.","Enable sleep-mode on computers/monitors/copiers to cut energy by ~40%.","Unplug battery chargers when not charging; they draw power continuously.","Screen savers do not save energy; shutting down reduces wear and saves power."]}],e=s=>({yellow:"bg-yellow-50 border-yellow-200 text-yellow-800",blue:"bg-blue-50 border-blue-200 text-blue-800",red:"bg-red-50 border-red-200 text-red-800",green:"bg-green-50 border-green-200 text-green-800",orange:"bg-orange-50 border-orange-200 text-orange-800"})[s]||"bg-gray-50 border-gray-200 text-gray-800",t=s=>({yellow:"text-yellow-600",blue:"text-blue-600",red:"text-red-600",green:"text-green-600",orange:"text-orange-600"})[s]||"text-gray-600";return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-xl p-6",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(Gt,{className:"h-8 w-8"}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Recommendations"}),i.jsx("p",{className:"text-green-100",children:"Expert recommendations to reduce your energy consumption and bills"})]})]})}),i.jsx("div",{className:"grid gap-6",children:r.map((s,n)=>{const a=s.icon;return i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[i.jsx("div",{className:`p-3 rounded-lg ${e(s.color)}`,children:i.jsx(a,{className:`h-6 w-6 ${t(s.color)}`})}),i.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:s.category})]}),i.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:s.tips.map((o,l)=>i.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[i.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mt-2 flex-shrink-0"}),i.jsx("p",{className:"text-gray-700 text-sm",children:o})]},l))})]},n)})}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-800",children:"Top Actionable Energy-Saving Wins"}),i.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:"1"}),i.jsx("div",{className:"text-lg font-semibold text-gray-800",children:"Set AC to 25C & Clean Filters"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Each degree above 22C saves ~35%. Clean filters monthly for efficiency."})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"2"}),i.jsx("div",{className:"text-lg font-semibold text-gray-800",children:"Switch to LEDs & Use Sensors"}),i.jsx("p",{className:"text-sm text-gray-600",children:"LEDs/CFLs cut lighting energy up to 70%. Add motion/timer controls."})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:"3"}),i.jsx("div",{className:"text-lg font-semibold text-gray-800",children:"Maintain Refrigerator Seals & Coils"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Tight door seals and clean condenser coils reduce runtime and power use."})]})]})]}),i.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 rounded-xl p-6 border border-blue-200",children:[i.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:"Recommendations"}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-3 text-sm",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",className:"rounded"}),i.jsx("span",{children:"Switch to LED lighting"})]}),i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",className:"rounded"}),i.jsx("span",{children:"Set AC to 24C or higher"})]}),i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",className:"rounded"}),i.jsx("span",{children:"Unplug unused electronics"})]}),i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",className:"rounded"}),i.jsx("span",{children:"Use ceiling fans with AC"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",className:"rounded"}),i.jsx("span",{children:"Install window films"})]}),i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",className:"rounded"}),i.jsx("span",{children:"Regular AC maintenance"})]}),i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",className:"rounded"}),i.jsx("span",{children:"Use timers for water heaters"})]}),i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",className:"rounded"}),i.jsx("span",{children:"Consider solar water heating"})]})]})]})]})]})};at.register(_t,Nt,Vs,Ws,kt,ot,lt);const xd=({recommendation:r,monthlyBill:e})=>{const s=Array.from({length:25},(c,d)=>`Year ${d+1}`),n=s.map((c,d)=>r.savings*12*(d+1)),a=n.map(c=>c-r.investment),o={labels:s,datasets:[{label:"Cumulative Savings",data:n,borderColor:"#10B981",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.1,fill:!1},{label:"Initial Investment",data:s.map(()=>r.investment),borderColor:"#EF4444",backgroundColor:"rgba(239, 68, 68, 0.1)",borderDash:[5,5],tension:0,fill:!1},{label:"Net Profit",data:a,borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.1,fill:"origin"}]},l={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:"25-Year Solar Investment Analysis",font:{size:16,weight:"bold"}},tooltip:{callbacks:{label:function(c){return`${c.dataset.label}: ${c.parsed.y.toLocaleString()}`}}}},scales:{x:{title:{display:!0,text:"Time Period"},ticks:{maxTicksLimit:10}},y:{title:{display:!0,text:"Amount ()"},ticks:{callback:function(c){return""+c.toLocaleString()}}}}};return i.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:i.jsx("div",{className:"h-96",children:i.jsx(zs,{data:o,options:l})})})},yd=()=>{const{user:r}=pe(),[e,t]=O.useState(6e3),s=6.5,n=O.useMemo(()=>od(e,s),[e]),a=e>0?e/s:0,o=a/30;O.useEffect(()=>{if(r&&e>0){const c=setTimeout(()=>{l({monthlyBill:e,rate:s},n)},800);return()=>clearTimeout(c)}},[r,e,n]);const l=async(c,d)=>{try{await X.from("recommendation_history").insert({user_id:r==null?void 0:r.id,recommendation_type:"solar",inputs:c,results:d})}catch(u){console.error("Error saving recommendation history:",u)}};return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-xl p-6",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(lr,{className:"h-8 w-8"}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Personalized Solar Recommendations"}),i.jsx("p",{className:"text-yellow-100",children:"Get customized solar solutions based on your electricity bill"})]})]})}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsxs("h3",{className:"text-lg font-semibold mb-4 text-gray-800 flex items-center",children:[i.jsx(we,{className:"h-5 w-5 mr-2 text-yellow-500"}),"Your Electricity Details"]}),i.jsx("div",{className:"space-y-4",children:i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Monthly Electricity Bill ()"}),i.jsx("input",{type:"number",value:e,onChange:c=>t(parseFloat(c.target.value)||0),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent",min:"0",placeholder:"Enter your monthly bill amount"})]})})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Recommendation Status"}),i.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Estimated Monthly Units:"}),i.jsxs("span",{className:"font-semibold text-gray-800",children:[a.toFixed(1)," kWh"]})]}),i.jsxs("div",{className:"flex justify-between text-sm mt-1",children:[i.jsx("span",{className:"text-gray-600",children:"Estimated Daily Units:"}),i.jsxs("span",{className:"font-semibold text-gray-800",children:[o.toFixed(1)," kWh/day"]})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Using default rate of ",s,"/kWh"]})]}),n.recommendSolar?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center p-4 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-orange-600 mb-1",children:" Solar Recommended"}),i.jsx("div",{className:"text-orange-700",children:"Perfect candidate for solar installation"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{className:"bg-green-50 p-3 rounded-lg text-center",children:[i.jsxs("div",{className:"text-lg font-bold text-green-600",children:[n.requiredKW," kW"]}),i.jsx("div",{className:"text-xs text-green-700",children:"System Size"})]}),i.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:[i.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[n.paybackPeriod.toFixed(1)," years"]}),i.jsx("div",{className:"text-xs text-blue-700",children:"Payback Period"})]})]})]}):i.jsxs("div",{className:"text-center p-6 bg-blue-50 rounded-lg",children:[i.jsx("div",{className:"text-lg font-semibold text-blue-800 mb-2",children:"Solar Not Recommended"}),i.jsxs("div",{className:"text-blue-700",children:["Your monthly bill is ",e.toLocaleString(),". Solar is typically cost-effective for bills above 4,000/month."]})]})]})]}),n.recommendSolar&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[i.jsx(jt,{className:"h-5 w-5 text-yellow-500"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"System Specifications"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Required Capacity:"}),i.jsxs("span",{className:"font-semibold",children:[n.requiredKW," kW"]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monthly Generation:"}),i.jsxs("span",{className:"font-semibold",children:[n.estimatedGeneration.toFixed(0)," kWh"]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"System Type:"}),i.jsx("span",{className:"font-semibold",children:"Grid-tied"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Panel Type:"}),i.jsx("span",{className:"font-semibold",children:"Monocrystalline"})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[i.jsx(cr,{className:"h-5 w-5 text-green-500"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Financial Benefits"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Investment Cost:"}),i.jsxs("span",{className:"font-semibold",children:["",n.investment.toLocaleString()]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monthly Savings:"}),i.jsxs("span",{className:"font-semibold text-green-600",children:["",n.savings.toFixed(0)]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Annual Savings:"}),i.jsxs("span",{className:"font-semibold text-green-600",children:["",(n.savings*12).toLocaleString()]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"25-year Savings:"}),i.jsxs("span",{className:"font-semibold text-green-600",children:["",(n.savings*12*25).toLocaleString()]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:"Environmental Impact"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[i.jsx("div",{className:"text-sm text-green-600",children:"CO2 Reduction/Year"}),i.jsxs("div",{className:"font-bold text-green-800",children:[(n.estimatedGeneration*12*.82).toFixed(0)," kg"]})]}),i.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[i.jsx("div",{className:"text-sm text-blue-600",children:"Trees Equivalent"}),i.jsxs("div",{className:"font-bold text-blue-800",children:[Math.round(n.estimatedGeneration*12*.82/22)," trees"]})]}),i.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[i.jsx("div",{className:"text-sm text-purple-600",children:"Coal Offset/Year"}),i.jsxs("div",{className:"font-bold text-purple-800",children:[(n.estimatedGeneration*12*.4).toFixed(0)," kg"]})]})]})]})]}),i.jsx(xd,{recommendation:n,monthlyBill:e}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Installation Guidelines"}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Site Requirements"}),i.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[i.jsx("li",{children:" South-facing roof with minimal shading"}),i.jsxs("li",{children:[" Roof area: ",(n.requiredKW*80).toFixed(0)," sq ft minimum"]}),i.jsx("li",{children:" Roof age: Less than 10 years preferred"}),i.jsx("li",{children:" Structural capacity: 15-20 kg/sq meter"}),i.jsx("li",{children:" Clear access for maintenance"})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Next Steps"}),i.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[i.jsx("li",{children:" Get professional site assessment"}),i.jsx("li",{children:" Obtain multiple quotes from certified installers"}),i.jsx("li",{children:" Check for government subsidies and net metering"}),i.jsx("li",{children:" Ensure proper permits and approvals"}),i.jsx("li",{children:" Plan for system monitoring and maintenance"})]})]})]})]}),i.jsxs("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 rounded-xl p-6 border border-yellow-200",children:[i.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:"Government Incentives"}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-orange-800",children:"Central Government Subsidy"}),i.jsx("div",{className:"text-sm text-orange-700",children:"Up to 40% subsidy for residential systems up to 3kW"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-yellow-800",children:"Net Metering Benefits"}),i.jsx("div",{className:"text-sm text-yellow-700",children:"Sell excess power back to the grid at attractive rates"})]})]})]})]})]})},bd=()=>{var n;const[r,e]=O.useState("general"),t=[{id:"general",label:"General Tips",icon:Gt,component:mi},{id:"solar",label:"Solar Analysis",icon:lr,component:yd}],s=((n=t.find(a=>a.id===r))==null?void 0:n.component)||mi;return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex gap-2",children:t.map(a=>{const o=a.icon;return i.jsxs("button",{onClick:()=>e(a.id),className:`flex items-center space-x-2 px-6 py-3 rounded-lg transition-all duration-200 ${r===a.id?"bg-gradient-to-r from-yellow-500 to-orange-500 text-white shadow-md":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-200"}`,children:[i.jsx(o,{className:"h-5 w-5"}),i.jsx("span",{className:"font-medium",children:a.label})]},a.id)})}),i.jsx(s,{})]})},vd=()=>{const{user:r}=pe(),[e,t]=O.useState("calculations"),[s,n]=O.useState([]),[a,o]=O.useState([]),[l,c]=O.useState([]),[d,u]=O.useState(!0),[h,m]=O.useState(null);O.useEffect(()=>{r&&(y(),w(),b())},[r]);const y=async()=>{try{const{data:x,error:v}=await X.from("calculation_history").select("*").eq("user_id",r==null?void 0:r.id).order("created_at",{ascending:!1});if(v)throw v;n(x||[])}catch(x){console.error("Error fetching calculation history:",x)}finally{u(!1)}},w=async()=>{try{const{data:x,error:v}=await X.from("estimation_history").select("*").eq("user_id",r==null?void 0:r.id).order("created_at",{ascending:!1});if(v)throw v;o(x||[])}catch(x){console.error("Error fetching estimation history:",x)}},b=async()=>{try{const{data:x,error:v}=await X.from("recommendation_history").select("*").eq("user_id",r==null?void 0:r.id).order("created_at",{ascending:!1});if(v)throw v;c(x||[])}catch(x){console.error("Error fetching recommendation history:",x)}},N=async x=>{try{const{error:v}=await X.from("calculation_history").delete().eq("id",x);if(v)throw v;n(s.filter(C=>C.id!==x))}catch(v){console.error("Error deleting history item:",v)}},j=x=>{switch(x){case"domestic":return"bg-green-100 text-green-800";case"commercial":return"bg-blue-100 text-blue-800";case"industrial":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}};return d?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-xl p-6",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(we,{className:"h-8 w-8"}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold mb-2",children:"History"}),i.jsx("p",{className:"text-green-100",children:"View and manage your past calculations, estimations, and recommendations"})]})]})}),i.jsxs("div",{className:"bg-white rounded-xl shadow p-2 flex space-x-2",children:[i.jsx("button",{onClick:()=>t("calculations"),className:`px-4 py-2 rounded-lg text-sm font-medium ${e==="calculations"?"bg-green-600 text-white":"bg-gray-100 text-gray-800"}`,children:"Calculations"}),i.jsx("button",{onClick:()=>t("estimations"),className:`px-4 py-2 rounded-lg text-sm font-medium ${e==="estimations"?"bg-green-600 text-white":"bg-gray-100 text-gray-800"}`,children:"Estimations"}),i.jsx("button",{onClick:()=>t("recommendations"),className:`px-4 py-2 rounded-lg text-sm font-medium ${e==="recommendations"?"bg-green-600 text-white":"bg-gray-100 text-gray-800"}`,children:"Recommendations"})]}),e==="calculations"&&(s.length===0?i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[i.jsx(we,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No calculations yet"}),i.jsx("p",{className:"text-gray-600",children:"Start by creating your first energy calculation!"})]}):i.jsx("div",{className:"grid gap-4",children:s.map(x=>{var v,C,A,$,F,De,G,ce;return i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(we,{className:"h-5 w-5 text-gray-500"}),i.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${j(x.calculation_type)}`,children:x.calculation_type.charAt(0).toUpperCase()+x.calculation_type.slice(1)})]}),i.jsxs("div",{className:"flex items-center space-x-2 text-gray-500",children:[i.jsx(js,{className:"h-4 w-4"}),i.jsx("span",{className:"text-sm",children:new Date(x.created_at).toLocaleDateString()})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:()=>m(x),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200",children:i.jsx(_s,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>N(x.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200",children:i.jsx(jn,{className:"h-4 w-4"})})]})]}),i.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Total Units"}),i.jsxs("div",{className:"font-semibold",children:[((C=(v=x.results)==null?void 0:v.totalUnits)==null?void 0:C.toFixed(2))||"N/A"," kWh"]})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Total Bill"}),i.jsxs("div",{className:"font-semibold text-green-600",children:["",(($=(A=x.results)==null?void 0:A.totalBill)==null?void 0:$.toFixed(2))||"N/A"]})]}),x.calculation_type!=="domestic"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Fixed Charges"}),i.jsxs("div",{className:"font-semibold",children:["",((De=(F=x.results)==null?void 0:F.fixedCharge)==null?void 0:De.toFixed(2))||"N/A"]})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Energy Charges"}),i.jsxs("div",{className:"font-semibold",children:["",((ce=(G=x.results)==null?void 0:G.energyCharge)==null?void 0:ce.toFixed(2))||"N/A"]})]})]})]})]},x.id)})})),e==="estimations"&&(a.length===0?i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[i.jsx(we,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No estimations yet"}),i.jsx("p",{className:"text-gray-600",children:"Run the Unified Estimator to generate history."})]}):i.jsx("div",{className:"grid gap-4",children:a.map(x=>{var v,C,A,$,F;return i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(we,{className:"h-5 w-5 text-gray-500"}),i.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-purple-100 text-purple-800",children:x.estimation_type})]}),i.jsxs("div",{className:"flex items-center space-x-2 text-gray-500",children:[i.jsx(js,{className:"h-4 w-4"}),i.jsx("span",{className:"text-sm",children:new Date(x.created_at).toLocaleDateString()})]})]}),i.jsx("div",{className:"flex items-center space-x-2",children:i.jsx("button",{onClick:()=>m(x),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200",children:i.jsx(_s,{className:"h-4 w-4"})})})]}),i.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Payback Period"}),i.jsxs("div",{className:"font-semibold",children:[((C=(v=x.results)==null?void 0:v.paybackPeriod)==null?void 0:C.toFixed(2))||"N/A"," years"]})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Total Savings (25y)"}),i.jsxs("div",{className:"font-semibold text-green-600",children:["",((F=($=(A=x.results)==null?void 0:A.totalSavings25Years)==null?void 0:$.toLocaleString)==null?void 0:F.call($))||"N/A"]})]})]})]},x.id)})})),e==="recommendations"&&(l.length===0?i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[i.jsx(we,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No recommendations yet"}),i.jsx("p",{className:"text-gray-600",children:"Use the Solar Recommendations tool to generate history."})]}):i.jsx("div",{className:"grid gap-4",children:l.map(x=>{var v,C,A,$;return i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(we,{className:"h-5 w-5 text-gray-500"}),i.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800",children:x.recommendation_type})]}),i.jsxs("div",{className:"flex items-center space-x-2 text-gray-500",children:[i.jsx(js,{className:"h-4 w-4"}),i.jsx("span",{className:"text-sm",children:new Date(x.created_at).toLocaleDateString()})]})]}),i.jsx("div",{className:"flex items-center space-x-2",children:i.jsx("button",{onClick:()=>m(x),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200",children:i.jsx(_s,{className:"h-4 w-4"})})})]}),i.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Required kW"}),i.jsxs("div",{className:"font-semibold",children:[((v=x.results)==null?void 0:v.requiredKW)||"N/A"," kW"]})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Monthly Savings"}),i.jsxs("div",{className:"font-semibold text-green-600",children:["",(($=(A=(C=x.results)==null?void 0:C.savings)==null?void 0:A.toFixed)==null?void 0:$.call(A,0))||"N/A"]})]})]})]},x.id)})})),h&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:i.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Details"}),i.jsx("button",{onClick:()=>m(null),className:"text-gray-500 hover:text-gray-700",children:""})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Type"}),i.jsx("div",{className:"font-semibold capitalize",children:h.calculation_type||h.estimation_type||h.recommendation_type})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Date"}),i.jsx("div",{className:"font-semibold",children:new Date(h.created_at).toLocaleString()})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Inputs"}),i.jsx("pre",{className:"bg-gray-50 p-3 rounded-lg text-sm overflow-x-auto",children:JSON.stringify(h.inputs,null,2)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Results"}),i.jsx("pre",{className:"bg-gray-50 p-3 rounded-lg text-sm overflow-x-auto",children:JSON.stringify(h.results,null,2)})]})]})]})})})]})},wd=()=>{const{user:r,isAdmin:e}=pe(),[t,s]=O.useState([]),[n,a]=O.useState(!0);O.useState(null),O.useState({tariff_type:"domestic",tariff_data:{}}),O.useEffect(()=>{e&&o()},[e]);const o=async()=>{try{const{data:l,error:c}=await X.from("tariff_settings").select("*").order("updated_at",{ascending:!1});if(c)throw c;s(l||[])}catch(l){console.error("Error fetching tariffs:",l)}finally{a(!1)}};return e?n?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-gradient-to-r from-red-500 to-pink-500 text-white rounded-xl p-6",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(Bs,{className:"h-8 w-8"}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Tariff Management"}),i.jsx("p",{className:"text-red-100",children:"Manage electricity tariff rates and structures"})]})]})}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Domestic Tariff Slabs"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-green-50",children:[i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Units Range"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Rate (/kWh)"}),i.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-700",children:"Actions"})]})}),i.jsxs("tbody",{className:"divide-y divide-gray-200",children:[i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-2",children:"0-30"}),i.jsx("td",{className:"px-4 py-2",children:"1.90"}),i.jsx("td",{className:"px-4 py-2 text-center",children:i.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:i.jsx(ne,{className:"h-4 w-4"})})})]}),i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-2",children:"31-75"}),i.jsx("td",{className:"px-4 py-2",children:"3.00"}),i.jsx("td",{className:"px-4 py-2 text-center",children:i.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:i.jsx(ne,{className:"h-4 w-4"})})})]}),i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-2",children:"76-125"}),i.jsx("td",{className:"px-4 py-2",children:"4.50"}),i.jsx("td",{className:"px-4 py-2 text-center",children:i.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:i.jsx(ne,{className:"h-4 w-4"})})})]}),i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-2",children:"126-225"}),i.jsx("td",{className:"px-4 py-2",children:"6.00"}),i.jsx("td",{className:"px-4 py-2 text-center",children:i.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:i.jsx(ne,{className:"h-4 w-4"})})})]}),i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-2",children:"226-400"}),i.jsx("td",{className:"px-4 py-2",children:"8.75"}),i.jsx("td",{className:"px-4 py-2 text-center",children:i.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:i.jsx(ne,{className:"h-4 w-4"})})})]}),i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-2",children:"400"}),i.jsx("td",{className:"px-4 py-2",children:"9.75"}),i.jsx("td",{className:"px-4 py-2 text-center",children:i.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:i.jsx(ne,{className:"h-4 w-4"})})})]})]})]})})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Commercial Tariff Structure"}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Fixed Charges"}),i.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{children:"Fixed Charge Rate:"}),i.jsx("span",{className:"font-semibold",children:"75/kW/month"}),i.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:i.jsx(ne,{className:"h-4 w-4"})})]})})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Energy Charges"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-2 rounded",children:[i.jsx("span",{className:"text-sm",children:"0-50 units:"}),i.jsx("span",{className:"font-semibold",children:"5.40/kWh"}),i.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:i.jsx(ne,{className:"h-4 w-4"})})]}),i.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-2 rounded",children:[i.jsx("span",{className:"text-sm",children:"51-100 units:"}),i.jsx("span",{className:"font-semibold",children:"7.65/kWh"}),i.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:i.jsx(ne,{className:"h-4 w-4"})})]}),i.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-2 rounded",children:[i.jsx("span",{className:"text-sm",children:"101-300 units:"}),i.jsx("span",{className:"font-semibold",children:"9.05/kWh"}),i.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:i.jsx(ne,{className:"h-4 w-4"})})]}),i.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-2 rounded",children:[i.jsx("span",{className:"text-sm",children:"301-500 units:"}),i.jsx("span",{className:"font-semibold",children:"9.60/kWh"}),i.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:i.jsx(ne,{className:"h-4 w-4"})})]}),i.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-2 rounded",children:[i.jsx("span",{className:"text-sm",children:"500 units:"}),i.jsx("span",{className:"font-semibold",children:"10.15/kWh"}),i.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:i.jsx(ne,{className:"h-4 w-4"})})]})]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Industrial Tariff Structure"}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[i.jsx("div",{className:"bg-orange-50 p-4 rounded-lg",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium",children:"Fixed Charges:"}),i.jsx("span",{className:"font-semibold",children:"75/kW/month"}),i.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:i.jsx(ne,{className:"h-4 w-4"})})]})}),i.jsx("div",{className:"bg-red-50 p-4 rounded-lg",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium",children:"Energy Charges:"}),i.jsx("span",{className:"font-semibold",children:"6.70/kWh"}),i.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:i.jsx(ne,{className:"h-4 w-4"})})]})})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{className:"flex items-center space-x-2 bg-gradient-to-r from-green-500 to-blue-500 text-white px-6 py-3 rounded-lg hover:shadow-md transition-all duration-200",children:[i.jsx(Hc,{className:"h-5 w-5"}),i.jsx("span",{children:"Save All Changes"})]})}),i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Recent Tariff Changes"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Domestic Slab 1 Rate Updated"}),i.jsx("div",{className:"text-sm text-gray-500",children:"Changed from 1.85 to 1.90"})]}),i.jsx("div",{className:"text-sm text-gray-500",children:"2 days ago"})]}),i.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Commercial Fixed Charge Updated"}),i.jsx("div",{className:"text-sm text-gray-500",children:"Changed from 70 to 75 per kW"})]}),i.jsx("div",{className:"text-sm text-gray-500",children:"1 week ago"})]})]})]})]}):i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[i.jsx("div",{className:"text-red-500 mb-4",children:i.jsx(Bs,{className:"h-16 w-16 mx-auto"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Access Denied"}),i.jsx("p",{className:"text-gray-600",children:"You need admin privileges to access this page."})]})};function jd(){return i.jsx(gl,{children:i.jsx(Mn,{children:i.jsxs(Bn,{children:[i.jsx(ye,{path:"/login",element:i.jsx(Qc,{})}),i.jsx(ye,{path:"/register",element:i.jsx(ed,{})}),i.jsxs(ye,{path:"/dashboard",element:i.jsx(Ur,{children:i.jsx(td,{})}),children:[i.jsx(ye,{index:!0,element:i.jsx(Mt,{to:"/dashboard/calculations",replace:!0})}),i.jsx(ye,{path:"calculations",element:i.jsx(ud,{})}),i.jsx(ye,{path:"estimations",element:i.jsx(pd,{})}),i.jsx(ye,{path:"recommendations",element:i.jsx(bd,{})}),i.jsx(ye,{path:"history",element:i.jsx(vd,{})}),i.jsx(ye,{path:"admin",element:i.jsx(Ur,{requireAdmin:!0,children:i.jsx(wd,{})})})]}),i.jsx(ye,{path:"/",element:i.jsx(Mt,{to:"/dashboard",replace:!0})})]})})})}wi(document.getElementById("root")).render(i.jsx(O.StrictMode,{children:i.jsx(jd,{})}));
