import{r as C,a as Vi,g as qi,c as pe,R as J,b as Wi}from"./vendor-CyBwq7db.js";import{u as _n,N as Dt,a as Ms,L as Nn,O as zi,B as Hi,R as Gi,b as je}from"./router-CMxrBoBO.js";import{C as Bs,a as kn,L as Sn,B as Ki,p as En,b as Vs,c as qs,A as Tn,d as Ji,D as Yi,P as Zi,e as Qi,f as Xi,g as ea}from"./charts-DYWOA8Ov.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();var An={exports:{}},Ht={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ta=C,sa=Symbol.for("react.element"),ra=Symbol.for("react.fragment"),na=Object.prototype.hasOwnProperty,ia=ta.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,aa={key:!0,ref:!0,__self:!0,__source:!0};function Cn(r,e,t){var s,i={},a=null,o=null;t!==void 0&&(a=""+t),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)na.call(e,s)&&!aa.hasOwnProperty(s)&&(i[s]=e[s]);if(r&&r.defaultProps)for(s in e=r.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:sa,type:r,key:a,ref:o,props:i,_owner:ia.current}}Ht.Fragment=ra;Ht.jsx=Cn;Ht.jsxs=Cn;An.exports=Ht;var n=An.exports,On,jr=Vi;On=jr.createRoot,jr.hydrateRoot;const oa="modulepreload",la=function(r){return"/"+r},_r={},Nt=function(e,t,s){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(t.map(c=>{if(c=la(c),c in _r)return;_r[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":oa,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((m,p)=>{h.addEventListener("load",m),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})},ca=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Nt(async()=>{const{default:s}=await Promise.resolve().then(()=>ht);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class Ws extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class da extends Ws{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Nr extends Ws{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class kr extends Ws{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var js;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(js||(js={}));var ua=function(r,e,t,s){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):i(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};class ha{constructor(e,{headers:t={},customFetch:s,region:i=js.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=ca(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return ua(this,void 0,void 0,function*(){try{const{headers:i,method:a,body:o}=t;let l={},{region:c}=t;c||(c=this.region);const d=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let u;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(d.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),i),body:u}).catch(x=>{throw new da(x)}),m=h.headers.get("x-relay-error");if(m&&m==="true")throw new Nr(h);if(!h.ok)throw new kr(h);let p=((s=h.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),j;return p==="application/json"?j=yield h.json():p==="application/octet-stream"?j=yield h.blob():p==="text/event-stream"?j=h:p==="multipart/form-data"?j=yield h.formData():j=yield h.text(),{data:j,error:null,response:h}}catch(i){return{data:null,error:i,response:i instanceof kr||i instanceof Nr?i.context:void 0}}})}}var fe={},zs={},Gt={},kt={},Kt={},Jt={},fa=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},dt=fa();const ma=dt.fetch,$n=dt.fetch.bind(dt),Pn=dt.Headers,ga=dt.Request,pa=dt.Response,ht=Object.freeze(Object.defineProperty({__proto__:null,Headers:Pn,Request:ga,Response:pa,default:$n,fetch:ma},Symbol.toStringTag,{value:"Module"})),xa=qi(ht);var Yt={};Object.defineProperty(Yt,"__esModule",{value:!0});let ya=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Yt.default=ya;var Rn=pe&&pe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Jt,"__esModule",{value:!0});const ba=Rn(xa),va=Rn(Yt);let wa=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=ba.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let i=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var o,l,c;let d=null,u=null,h=null,m=a.status,p=a.statusText;if(a.ok){if(this.method!=="HEAD"){const S=await a.text();S===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=S:u=JSON.parse(S))}const x=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),y=(l=a.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");x&&y&&y.length>1&&(h=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(d={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,m=406,p="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const x=await a.text();try{d=JSON.parse(x),Array.isArray(d)&&a.status===404&&(u=[],d=null,m=200,p="OK")}catch{a.status===404&&x===""?(m=204,p="No Content"):d={message:x}}if(d&&this.isMaybeSingle&&(!((c=d==null?void 0:d.details)===null||c===void 0)&&c.includes("0 rows"))&&(d=null,m=200,p="OK"),d&&this.shouldThrowOnError)throw new va.default(d)}return{error:d,data:u,count:h,status:m,statusText:p}});return this.shouldThrowOnError||(i=i.catch(a=>{var o,l,c;return{error:{message:`${(o=a==null?void 0:a.name)!==null&&o!==void 0?o:"FetchError"}: ${a==null?void 0:a.message}`,details:`${(l=a==null?void 0:a.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=a==null?void 0:a.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}};Jt.default=wa;var ja=pe&&pe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Kt,"__esModule",{value:!0});const _a=ja(Jt);let Na=class extends _a.default{select(e){let t=!1;const s=(e??"*").split("").map(i=>/\s/.test(i)&&!t?"":(i==='"'&&(t=!t),i)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:i,referencedTable:a=i}={}){const o=a?`${a}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:i=s}={}){const a=typeof i>"u"?"offset":`${i}.offset`,o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:i=!1,wal:a=!1,format:o="text"}={}){var l;const c=[e?"analyze":null,t?"verbose":null,s?"settings":null,i?"buffers":null,a?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${d}"; options=${c};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Kt.default=Na;var ka=pe&&pe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(kt,"__esModule",{value:!0});const Sa=ka(Kt);let Ea=class extends Sa.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:i}={}){let a="";i==="plain"?a="pl":i==="phrase"?a="ph":i==="websearch"&&(a="w");const o=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${a}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const i=s?`${s}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};kt.default=Ea;var Ta=pe&&pe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Gt,"__esModule",{value:!0});const mt=Ta(kt);let Aa=class{constructor(e,{headers:t={},schema:s,fetch:i}){this.url=e,this.headers=t,this.schema=s,this.fetch=i}select(e,{head:t=!1,count:s}={}){const i=t?"HEAD":"GET";let a=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),s&&(this.headers.Prefer=`count=${s}`),new mt.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const i="POST",a=[];if(this.headers.Prefer&&a.push(this.headers.Prefer),t&&a.push(`count=${t}`),s||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const o=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new mt.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:i,defaultToNull:a=!0}={}){const o="POST",l=[`resolution=${s?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),a||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const c=e.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new mt.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),this.headers.Prefer=i.join(","),new mt.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new mt.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Gt.default=Aa;var Zt={},Qt={};Object.defineProperty(Qt,"__esModule",{value:!0});Qt.version=void 0;Qt.version="0.0.0-automated";Object.defineProperty(Zt,"__esModule",{value:!0});Zt.DEFAULT_HEADERS=void 0;const Ca=Qt;Zt.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Ca.version}`};var Fn=pe&&pe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(zs,"__esModule",{value:!0});const Oa=Fn(Gt),$a=Fn(kt),Pa=Zt;let Ra=class In{constructor(e,{headers:t={},schema:s,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},Pa.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=i}from(e){const t=new URL(`${this.url}/${e}`);return new Oa.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new In(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:i=!1,count:a}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let c;s||i?(o=s?"HEAD":"GET",Object.entries(t).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{l.searchParams.append(u,h)})):(o="POST",c=t);const d=Object.assign({},this.headers);return a&&(d.Prefer=`count=${a}`),new $a.default({method:o,url:l,headers:d,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};zs.default=Ra;var ft=pe&&pe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(fe,"__esModule",{value:!0});fe.PostgrestError=fe.PostgrestBuilder=fe.PostgrestTransformBuilder=fe.PostgrestFilterBuilder=fe.PostgrestQueryBuilder=fe.PostgrestClient=void 0;const Dn=ft(zs);fe.PostgrestClient=Dn.default;const Ln=ft(Gt);fe.PostgrestQueryBuilder=Ln.default;const Un=ft(kt);fe.PostgrestFilterBuilder=Un.default;const Mn=ft(Kt);fe.PostgrestTransformBuilder=Mn.default;const Bn=ft(Jt);fe.PostgrestBuilder=Bn.default;const Vn=ft(Yt);fe.PostgrestError=Vn.default;var Fa=fe.default={PostgrestClient:Dn.default,PostgrestQueryBuilder:Ln.default,PostgrestFilterBuilder:Un.default,PostgrestTransformBuilder:Mn.default,PostgrestBuilder:Bn.default,PostgrestError:Vn.default};const{PostgrestClient:Ia,PostgrestQueryBuilder:Dd,PostgrestFilterBuilder:Ld,PostgrestTransformBuilder:Ud,PostgrestBuilder:Md,PostgrestError:Bd}=Fa;class Da{static dynamicRequire(e){try{return typeof process<"u"&&process.versions&&process.versions.node&&typeof require<"u"?require(e):null}catch{return null}}static detectEnvironment(){var e,t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const s=parseInt(process.versions.node.split(".")[0]);if(s>=22)try{if(typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};const i=this.dynamicRequire("undici");if(i&&i.WebSocket)return{type:"native",constructor:i.WebSocket};throw new Error("undici not available")}catch{return{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:'Install the "ws" package or check your Node.js installation.'}}try{const i=this.dynamicRequire("ws");if(i)return{type:"ws",constructor:(t=i.WebSocket)!==null&&t!==void 0?t:i};throw new Error("ws package not available")}catch{return{type:"unsupported",error:`Node.js ${s} detected without WebSocket support.`,workaround:'Install the "ws" package: npm install ws'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const s=this.getWebSocketConstructor();return new s(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const La="2.15.0",Ua=`realtime-js/${La}`,Ma="1.0.0",_s=1e4,Ba=1e3,Va=100;var yt;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(yt||(yt={}));var X;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(X||(X={}));var ye;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(ye||(ye={}));var Ns;(function(r){r.websocket="websocket"})(Ns||(Ns={}));var ze;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(ze||(ze={}));class qa{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const i=t.getUint8(1),a=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=s.decode(e.slice(o,o+i));o=o+i;const c=s.decode(e.slice(o,o+a));o=o+a;const d=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class qn{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var z;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(z||(z={}));const Sr=(r,e,t={})=>{var s;const i=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((a,o)=>(a[o]=Wa(o,r,e,i),a),{})},Wa=(r,e,t,s)=>{const i=e.find(l=>l.name===r),a=i==null?void 0:i.type,o=t[r];return a&&!s.includes(a)?Wn(a,o):ks(o)},Wn=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return Ka(e,t)}switch(r){case z.bool:return za(e);case z.float4:case z.float8:case z.int2:case z.int4:case z.int8:case z.numeric:case z.oid:return Ha(e);case z.json:case z.jsonb:return Ga(e);case z.timestamp:return Ja(e);case z.abstime:case z.date:case z.daterange:case z.int4range:case z.int8range:case z.money:case z.reltime:case z.text:case z.time:case z.timestamptz:case z.timetz:case z.tsrange:case z.tstzrange:return ks(e);default:return ks(e)}},ks=r=>r,za=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Ha=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},Ga=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},Ka=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,s=r[t];if(r[0]==="{"&&s==="}"){let a;const o=r.slice(1,t);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>Wn(e,l))}return r},Ja=r=>typeof r=="string"?r.replace(" ","T"):r,zn=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class ds{constructor(e,t,s={},i=_s){this.channel=e,this.event=t,this.payload=s,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Er;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(Er||(Er={}));class bt{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},i=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=bt.syncState(this.state,i,a,o),this.pendingDiffs.forEach(c=>{this.state=bt.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},i=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=bt.syncDiff(this.state,i,a,o),l())}),this.onJoin((i,a,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:a,newPresences:o})}),this.onLeave((i,a,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,i){const a=this.cloneDeep(e),o=this.transformState(t),l={},c={};return this.map(a,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const h=a[d];if(h){const m=u.map(y=>y.presence_ref),p=h.map(y=>y.presence_ref),j=u.filter(y=>p.indexOf(y.presence_ref)<0),x=h.filter(y=>m.indexOf(y.presence_ref)<0);j.length>0&&(l[d]=j),x.length>0&&(c[d]=x)}else l[d]=u}),this.syncDiff(a,{joins:l,leaves:c},s,i)}static syncDiff(e,t,s,i){const{joins:a,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),i||(i=()=>{}),this.map(a,(l,c)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),u.length>0){const h=e[l].map(p=>p.presence_ref),m=u.filter(p=>h.indexOf(p.presence_ref)<0);e[l].unshift(...m)}s(l,u,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),e[l]=d,i(l,d,c),d.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const i=e[s];return"metas"in i?t[s]=i.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[s]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Tr;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(Tr||(Tr={}));var vt;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(vt||(vt={}));var Oe;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Oe||(Oe={}));class Hs{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=X.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new ds(this,ye.join,this.params,this.timeout),this.rejoinTimer=new qn(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=X.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=X.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=X.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=X.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=X.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ye.reply,{},(i,a)=>{this._trigger(this._replyEventName(a),i)}),this.presence=new bt(this),this.broadcastEndpointURL=zn(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==X.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,c=(i=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(m=>m.filter))!==null&&i!==void 0?i:[],d=!!this.bindings[vt.PRESENCE]&&this.bindings[vt.PRESENCE].length>0,u={},h={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:d}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(m=>e==null?void 0:e(Oe.CHANNEL_ERROR,m)),this._onClose(()=>e==null?void 0:e(Oe.CLOSED)),this.updateJoinPayload(Object.assign({config:h},u)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:m})=>{var p;if(this.socket.setAuth(),m===void 0){e==null||e(Oe.SUBSCRIBED);return}else{const j=this.bindings.postgres_changes,x=(p=j==null?void 0:j.length)!==null&&p!==void 0?p:0,y=[];for(let S=0;S<x;S++){const b=j[S],{filter:{event:w,schema:E,table:O,filter:P}}=b,F=m&&m[S];if(F&&F.event===w&&F.schema===E&&F.table===O&&F.filter===P)y.push(Object.assign(Object.assign({},b),{id:F.id}));else{this.unsubscribe(),this.state=X.errored,e==null||e(Oe.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(Oe.SUBSCRIBED);return}}).receive("error",m=>{this.state=X.errored,e==null||e(Oe.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Oe.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===X.joined&&e===vt.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,s)}async send(e,t={}){var s,i;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((i=d.body)===null||i===void 0?void 0:i.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),d.receive("ok",()=>a("ok")),d.receive("error",()=>a("error")),d.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=X.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ye.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(i=>{s=new ds(this,ye.leave,{},e),s.receive("ok",()=>{t(),i("ok")}).receive("timeout",()=>{t(),i("timed out")}).receive("error",()=>{i("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=X.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const i=new AbortController,a=setTimeout(()=>i.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(a),o}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new ds(this,e,t,s);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Va){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var i,a;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=ye;if(s&&[l,c,d,u].indexOf(o)>=0&&s!==this._joinRef())return;let m=this._onMessage(o,t,s);if(t&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var j,x,y;return((j=p.filter)===null||j===void 0?void 0:j.event)==="*"||((y=(x=p.filter)===null||x===void 0?void 0:x.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(p=>p.callback(m,s)):(a=this.bindings[o])===null||a===void 0||a.filter(p=>{var j,x,y,S,b,w;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const E=p.id,O=(j=p.filter)===null||j===void 0?void 0:j.event;return E&&((x=t.ids)===null||x===void 0?void 0:x.includes(E))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((y=t.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const E=(b=(S=p==null?void 0:p.filter)===null||S===void 0?void 0:S.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return E==="*"||E===((w=t==null?void 0:t.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof m=="object"&&"ids"in m){const j=m.data,{schema:x,table:y,commit_timestamp:S,type:b,errors:w}=j;m=Object.assign(Object.assign({},{schema:x,table:y,commit_timestamp:S,eventType:b,new:{},old:{},errors:w}),this._getPayloadRecords(j))}p.callback(m,s)})}_isClosed(){return this.state===X.closed}_isJoined(){return this.state===X.joined}_isJoining(){return this.state===X.joining}_isLeaving(){return this.state===X.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const i=e.toLocaleLowerCase(),a={type:i,filter:t,callback:s};return this.bindings[i]?this.bindings[i].push(a):this.bindings[i]=[a],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(i=>{var a;return!(((a=i.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&Hs.isEqual(i.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ye.close,{},e)}_onError(e){this._on(ye.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=X.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Sr(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Sr(e.columns,e.old_record)),t}}const Ar=()=>{},At={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Ya=[1e3,2e3,5e3,1e4],Za=1e4,Qa=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Xa{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=_s,this.transport=null,this.heartbeatIntervalMs=At.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ar,this.ref=0,this.reconnectTimer=null,this.logger=Ar,this.conn=null,this.sendBuffer=[],this.serializer=new qa,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>Nt(async()=>{const{default:l}=await Promise.resolve().then(()=>ht);return{default:l}},void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...o)=>a(...o)},!(!((s=t==null?void 0:t.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Ns.websocket}`,this.httpEndpoint=zn(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Da.createWebSocket(this.endpointURL())}catch(e){throw this._setConnectionState("disconnected"),new Error(`WebSocket not available: ${e.message}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Ma}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case yt.connecting:return ze.Connecting;case yt.open:return ze.Open;case yt.closing:return ze.Closing;default:return ze.Closed}}isConnected(){return this.connectionState()===ze.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const s=`realtime:${e}`,i=this.getChannels().find(a=>a.topic===s);if(i)return i;{const a=new Hs(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:s,payload:i,ref:a}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${s} (${a})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Ba,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},At.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:i,payload:a,ref:o}=t,l=o?`(${o})`:"",c=a.status||"";this.log("receive",`${c} ${s} ${i} ${l}`.trim(),a),this.channels.filter(d=>d._isMember(s)).forEach(d=>d._trigger(i,a,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(ye.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${s}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([Qa],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const i={access_token:t,version:Ua};t&&s.updateJoinPayload(i),s.joinedOnce&&s._isJoined()&&s._push(ye.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new qn(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},At.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,i,a,o,l,c,d;if(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:_s,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:At.HEARTBEAT_INTERVAL,this.worker=(a=e==null?void 0:e.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e==null?void 0:e.reconnectAfterMs)!==null&&l!==void 0?l:u=>Ya[u-1]||Za,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(u,h)=>h(JSON.stringify(u)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Gs extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function se(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class eo extends Gs{constructor(e,t,s){super(e),this.name="StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Ss extends Gs{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var to=function(r,e,t,s){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):i(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const Hn=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Nt(async()=>{const{default:s}=await Promise.resolve().then(()=>ht);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},so=()=>to(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Nt(()=>Promise.resolve().then(()=>ht),void 0)).Response:Response}),Es=r=>{if(Array.isArray(r))return r.map(t=>Es(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,s])=>{const i=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[i]=Es(s)}),e},ro=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)};var Ze=function(r,e,t,s){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):i(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const us=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),no=(r,e,t)=>Ze(void 0,void 0,void 0,function*(){const s=yield so();r instanceof s&&!(t!=null&&t.noResolveJson)?r.json().then(i=>{const a=r.status||500,o=(i==null?void 0:i.statusCode)||a+"";e(new eo(us(i),a,o))}).catch(i=>{e(new Ss(us(i),i))}):e(new Ss(us(r),r))}),io=(r,e,t,s)=>{const i={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"||!s?i:(ro(s)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(s)):i.body=s,Object.assign(Object.assign({},i),t))};function St(r,e,t,s,i,a){return Ze(this,void 0,void 0,function*(){return new Promise((o,l)=>{r(t,io(e,s,i,a)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>no(c,l,s))})})}function Lt(r,e,t,s){return Ze(this,void 0,void 0,function*(){return St(r,"GET",e,t,s)})}function $e(r,e,t,s,i){return Ze(this,void 0,void 0,function*(){return St(r,"POST",e,s,i,t)})}function Ts(r,e,t,s,i){return Ze(this,void 0,void 0,function*(){return St(r,"PUT",e,s,i,t)})}function ao(r,e,t,s){return Ze(this,void 0,void 0,function*(){return St(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function Gn(r,e,t,s,i){return Ze(this,void 0,void 0,function*(){return St(r,"DELETE",e,s,i,t)})}var ce=function(r,e,t,s){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):i(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const oo={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Cr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class lo{constructor(e,t={},s,i){this.url=e,this.headers=t,this.bucketId=s,this.fetch=Hn(i)}uploadOrUpdate(e,t,s,i){return ce(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},Cr),i);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&s instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",s)):typeof FormData<"u"&&s instanceof FormData?(a=s,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c))):(a=s,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));const d=this._removeEmptyFolders(t),u=this._getFinalPath(d),h=yield(e=="PUT"?Ts:$e)(this.fetch,`${this.url}/object/${u}`,a,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:h.Id,fullPath:h.Key},error:null}}catch(a){if(se(a))return{data:null,error:a};throw a}})}upload(e,t,s){return ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,i){return ce(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let c;const d=Object.assign({upsert:Cr.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",d.cacheControl)):(c=s,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield Ts(this.fetch,l.toString(),c,{headers:u});return{data:{path:a,fullPath:h.Key},error:null}}catch(c){if(se(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return ce(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const i=Object.assign({},this.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const a=yield $e(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:i}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new Gs("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(s){if(se(s))return{data:null,error:s};throw s}})}update(e,t,s){return ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return ce(this,void 0,void 0,function*(){try{return{data:yield $e(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(se(i))return{data:null,error:i};throw i}})}copy(e,t,s){return ce(this,void 0,void 0,function*(){try{return{data:{path:(yield $e(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(se(i))return{data:null,error:i};throw i}})}createSignedUrl(e,t,s){return ce(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),a=yield $e(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(i){if(se(i))return{data:null,error:i};throw i}})}createSignedUrls(e,t,s){return ce(this,void 0,void 0,function*(){try{const i=yield $e(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(i){if(se(i))return{data:null,error:i};throw i}})}download(e,t){return ce(this,void 0,void 0,function*(){const i=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=a?`?${a}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Lt(this.fetch,`${this.url}/${i}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(se(l))return{data:null,error:l};throw l}})}info(e){return ce(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield Lt(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Es(s),error:null}}catch(s){if(se(s))return{data:null,error:s};throw s}})}exists(e){return ce(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield ao(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(se(s)&&s instanceof Ss){const i=s.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),i=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&i.push(a);const l=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});c!==""&&i.push(c);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${d}`)}}}remove(e){return ce(this,void 0,void 0,function*(){try{return{data:yield Gn(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(se(t))return{data:null,error:t};throw t}})}list(e,t,s){return ce(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},oo),t),{prefix:e||""});return{data:yield $e(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},s),error:null}}catch(i){if(se(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const co="2.10.4",uo={"X-Client-Info":`storage-js/${co}`};var Xe=function(r,e,t,s){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):i(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};class ho{constructor(e,t={},s,i){const a=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},uo),t),this.fetch=Hn(s)}listBuckets(){return Xe(this,void 0,void 0,function*(){try{return{data:yield Lt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(se(e))return{data:null,error:e};throw e}})}getBucket(e){return Xe(this,void 0,void 0,function*(){try{return{data:yield Lt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(se(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Xe(this,void 0,void 0,function*(){try{return{data:yield $e(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(se(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return Xe(this,void 0,void 0,function*(){try{return{data:yield Ts(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(se(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Xe(this,void 0,void 0,function*(){try{return{data:yield $e(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(se(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Xe(this,void 0,void 0,function*(){try{return{data:yield Gn(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(se(t))return{data:null,error:t};throw t}})}}class fo extends ho{constructor(e,t={},s,i){super(e,t,s,i)}from(e){return new lo(this.url,this.headers,e,this.fetch)}}const mo="2.54.0";let xt="";typeof Deno<"u"?xt="deno":typeof document<"u"?xt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?xt="react-native":xt="node";const go={"X-Client-Info":`supabase-js-${xt}/${mo}`},po={headers:go},xo={schema:"public"},yo={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},bo={};var vo=function(r,e,t,s){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):i(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const wo=r=>{let e;return r?e=r:typeof fetch>"u"?e=$n:e=fetch,(...t)=>e(...t)},jo=()=>typeof Headers>"u"?Pn:Headers,_o=(r,e,t)=>{const s=wo(t),i=jo();return(a,o)=>vo(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:r;let d=new i(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",r),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),s(a,Object.assign(Object.assign({},o),{headers:d}))})};var No=function(r,e,t,s){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):i(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};function ko(r){return r.endsWith("/")?r:r+"/"}function So(r,e){var t,s;const{db:i,auth:a,realtime:o,global:l}=r,{db:c,auth:d,realtime:u,global:h}=e,m={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},d),a),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(t=h==null?void 0:h.headers)!==null&&t!==void 0?t:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>No(this,void 0,void 0,function*(){return""})};return r.accessToken?m.accessToken=r.accessToken:delete m.accessToken,m}const Kn="2.71.1",ot=30*1e3,As=3,hs=As*ot,Eo="http://localhost:9999",To="supabase.auth.token",Ao={"X-Client-Info":`gotrue-js/${Kn}`},Cs="X-Supabase-Api-Version",Jn={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Co=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Oo=10*60*1e3;class Ks extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function R(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class $o extends Ks{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function Po(r){return R(r)&&r.name==="AuthApiError"}class Yn extends Ks{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Me extends Ks{constructor(e,t,s,i){super(e,s,i),this.name=t,this.status=s}}class Ie extends Me{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ro(r){return R(r)&&r.name==="AuthSessionMissingError"}class Ct extends Me{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ot extends Me{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class $t extends Me{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Fo(r){return R(r)&&r.name==="AuthImplicitGrantRedirectError"}class Or extends Me{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Os extends Me{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function fs(r){return R(r)&&r.name==="AuthRetryableFetchError"}class $r extends Me{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class $s extends Me{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ut="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Pr=` 	
\r=`.split(""),Io=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<Pr.length;e+=1)r[Pr[e].charCodeAt(0)]=-2;for(let e=0;e<Ut.length;e+=1)r[Ut[e].charCodeAt(0)]=e;return r})();function Rr(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Ut[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Ut[s]),e.queuedBits-=6}}function Zn(r,e,t){const s=Io[r];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function Fr(r){const e=[],t=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},a=o=>{Uo(o,s,t)};for(let o=0;o<r.length;o+=1)Zn(r.charCodeAt(o),i,a);return e.join("")}function Do(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function Lo(r,e){for(let t=0;t<r.length;t+=1){let s=r.charCodeAt(t);if(s>55295&&s<=56319){const i=(s-55296)*1024&65535;s=(r.charCodeAt(t+1)-56320&65535|i)+65536,t+=1}Do(s,e)}}function Uo(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let s=1;s<6;s+=1)if(!(r>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Mo(r){const e=[],t={queue:0,queuedBits:0},s=i=>{e.push(i)};for(let i=0;i<r.length;i+=1)Zn(r.charCodeAt(i),t,s);return new Uint8Array(e)}function Bo(r){const e=[];return Lo(r,t=>e.push(t)),new Uint8Array(e)}function Vo(r){const e=[],t={queue:0,queuedBits:0},s=i=>{e.push(i)};return r.forEach(i=>Rr(i,t,s)),Rr(null,t,s),e.join("")}function qo(r){return Math.round(Date.now()/1e3)+r}function Wo(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const xe=()=>typeof window<"u"&&typeof document<"u",Ve={tested:!1,writable:!1},Qn=()=>{if(!xe())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ve.tested)return Ve.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Ve.tested=!0,Ve.writable=!0}catch{Ve.tested=!0,Ve.writable=!1}return Ve.writable};function zo(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,a)=>{e[a]=i})}catch{}return t.searchParams.forEach((s,i)=>{e[i]=s}),e}const Xn=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Nt(async()=>{const{default:s}=await Promise.resolve().then(()=>ht);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Ho=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",lt=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},qe=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Fe=async(r,e)=>{await r.removeItem(e)};class Xt{constructor(){this.promise=new Xt.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Xt.promiseConstructor=Promise;function ms(r){const e=r.split(".");if(e.length!==3)throw new $s("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!Co.test(e[s]))throw new $s("JWT not in base64url format");return{header:JSON.parse(Fr(e[0])),payload:JSON.parse(Fr(e[1])),signature:Mo(e[2]),raw:{header:e[0],payload:e[1]}}}async function Go(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function Ko(r,e){return new Promise((s,i)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await r(a);if(!e(a,null,o)){s(o);return}}catch(o){if(!e(a,o)){i(o);return}}})()})}function Jo(r){return("0"+r.toString(16)).substr(-2)}function Yo(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let i="";for(let a=0;a<56;a++)i+=t.charAt(Math.floor(Math.random()*s));return i}return crypto.getRandomValues(e),Array.from(e,Jo).join("")}async function Zo(r){const t=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(s);return Array.from(i).map(a=>String.fromCharCode(a)).join("")}async function Qo(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await Zo(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function et(r,e,t=!1){const s=Yo();let i=s;t&&(i+="/PASSWORD_RECOVERY"),await lt(r,`${e}-code-verifier`,i);const a=await Qo(s);return[a,s===a?"plain":"s256"]}const Xo=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function el(r){const e=r.headers.get(Cs);if(!e||!e.match(Xo))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function tl(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function sl(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const rl=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function tt(r){if(!rl.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function gs(){const r={};return new Proxy(r,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const s=t.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Ir(r){return JSON.parse(JSON.stringify(r))}var nl=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(r);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(r,s[i])&&(t[s[i]]=r[s[i]]);return t};const We=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),il=[502,503,504];async function Dr(r){var e;if(!Ho(r))throw new Os(We(r),0);if(il.includes(r.status))throw new Os(We(r),r.status);let t;try{t=await r.json()}catch(a){throw new Yn(We(a),a)}let s;const i=el(r);if(i&&i.getTime()>=Jn["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new $r(We(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Ie}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new $r(We(t),r.status,t.weak_password.reasons);throw new $o(We(t),r.status||500,s)}const al=(r,e,t,s)=>{const i={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(s),Object.assign(Object.assign({},i),t))};async function D(r,e,t,s){var i;const a=Object.assign({},s==null?void 0:s.headers);a[Cs]||(a[Cs]=Jn["2024-01-01"].name),s!=null&&s.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const o=(i=s==null?void 0:s.query)!==null&&i!==void 0?i:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await ol(r,e,t+l,{headers:a,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function ol(r,e,t,s,i,a){const o=al(e,s,i,a);let l;try{l=await r(t,Object.assign({},o))}catch(c){throw console.error(c),new Os(We(c),0)}if(l.ok||await Dr(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await Dr(c)}}function Ce(r){var e;let t=null;ul(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=qo(r.expires_in)));const s=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:s},error:null}}function Lr(r){const e=Ce(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=r.weak_password),e}function De(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function ll(r){return{data:r,error:null}}function cl(r){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:i,verification_type:a}=r,o=nl(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:s,redirect_to:i,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function dl(r){return r}function ul(r){return r.access_token&&r.refresh_token&&r.expires_in}const ps=["global","local","others"];var hl=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(r);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(r,s[i])&&(t[s[i]]=r[s[i]]);return t};class fl{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=Xn(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=ps[0]){if(ps.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ps.join(", ")}`);try{return await D(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(R(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await D(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:De})}catch(s){if(R(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=hl(e,["options"]),i=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(i.new_email=s==null?void 0:s.newEmail,delete i.newEmail),await D(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:cl,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(R(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await D(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:De})}catch(t){if(R(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,i,a,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await D(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(a=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:dl});if(u.error)throw u.error;const h=await u.json(),m=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(j=>{const x=parseInt(j.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(j.split(";")[1].split("=")[1]);d[`${y}Page`]=x}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(R(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){tt(e);try{return await D(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:De})}catch(t){if(R(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){tt(e);try{return await D(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:De})}catch(s){if(R(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){tt(e);try{return await D(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:De})}catch(s){if(R(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){tt(e.userId);try{const{data:t,error:s}=await D(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:s}}catch(t){if(R(t))return{data:null,error:t};throw t}}async _deleteFactor(e){tt(e.userId),tt(e.id);try{return{data:await D(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(R(t))return{data:null,error:t};throw t}}}function Ur(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function ml(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const st={debug:!!(globalThis&&Qn()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ei extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class gl extends ei{}async function pl(r,e,t){st.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),st.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async i=>{if(i){st.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,i.name);try{return await t()}finally{st.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,i.name)}}else{if(e===0)throw st.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new gl(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(st.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}ml();const xl={url:Eo,storageKey:To,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ao,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Mr(r,e,t){return await t()}const rt={};class _t{constructor(e){var t,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=_t.nextInstanceID,_t.nextInstanceID+=1,this.instanceID>0&&xe()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},xl),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new fl({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Xn(i.fetch),this.lock=i.lock||Mr,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:xe()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=pl:this.lock=Mr,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Qn()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ur(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Ur(this.memoryStorage)),xe()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=rt[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){rt[this.storageKey]=Object.assign(Object.assign({},rt[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=rt[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){rt[this.storageKey]=Object.assign(Object.assign({},rt[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Kn}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=zo(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),xe()&&this.detectSessionInUrl&&s!=="none"){const{data:i,error:a}=await this._getSessionFromURL(t,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),Fo(a)){const c=(e=a.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return R(t)?{error:t}:{error:new Yn("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,i;try{const a=await D(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:Ce}),{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(R(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,s,i;try{let a;if("email"in e){const{email:u,password:h,options:m}=e;let p=null,j=null;this.flowType==="pkce"&&([p,j]=await et(this.storage,this.storageKey)),a=await D(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:u,password:h,data:(t=m==null?void 0:m.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:p,code_challenge_method:j},xform:Ce})}else if("phone"in e){const{phone:u,password:h,options:m}=e;a=await D(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=m==null?void 0:m.data)!==null&&s!==void 0?s:{},channel:(i=m==null?void 0:m.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:Ce})}else throw new Ot("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(R(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:o,options:l}=e;t=await D(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Lr})}else if("phone"in e){const{phone:a,password:o,options:l}=e;t=await D(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Lr})}else throw new Ot("You must provide either an email or phone number and a password");const{data:s,error:i}=t;return i?{data:{user:null,session:null},error:i}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Ct}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:i})}catch(t){if(R(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,i,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,i,a,o,l,c,d,u,h,m,p;let j,x;if("message"in e)j=e.message,x=e.signature;else{const{chain:y,wallet:S,statement:b,options:w}=e;let E;if(xe())if(typeof S=="object")E=S;else{const P=window;if("solana"in P&&typeof P.solana=="object"&&("signIn"in P.solana&&typeof P.solana.signIn=="function"||"signMessage"in P.solana&&typeof P.solana.signMessage=="function"))E=P.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=S}const O=new URL((t=w==null?void 0:w.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in E&&E.signIn){const P=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),b?{statement:b}:null));let F;if(Array.isArray(P)&&P[0]&&typeof P[0]=="object")F=P[0];else if(P&&typeof P=="object"&&"signedMessage"in P&&"signature"in P)F=P;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in F&&"signature"in F&&(typeof F.signedMessage=="string"||F.signedMessage instanceof Uint8Array)&&F.signature instanceof Uint8Array)j=typeof F.signedMessage=="string"?F.signedMessage:new TextDecoder().decode(F.signedMessage),x=F.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");j=[`${O.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(i=(s=w==null?void 0:w.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((d=w==null?void 0:w.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((h=(u=w==null?void 0:w.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...w.signInWithSolana.resources.map(F=>`- ${F}`)]:[]].join(`
`);const P=await E.signMessage(new TextEncoder().encode(j),"utf8");if(!P||!(P instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=P}}try{const{data:y,error:S}=await D(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:j,signature:Vo(x)},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Ce});if(S)throw S;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new Ct}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:S})}catch(y){if(R(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(e){const t=await qe(this.storage,`${this.storageKey}-code-verifier`),[s,i]=(t??"").split("/");try{const{data:a,error:o}=await D(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Ce});if(await Fe(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Ct}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:i??null}),error:o})}catch(a){if(R(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:s,token:i,access_token:a,nonce:o}=e,l=await D(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:i,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Ce}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Ct}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(t){if(R(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,i,a,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await et(this.storage,this.storageKey));const{error:h}=await D(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:u}=await D(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=c==null?void 0:c.data)!==null&&i!==void 0?i:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new Ot("You must provide either an email or phone number.")}catch(l){if(R(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var t,s;try{let i,a;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:l}=await D(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:i,xform:Ce});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(R(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var t,s,i;try{let a=null,o=null;return this.flowType==="pkce"&&([a,o]=await et(this.storage,this.storageKey)),await D(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:ll})}catch(a){if(R(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Ie;const{error:i}=await D(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(R(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:i,options:a}=e,{error:o}=await D(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:i,options:a}=e,{data:o,error:l}=await D(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Ot("You must provide either an email or phone number and a type")}catch(t){if(R(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await qe(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<hs:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await qe(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=gs()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,d,u)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:e},error:null}}const{session:i,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await D(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:De}):await this._useSession(async t=>{var s,i,a;const{data:o,error:l}=t;if(l)throw l;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ie}:await D(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0,xform:De})})}catch(t){if(R(t))return Ro(t)&&(await this._removeSession(),await Fe(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:i,error:a}=s;if(a)throw a;if(!i.session)throw new Ie;const o=i.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await et(this.storage,this.storageKey));const{data:d,error:u}=await D(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:De});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(R(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ie;const t=Date.now()/1e3;let s=t,i=!0,a=null;const{payload:o}=ms(e.access_token);if(o.exp&&(s=o.exp,i=s<=t),i){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(R(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Ie;const{session:i,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(R(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!xe())throw new $t("No browser detected.");if(e.error||e.error_description||e.error_code)throw new $t(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Or("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new $t("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Or("No code detected.");const{data:b,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:i,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!a||!l||!o||!d)throw new $t("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let m=u+h;c&&(m=parseInt(c));const p=m-u;p*1e3<=ot&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const j=m-h;u-j>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",j,m,u):u-j<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",j,m,u);const{data:x,error:y}=await this._getUser(a);if(y)throw y;const S={provider_token:s,provider_refresh_token:i,access_token:a,expires_in:h,expires_at:m,refresh_token:o,token_type:d,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:S,redirectType:e.type},error:null}}catch(s){if(R(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await qe(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:i,error:a}=t;if(a)return{error:a};const o=(s=i.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(Po(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Fe(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Wo(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,i;try{const{data:{session:a},error:o}=t;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let s=null,i=null;this.flowType==="pkce"&&([s,i]=await et(this.storage,this.storageKey,!0));try{return await D(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(R(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(R(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:i}=await this._useSession(async a=>{var o,l,c,d,u;const{data:h,error:m}=a;if(m)throw m;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await D(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return xe()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(R(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,i;const{data:a,error:o}=t;if(o)throw o;return await D(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(R(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await Ko(async i=>(i>0&&await Go(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await D(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ce})),(i,a)=>{const o=200*Math.pow(2,i);return a&&fs(a)&&Date.now()+o-s<ot})}catch(s){if(this._debug(t,"error",s),R(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),xe()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const i=await qe(this.storage,this.storageKey);if(i&&this.userStorage){let o=await qe(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await lt(this.userStorage,this.storageKey+"-user",o)),i.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:gs()}else if(i&&!i.user&&!i.user){const o=await qe(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,await Fe(this.storage,this.storageKey+"-user"),await lt(this.storage,this.storageKey,i)):i.user=gs()}if(this._debug(s,"session from storage",i),!this._isValidSession(i)){this._debug(s,"session is not valid"),i!==null&&await this._removeSession();return}const a=((t=i.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<hs;if(this._debug(s,`session has${a?"":" not"} expired with margin of ${hs}s`),a){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),fs(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(i.access_token);!l&&(o!=null&&o.user)?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(s,"error",i),console.error(i);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Ie;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Xt;const{data:a,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!a.session)throw new Ie;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={session:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(i,"error",a),R(a)){const o={session:null,error:a};return fs(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,s=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),s=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&t.user&&await lt(this.userStorage,this.storageKey+"-user",{user:t.user});const i=Object.assign({},t);delete i.user;const a=Ir(i);await lt(this.storage,this.storageKey,a)}else{const i=Ir(t);await lt(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Fe(this.storage,this.storageKey),await Fe(this.storage,this.storageKey+"-code-verifier"),await Fe(this.storage,this.storageKey+"-user"),this.userStorage&&await Fe(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&xe()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ot);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((s.expires_at*1e3-e)/ot);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${ot}ms, refresh threshold is ${As} ticks`),i<=As&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ei)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!xe()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const i=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&i.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&i.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,o]=await et(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(s!=null&&s.queryParams){const a=new URLSearchParams(s.queryParams);i.push(a.toString())}return s!=null&&s.skipBrowserRedirect&&i.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:i,error:a}=t;return a?{data:null,error:a}:await D(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(R(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,i;const{data:a,error:o}=t;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:d}=await D(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(t){if(R(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:i,error:a}=t;if(a)return{data:null,error:a};const{data:o,error:l}=await D(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(t){if(R(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:i,error:a}=t;return a?{data:null,error:a}:await D(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(R(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],i=s.filter(o=>o.factor_type==="totp"&&o.status==="verified"),a=s.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:s,totp:i,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:i},error:a}=e;if(a)return{data:null,error:a};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=ms(i.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((s=(t=i.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(l=>l.kid===e);if(s)return s;const i=Date.now();if(s=this.jwks.keys.find(l=>l.kid===e),s&&this.jwks_cached_at+Oo>i)return s;const{data:a,error:o}=await D(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=i,s=a.keys.find(l=>l.kid===e),!s)?null:s}async getClaims(e,t={}){try{let s=e;if(!s){const{data:p,error:j}=await this.getSession();if(j||!p.session)return{data:null,error:j};s=p.session.access_token}const{header:i,payload:a,signature:o,raw:{header:l,payload:c}}=ms(s);t!=null&&t.allowExpired||tl(a.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!d){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:a,header:i,signature:o},error:null}}const u=sl(i.alg),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,Bo(`${l}.${c}`)))throw new $s("Invalid JWT signature");return{data:{claims:a,header:i,signature:o},error:null}}catch(s){if(R(s))return{data:null,error:s};throw s}}}_t.nextInstanceID=0;const yl=_t;class bl extends yl{constructor(e){super(e)}}var vl=function(r,e,t,s){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):i(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};class wl{constructor(e,t,s){var i,a,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const l=ko(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,u={db:xo,realtime:bo,auth:Object.assign(Object.assign({},yo),{storageKey:d}),global:po},h=So(s??{},u);this.storageKey=(i=h.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=h.global.headers)!==null&&a!==void 0?a:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(m,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=_o(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Ia(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new fo(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new ha(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return vl(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:i,storageKey:a,flowType:o,lock:l,debug:c},d,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new bl({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),d),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:i,flowType:o,lock:l,debug:c,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Xa(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const jl=(r,e,t)=>new wl(r,e,t);function _l(){if(typeof window<"u"||typeof process>"u")return!1;const r=process.version;if(r==null)return!1;const e=r.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}_l()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Nl="https://wzwrrgwxmrmczqszzspn.supabase.co",kl="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind6d3JyZ3d4bXJtY3pxc3p6c3BuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ5MDQ3OTIsImV4cCI6MjA3MDQ4MDc5Mn0.A70qpMVNMjYB4xi9tsCIdsdWxpQuZF4Ph9j4R-9Tz2U",ae=jl(Nl,kl),ti=C.createContext(void 0),we=()=>{const r=C.useContext(ti);if(r===void 0)throw new Error("useAuth must be used within an AuthProvider");return r},Sl=({children:r})=>{const[e,t]=C.useState(null),[s,i]=C.useState(null),[a,o]=C.useState(!0),[l,c]=C.useState(!1);C.useEffect(()=>{ae.auth.getSession().then(({data:{session:x}})=>{i(x),t((x==null?void 0:x.user)??null),x!=null&&x.user&&d(x.user.id),o(!1)});const{data:{subscription:j}}=ae.auth.onAuthStateChange(async(x,y)=>{i(y),t((y==null?void 0:y.user)??null),y!=null&&y.user?d(y.user.id):c(!1),o(!1)});return()=>j.unsubscribe()},[]);const d=async j=>{try{const{data:x,error:y}=await ae.from("user_profiles").select("is_admin").eq("id",j).single();!y&&x&&c(x.is_admin||!1)}catch(x){console.error("Error checking admin status:",x)}},p={user:e,session:s,loading:a,signUp:async(j,x,y)=>{const{data:S,error:b}=await ae.auth.signUp({email:j,password:x,options:{data:{full_name:y}}});return{data:S,error:b}},signIn:async(j,x)=>{const{data:y,error:S}=await ae.auth.signInWithPassword({email:j,password:x});return{data:y,error:S}},signOut:async()=>{const{error:j}=await ae.auth.signOut();if(j)throw j},isAdmin:l};return n.jsx(ti.Provider,{value:p,children:r})},Br=({children:r,requireAdmin:e=!1})=>{const{user:t,loading:s,isAdmin:i}=we(),a=_n();return s?n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):t?e&&!i?n.jsx(Dt,{to:"/dashboard",replace:!0}):n.jsx(n.Fragment,{children:r}):n.jsx(Dt,{to:"/login",state:{from:a},replace:!0})};var Et=r=>r.type==="checkbox",He=r=>r instanceof Date,oe=r=>r==null;const si=r=>typeof r=="object";var Y=r=>!oe(r)&&!Array.isArray(r)&&si(r)&&!He(r),El=r=>Y(r)&&r.target?Et(r.target)?r.target.checked:r.target.value:r,Tl=r=>r.substring(0,r.search(/\.\d+(\.|$)/))||r,Al=(r,e)=>r.has(Tl(e)),Cl=r=>{const e=r.constructor&&r.constructor.prototype;return Y(e)&&e.hasOwnProperty("isPrototypeOf")},Js=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function te(r){let e;const t=Array.isArray(r),s=typeof FileList<"u"?r instanceof FileList:!1;if(r instanceof Date)e=new Date(r);else if(!(Js&&(r instanceof Blob||s))&&(t||Y(r)))if(e=t?[]:Object.create(Object.getPrototypeOf(r)),!t&&!Cl(r))e=r;else for(const i in r)r.hasOwnProperty(i)&&(e[i]=te(r[i]));else return r;return e}var es=r=>/^\w*$/.test(r),Q=r=>r===void 0,Ys=r=>Array.isArray(r)?r.filter(Boolean):[],Zs=r=>Ys(r.replace(/["|']|\]/g,"").split(/\.|\[/)),T=(r,e,t)=>{if(!e||!Y(r))return t;const s=(es(e)?[e]:Zs(e)).reduce((i,a)=>oe(i)?i:i[a],r);return Q(s)||s===r?Q(r[e])?t:r[e]:s},_e=r=>typeof r=="boolean",q=(r,e,t)=>{let s=-1;const i=es(e)?[e]:Zs(e),a=i.length,o=a-1;for(;++s<a;){const l=i[s];let c=t;if(s!==o){const d=r[l];c=Y(d)||Array.isArray(d)?d:isNaN(+i[s+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;r[l]=c,r=r[l]}};const Vr={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},be={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Te={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},Ol=J.createContext(null);Ol.displayName="HookFormContext";var $l=(r,e,t,s=!0)=>{const i={defaultValues:e._defaultValues};for(const a in r)Object.defineProperty(i,a,{get:()=>{const o=a;return e._proxyFormState[o]!==be.all&&(e._proxyFormState[o]=!s||be.all),r[o]}});return i};const Pl=typeof window<"u"?J.useLayoutEffect:J.useEffect;var ke=r=>typeof r=="string",Rl=(r,e,t,s,i)=>ke(r)?(s&&e.watch.add(r),T(t,r,i)):Array.isArray(r)?r.map(a=>(s&&e.watch.add(a),T(t,a))):(s&&(e.watchAll=!0),t),Ps=r=>oe(r)||!si(r);function Le(r,e,t=new WeakSet){if(Ps(r)||Ps(e))return r===e;if(He(r)&&He(e))return r.getTime()===e.getTime();const s=Object.keys(r),i=Object.keys(e);if(s.length!==i.length)return!1;if(t.has(r)||t.has(e))return!0;t.add(r),t.add(e);for(const a of s){const o=r[a];if(!i.includes(a))return!1;if(a!=="ref"){const l=e[a];if(He(o)&&He(l)||Y(o)&&Y(l)||Array.isArray(o)&&Array.isArray(l)?!Le(o,l,t):o!==l)return!1}}return!0}var ri=(r,e,t,s,i)=>e?{...t[r],types:{...t[r]&&t[r].types?t[r].types:{},[s]:i||!0}}:{},wt=r=>Array.isArray(r)?r:[r],qr=()=>{let r=[];return{get observers(){return r},next:i=>{for(const a of r)a.next&&a.next(i)},subscribe:i=>(r.push(i),{unsubscribe:()=>{r=r.filter(a=>a!==i)}}),unsubscribe:()=>{r=[]}}},he=r=>Y(r)&&!Object.keys(r).length,Qs=r=>r.type==="file",ve=r=>typeof r=="function",Mt=r=>{if(!Js)return!1;const e=r?r.ownerDocument:0;return r instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},ni=r=>r.type==="select-multiple",Xs=r=>r.type==="radio",Fl=r=>Xs(r)||Et(r),xs=r=>Mt(r)&&r.isConnected;function Il(r,e){const t=e.slice(0,-1).length;let s=0;for(;s<t;)r=Q(r)?s++:r[e[s++]];return r}function Dl(r){for(const e in r)if(r.hasOwnProperty(e)&&!Q(r[e]))return!1;return!0}function Z(r,e){const t=Array.isArray(e)?e:es(e)?[e]:Zs(e),s=t.length===1?r:Il(r,t),i=t.length-1,a=t[i];return s&&delete s[a],i!==0&&(Y(s)&&he(s)||Array.isArray(s)&&Dl(s))&&Z(r,t.slice(0,-1)),r}var ii=r=>{for(const e in r)if(ve(r[e]))return!0;return!1};function Bt(r,e={}){const t=Array.isArray(r);if(Y(r)||t)for(const s in r)Array.isArray(r[s])||Y(r[s])&&!ii(r[s])?(e[s]=Array.isArray(r[s])?[]:{},Bt(r[s],e[s])):oe(r[s])||(e[s]=!0);return e}function ai(r,e,t){const s=Array.isArray(r);if(Y(r)||s)for(const i in r)Array.isArray(r[i])||Y(r[i])&&!ii(r[i])?Q(e)||Ps(t[i])?t[i]=Array.isArray(r[i])?Bt(r[i],[]):{...Bt(r[i])}:ai(r[i],oe(e)?{}:e[i],t[i]):t[i]=!Le(r[i],e[i]);return t}var gt=(r,e)=>ai(r,e,Bt(e));const Wr={value:!1,isValid:!1},zr={value:!0,isValid:!0};var oi=r=>{if(Array.isArray(r)){if(r.length>1){const e=r.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return r[0].checked&&!r[0].disabled?r[0].attributes&&!Q(r[0].attributes.value)?Q(r[0].value)||r[0].value===""?zr:{value:r[0].value,isValid:!0}:zr:Wr}return Wr},li=(r,{valueAsNumber:e,valueAsDate:t,setValueAs:s})=>Q(r)?r:e?r===""?NaN:r&&+r:t&&ke(r)?new Date(r):s?s(r):r;const Hr={isValid:!1,value:null};var ci=r=>Array.isArray(r)?r.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,Hr):Hr;function Gr(r){const e=r.ref;return Qs(e)?e.files:Xs(e)?ci(r.refs).value:ni(e)?[...e.selectedOptions].map(({value:t})=>t):Et(e)?oi(r.refs).value:li(Q(e.value)?r.ref.value:e.value,r)}var Ll=(r,e,t,s)=>{const i={};for(const a of r){const o=T(e,a);o&&q(i,a,o._f)}return{criteriaMode:t,names:[...r],fields:i,shouldUseNativeValidation:s}},Vt=r=>r instanceof RegExp,pt=r=>Q(r)?r:Vt(r)?r.source:Y(r)?Vt(r.value)?r.value.source:r.value:r,Kr=r=>({isOnSubmit:!r||r===be.onSubmit,isOnBlur:r===be.onBlur,isOnChange:r===be.onChange,isOnAll:r===be.all,isOnTouch:r===be.onTouched});const Jr="AsyncFunction";var Ul=r=>!!r&&!!r.validate&&!!(ve(r.validate)&&r.validate.constructor.name===Jr||Y(r.validate)&&Object.values(r.validate).find(e=>e.constructor.name===Jr)),Ml=r=>r.mount&&(r.required||r.min||r.max||r.maxLength||r.minLength||r.pattern||r.validate),Yr=(r,e,t)=>!t&&(e.watchAll||e.watch.has(r)||[...e.watch].some(s=>r.startsWith(s)&&/^\.\w+/.test(r.slice(s.length))));const jt=(r,e,t,s)=>{for(const i of t||Object.keys(r)){const a=T(r,i);if(a){const{_f:o,...l}=a;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],i)&&!s)return!0;if(o.ref&&e(o.ref,o.name)&&!s)return!0;if(jt(l,e))break}else if(Y(l)&&jt(l,e))break}}};function Zr(r,e,t){const s=T(r,t);if(s||es(t))return{error:s,name:t};const i=t.split(".");for(;i.length;){const a=i.join("."),o=T(e,a),l=T(r,a);if(o&&!Array.isArray(o)&&t!==a)return{name:t};if(l&&l.type)return{name:a,error:l};if(l&&l.root&&l.root.type)return{name:`${a}.root`,error:l.root};i.pop()}return{name:t}}var Bl=(r,e,t,s)=>{t(r);const{name:i,...a}=r;return he(a)||Object.keys(a).length>=Object.keys(e).length||Object.keys(a).find(o=>e[o]===(!s||be.all))},Vl=(r,e,t)=>!r||!e||r===e||wt(r).some(s=>s&&(t?s===e:s.startsWith(e)||e.startsWith(s))),ql=(r,e,t,s,i)=>i.isOnAll?!1:!t&&i.isOnTouch?!(e||r):(t?s.isOnBlur:i.isOnBlur)?!r:(t?s.isOnChange:i.isOnChange)?r:!0,Wl=(r,e)=>!Ys(T(r,e)).length&&Z(r,e),zl=(r,e,t)=>{const s=wt(T(r,t));return q(s,"root",e[t]),q(r,t,s),r},Rt=r=>ke(r);function Qr(r,e,t="validate"){if(Rt(r)||Array.isArray(r)&&r.every(Rt)||_e(r)&&!r)return{type:t,message:Rt(r)?r:"",ref:e}}var nt=r=>Y(r)&&!Vt(r)?r:{value:r,message:""},Xr=async(r,e,t,s,i,a)=>{const{ref:o,refs:l,required:c,maxLength:d,minLength:u,min:h,max:m,pattern:p,validate:j,name:x,valueAsNumber:y,mount:S}=r._f,b=T(t,x);if(!S||e.has(x))return{};const w=l?l[0]:o,E=I=>{i&&w.reportValidity&&(w.setCustomValidity(_e(I)?"":I||""),w.reportValidity())},O={},P=Xs(o),F=Et(o),Ee=P||F,G=(y||Qs(o))&&Q(o.value)&&Q(b)||Mt(o)&&o.value===""||b===""||Array.isArray(b)&&!b.length,re=ri.bind(null,x,s,O),M=(I,L,H,ee=Te.maxLength,ne=Te.minLength)=>{const A=I?L:H;O[x]={type:I?ee:ne,message:A,ref:o,...re(I?ee:ne,A)}};if(a?!Array.isArray(b)||!b.length:c&&(!Ee&&(G||oe(b))||_e(b)&&!b||F&&!oi(l).isValid||P&&!ci(l).isValid)){const{value:I,message:L}=Rt(c)?{value:!!c,message:c}:nt(c);if(I&&(O[x]={type:Te.required,message:L,ref:w,...re(Te.required,L)},!s))return E(L),O}if(!G&&(!oe(h)||!oe(m))){let I,L;const H=nt(m),ee=nt(h);if(!oe(b)&&!isNaN(b)){const ne=o.valueAsNumber||b&&+b;oe(H.value)||(I=ne>H.value),oe(ee.value)||(L=ne<ee.value)}else{const ne=o.valueAsDate||new Date(b),A=me=>new Date(new Date().toDateString()+" "+me),V=o.type=="time",ie=o.type=="week";ke(H.value)&&b&&(I=V?A(b)>A(H.value):ie?b>H.value:ne>new Date(H.value)),ke(ee.value)&&b&&(L=V?A(b)<A(ee.value):ie?b<ee.value:ne<new Date(ee.value))}if((I||L)&&(M(!!I,H.message,ee.message,Te.max,Te.min),!s))return E(O[x].message),O}if((d||u)&&!G&&(ke(b)||a&&Array.isArray(b))){const I=nt(d),L=nt(u),H=!oe(I.value)&&b.length>+I.value,ee=!oe(L.value)&&b.length<+L.value;if((H||ee)&&(M(H,I.message,L.message),!s))return E(O[x].message),O}if(p&&!G&&ke(b)){const{value:I,message:L}=nt(p);if(Vt(I)&&!b.match(I)&&(O[x]={type:Te.pattern,message:L,ref:o,...re(Te.pattern,L)},!s))return E(L),O}if(j){if(ve(j)){const I=await j(b,t),L=Qr(I,w);if(L&&(O[x]={...L,...re(Te.validate,L.message)},!s))return E(L.message),O}else if(Y(j)){let I={};for(const L in j){if(!he(I)&&!s)break;const H=Qr(await j[L](b,t),w,L);H&&(I={...H,...re(L,H.message)},E(H.message),s&&(O[x]=I))}if(!he(I)&&(O[x]={ref:w,...I},!s))return O}}return E(!0),O};const Hl={mode:be.onSubmit,reValidateMode:be.onChange,shouldFocusError:!0};function Gl(r={}){let e={...Hl,...r},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:ve(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},s={},i=Y(e.defaultValues)||Y(e.values)?te(e.defaultValues||e.values)||{}:{},a=e.shouldUnregister?{}:te(i),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,d=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let h={...u};const m={array:qr(),state:qr()},p=e.criteriaMode===be.all,j=f=>g=>{clearTimeout(d),d=setTimeout(f,g)},x=async f=>{if(!e.disabled&&(u.isValid||h.isValid||f)){const g=e.resolver?he((await F()).errors):await G(s,!0);g!==t.isValid&&m.state.next({isValid:g})}},y=(f,g)=>{!e.disabled&&(u.isValidating||u.validatingFields||h.isValidating||h.validatingFields)&&((f||Array.from(l.mount)).forEach(v=>{v&&(g?q(t.validatingFields,v,g):Z(t.validatingFields,v))}),m.state.next({validatingFields:t.validatingFields,isValidating:!he(t.validatingFields)}))},S=(f,g=[],v,k,N=!0,_=!0)=>{if(k&&v&&!e.disabled){if(o.action=!0,_&&Array.isArray(T(s,f))){const $=v(T(s,f),k.argA,k.argB);N&&q(s,f,$)}if(_&&Array.isArray(T(t.errors,f))){const $=v(T(t.errors,f),k.argA,k.argB);N&&q(t.errors,f,$),Wl(t.errors,f)}if((u.touchedFields||h.touchedFields)&&_&&Array.isArray(T(t.touchedFields,f))){const $=v(T(t.touchedFields,f),k.argA,k.argB);N&&q(t.touchedFields,f,$)}(u.dirtyFields||h.dirtyFields)&&(t.dirtyFields=gt(i,a)),m.state.next({name:f,isDirty:M(f,g),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else q(a,f,g)},b=(f,g)=>{q(t.errors,f,g),m.state.next({errors:t.errors})},w=f=>{t.errors=f,m.state.next({errors:t.errors,isValid:!1})},E=(f,g,v,k)=>{const N=T(s,f);if(N){const _=T(a,f,Q(v)?T(i,f):v);Q(_)||k&&k.defaultChecked||g?q(a,f,g?_:Gr(N._f)):H(f,_),o.mount&&x()}},O=(f,g,v,k,N)=>{let _=!1,$=!1;const B={name:f};if(!e.disabled){if(!v||k){(u.isDirty||h.isDirty)&&($=t.isDirty,t.isDirty=B.isDirty=M(),_=$!==B.isDirty);const W=Le(T(i,f),g);$=!!T(t.dirtyFields,f),W?Z(t.dirtyFields,f):q(t.dirtyFields,f,!0),B.dirtyFields=t.dirtyFields,_=_||(u.dirtyFields||h.dirtyFields)&&$!==!W}if(v){const W=T(t.touchedFields,f);W||(q(t.touchedFields,f,v),B.touchedFields=t.touchedFields,_=_||(u.touchedFields||h.touchedFields)&&W!==v)}_&&N&&m.state.next(B)}return _?B:{}},P=(f,g,v,k)=>{const N=T(t.errors,f),_=(u.isValid||h.isValid)&&_e(g)&&t.isValid!==g;if(e.delayError&&v?(c=j(()=>b(f,v)),c(e.delayError)):(clearTimeout(d),c=null,v?q(t.errors,f,v):Z(t.errors,f)),(v?!Le(N,v):N)||!he(k)||_){const $={...k,..._&&_e(g)?{isValid:g}:{},errors:t.errors,name:f};t={...t,...$},m.state.next($)}},F=async f=>{y(f,!0);const g=await e.resolver(a,e.context,Ll(f||l.mount,s,e.criteriaMode,e.shouldUseNativeValidation));return y(f),g},Ee=async f=>{const{errors:g}=await F(f);if(f)for(const v of f){const k=T(g,v);k?q(t.errors,v,k):Z(t.errors,v)}else t.errors=g;return g},G=async(f,g,v={valid:!0})=>{for(const k in f){const N=f[k];if(N){const{_f:_,...$}=N;if(_){const B=l.array.has(_.name),W=N._f&&Ul(N._f);W&&u.validatingFields&&y([k],!0);const ge=await Xr(N,l.disabled,a,p,e.shouldUseNativeValidation&&!g,B);if(W&&u.validatingFields&&y([k]),ge[_.name]&&(v.valid=!1,g))break;!g&&(T(ge,_.name)?B?zl(t.errors,ge,_.name):q(t.errors,_.name,ge[_.name]):Z(t.errors,_.name))}!he($)&&await G($,g,v)}}return v.valid},re=()=>{for(const f of l.unMount){const g=T(s,f);g&&(g._f.refs?g._f.refs.every(v=>!xs(v)):!xs(g._f.ref))&&is(f)}l.unMount=new Set},M=(f,g)=>!e.disabled&&(f&&g&&q(a,f,g),!Le(me(),i)),I=(f,g,v)=>Rl(f,l,{...o.mount?a:Q(g)?i:ke(f)?{[f]:g}:g},v,g),L=f=>Ys(T(o.mount?a:i,f,e.shouldUnregister?T(i,f,[]):[])),H=(f,g,v={})=>{const k=T(s,f);let N=g;if(k){const _=k._f;_&&(!_.disabled&&q(a,f,li(g,_)),N=Mt(_.ref)&&oe(g)?"":g,ni(_.ref)?[..._.ref.options].forEach($=>$.selected=N.includes($.value)):_.refs?Et(_.ref)?_.refs.forEach($=>{(!$.defaultChecked||!$.disabled)&&(Array.isArray(N)?$.checked=!!N.find(B=>B===$.value):$.checked=N===$.value||!!N)}):_.refs.forEach($=>$.checked=$.value===N):Qs(_.ref)?_.ref.value="":(_.ref.value=N,_.ref.type||m.state.next({name:f,values:te(a)})))}(v.shouldDirty||v.shouldTouch)&&O(f,N,v.shouldTouch,v.shouldDirty,!0),v.shouldValidate&&ie(f)},ee=(f,g,v)=>{for(const k in g){if(!g.hasOwnProperty(k))return;const N=g[k],_=f+"."+k,$=T(s,_);(l.array.has(f)||Y(N)||$&&!$._f)&&!He(N)?ee(_,N,v):H(_,N,v)}},ne=(f,g,v={})=>{const k=T(s,f),N=l.array.has(f),_=te(g);q(a,f,_),N?(m.array.next({name:f,values:te(a)}),(u.isDirty||u.dirtyFields||h.isDirty||h.dirtyFields)&&v.shouldDirty&&m.state.next({name:f,dirtyFields:gt(i,a),isDirty:M(f,_)})):k&&!k._f&&!oe(_)?ee(f,_,v):H(f,_,v),Yr(f,l)&&m.state.next({...t,name:f}),m.state.next({name:o.mount?f:void 0,values:te(a)})},A=async f=>{o.mount=!0;const g=f.target;let v=g.name,k=!0;const N=T(s,v),_=W=>{k=Number.isNaN(W)||He(W)&&isNaN(W.getTime())||Le(W,T(a,v,W))},$=Kr(e.mode),B=Kr(e.reValidateMode);if(N){let W,ge;const Tt=g.type?Gr(N._f):El(f),Re=f.type===Vr.BLUR||f.type===Vr.FOCUS_OUT,Ui=!Ml(N._f)&&!e.resolver&&!T(t.errors,v)&&!N._f.deps||ql(Re,T(t.touchedFields,v),t.isSubmitted,B,$),ls=Yr(v,l,Re);q(a,v,Tt),Re?(!g||!g.readOnly)&&(N._f.onBlur&&N._f.onBlur(f),c&&c(0)):N._f.onChange&&N._f.onChange(f);const cs=O(v,Tt,Re),Mi=!he(cs)||ls;if(!Re&&m.state.next({name:v,type:f.type,values:te(a)}),Ui)return(u.isValid||h.isValid)&&(e.mode==="onBlur"?Re&&x():Re||x()),Mi&&m.state.next({name:v,...ls?{}:cs});if(!Re&&ls&&m.state.next({...t}),e.resolver){const{errors:vr}=await F([v]);if(_(Tt),k){const Bi=Zr(t.errors,s,v),wr=Zr(vr,s,Bi.name||v);W=wr.error,v=wr.name,ge=he(vr)}}else y([v],!0),W=(await Xr(N,l.disabled,a,p,e.shouldUseNativeValidation))[v],y([v]),_(Tt),k&&(W?ge=!1:(u.isValid||h.isValid)&&(ge=await G(s,!0)));k&&(N._f.deps&&ie(N._f.deps),P(v,ge,W,cs))}},V=(f,g)=>{if(T(t.errors,g)&&f.focus)return f.focus(),1},ie=async(f,g={})=>{let v,k;const N=wt(f);if(e.resolver){const _=await Ee(Q(f)?f:N);v=he(_),k=f?!N.some($=>T(_,$)):v}else f?(k=(await Promise.all(N.map(async _=>{const $=T(s,_);return await G($&&$._f?{[_]:$}:$)}))).every(Boolean),!(!k&&!t.isValid)&&x()):k=v=await G(s);return m.state.next({...!ke(f)||(u.isValid||h.isValid)&&v!==t.isValid?{}:{name:f},...e.resolver||!f?{isValid:v}:{},errors:t.errors}),g.shouldFocus&&!k&&jt(s,V,f?N:l.mount),k},me=f=>{const g={...o.mount?a:i};return Q(f)?g:ke(f)?T(g,f):f.map(v=>T(g,v))},K=(f,g)=>({invalid:!!T((g||t).errors,f),isDirty:!!T((g||t).dirtyFields,f),error:T((g||t).errors,f),isValidating:!!T(t.validatingFields,f),isTouched:!!T((g||t).touchedFields,f)}),$i=f=>{f&&wt(f).forEach(g=>Z(t.errors,g)),m.state.next({errors:f?t.errors:{}})},fr=(f,g,v)=>{const k=(T(s,f,{_f:{}})._f||{}).ref,N=T(t.errors,f)||{},{ref:_,message:$,type:B,...W}=N;q(t.errors,f,{...W,...g,ref:k}),m.state.next({name:f,errors:t.errors,isValid:!1}),v&&v.shouldFocus&&k&&k.focus&&k.focus()},Pi=(f,g)=>ve(f)?m.state.subscribe({next:v=>"values"in v&&f(I(void 0,g),v)}):I(f,g,!0),mr=f=>m.state.subscribe({next:g=>{Vl(f.name,g.name,f.exact)&&Bl(g,f.formState||u,Li,f.reRenderRoot)&&f.callback({values:{...a},...t,...g,defaultValues:i})}}).unsubscribe,Ri=f=>(o.mount=!0,h={...h,...f.formState},mr({...f,formState:h})),is=(f,g={})=>{for(const v of f?wt(f):l.mount)l.mount.delete(v),l.array.delete(v),g.keepValue||(Z(s,v),Z(a,v)),!g.keepError&&Z(t.errors,v),!g.keepDirty&&Z(t.dirtyFields,v),!g.keepTouched&&Z(t.touchedFields,v),!g.keepIsValidating&&Z(t.validatingFields,v),!e.shouldUnregister&&!g.keepDefaultValue&&Z(i,v);m.state.next({values:te(a)}),m.state.next({...t,...g.keepDirty?{isDirty:M()}:{}}),!g.keepIsValid&&x()},gr=({disabled:f,name:g})=>{(_e(f)&&o.mount||f||l.disabled.has(g))&&(f?l.disabled.add(g):l.disabled.delete(g))},as=(f,g={})=>{let v=T(s,f);const k=_e(g.disabled)||_e(e.disabled);return q(s,f,{...v||{},_f:{...v&&v._f?v._f:{ref:{name:f}},name:f,mount:!0,...g}}),l.mount.add(f),v?gr({disabled:_e(g.disabled)?g.disabled:e.disabled,name:f}):E(f,!0,g.value),{...k?{disabled:g.disabled||e.disabled}:{},...e.progressive?{required:!!g.required,min:pt(g.min),max:pt(g.max),minLength:pt(g.minLength),maxLength:pt(g.maxLength),pattern:pt(g.pattern)}:{},name:f,onChange:A,onBlur:A,ref:N=>{if(N){as(f,g),v=T(s,f);const _=Q(N.value)&&N.querySelectorAll&&N.querySelectorAll("input,select,textarea")[0]||N,$=Fl(_),B=v._f.refs||[];if($?B.find(W=>W===_):_===v._f.ref)return;q(s,f,{_f:{...v._f,...$?{refs:[...B.filter(xs),_,...Array.isArray(T(i,f))?[{}]:[]],ref:{type:_.type,name:f}}:{ref:_}}}),E(f,!1,void 0,_)}else v=T(s,f,{}),v._f&&(v._f.mount=!1),(e.shouldUnregister||g.shouldUnregister)&&!(Al(l.array,f)&&o.action)&&l.unMount.add(f)}}},os=()=>e.shouldFocusError&&jt(s,V,l.mount),Fi=f=>{_e(f)&&(m.state.next({disabled:f}),jt(s,(g,v)=>{const k=T(s,v);k&&(g.disabled=k._f.disabled||f,Array.isArray(k._f.refs)&&k._f.refs.forEach(N=>{N.disabled=k._f.disabled||f}))},0,!1))},pr=(f,g)=>async v=>{let k;v&&(v.preventDefault&&v.preventDefault(),v.persist&&v.persist());let N=te(a);if(m.state.next({isSubmitting:!0}),e.resolver){const{errors:_,values:$}=await F();t.errors=_,N=te($)}else await G(s);if(l.disabled.size)for(const _ of l.disabled)Z(N,_);if(Z(t.errors,"root"),he(t.errors)){m.state.next({errors:{}});try{await f(N,v)}catch(_){k=_}}else g&&await g({...t.errors},v),os(),setTimeout(os);if(m.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:he(t.errors)&&!k,submitCount:t.submitCount+1,errors:t.errors}),k)throw k},Ii=(f,g={})=>{T(s,f)&&(Q(g.defaultValue)?ne(f,te(T(i,f))):(ne(f,g.defaultValue),q(i,f,te(g.defaultValue))),g.keepTouched||Z(t.touchedFields,f),g.keepDirty||(Z(t.dirtyFields,f),t.isDirty=g.defaultValue?M(f,te(T(i,f))):M()),g.keepError||(Z(t.errors,f),u.isValid&&x()),m.state.next({...t}))},xr=(f,g={})=>{const v=f?te(f):i,k=te(v),N=he(f),_=N?i:k;if(g.keepDefaultValues||(i=v),!g.keepValues){if(g.keepDirtyValues){const $=new Set([...l.mount,...Object.keys(gt(i,a))]);for(const B of Array.from($))T(t.dirtyFields,B)?q(_,B,T(a,B)):ne(B,T(_,B))}else{if(Js&&Q(f))for(const $ of l.mount){const B=T(s,$);if(B&&B._f){const W=Array.isArray(B._f.refs)?B._f.refs[0]:B._f.ref;if(Mt(W)){const ge=W.closest("form");if(ge){ge.reset();break}}}}if(g.keepFieldsRef)for(const $ of l.mount)ne($,T(_,$));else s={}}a=e.shouldUnregister?g.keepDefaultValues?te(i):{}:te(_),m.array.next({values:{..._}}),m.state.next({values:{..._}})}l={mount:g.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!u.isValid||!!g.keepIsValid||!!g.keepDirtyValues,o.watch=!!e.shouldUnregister,m.state.next({submitCount:g.keepSubmitCount?t.submitCount:0,isDirty:N?!1:g.keepDirty?t.isDirty:!!(g.keepDefaultValues&&!Le(f,i)),isSubmitted:g.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:N?{}:g.keepDirtyValues?g.keepDefaultValues&&a?gt(i,a):t.dirtyFields:g.keepDefaultValues&&f?gt(i,f):g.keepDirty?t.dirtyFields:{},touchedFields:g.keepTouched?t.touchedFields:{},errors:g.keepErrors?t.errors:{},isSubmitSuccessful:g.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:i})},yr=(f,g)=>xr(ve(f)?f(a):f,g),Di=(f,g={})=>{const v=T(s,f),k=v&&v._f;if(k){const N=k.refs?k.refs[0]:k.ref;N.focus&&(N.focus(),g.shouldSelect&&ve(N.select)&&N.select())}},Li=f=>{t={...t,...f}},br={control:{register:as,unregister:is,getFieldState:K,handleSubmit:pr,setError:fr,_subscribe:mr,_runSchema:F,_focusError:os,_getWatch:I,_getDirty:M,_setValid:x,_setFieldArray:S,_setDisabledField:gr,_setErrors:w,_getFieldArray:L,_reset:xr,_resetDefaultValues:()=>ve(e.defaultValues)&&e.defaultValues().then(f=>{yr(f,e.resetOptions),m.state.next({isLoading:!1})}),_removeUnmounted:re,_disableForm:Fi,_subjects:m,_proxyFormState:u,get _fields(){return s},get _formValues(){return a},get _state(){return o},set _state(f){o=f},get _defaultValues(){return i},get _names(){return l},set _names(f){l=f},get _formState(){return t},get _options(){return e},set _options(f){e={...e,...f}}},subscribe:Ri,trigger:ie,register:as,handleSubmit:pr,watch:Pi,setValue:ne,getValues:me,reset:yr,resetField:Ii,clearErrors:$i,unregister:is,setError:fr,setFocus:Di,getFieldState:K};return{...br,formControl:br}}function di(r={}){const e=J.useRef(void 0),t=J.useRef(void 0),[s,i]=J.useState({isDirty:!1,isValidating:!1,isLoading:ve(r.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1,isReady:!1,defaultValues:ve(r.defaultValues)?void 0:r.defaultValues});if(!e.current)if(r.formControl)e.current={...r.formControl,formState:s},r.defaultValues&&!ve(r.defaultValues)&&r.formControl.reset(r.defaultValues,r.resetOptions);else{const{formControl:o,...l}=Gl(r);e.current={...l,formState:s}}const a=e.current.control;return a._options=r,Pl(()=>{const o=a._subscribe({formState:a._proxyFormState,callback:()=>i({...a._formState}),reRenderRoot:!0});return i(l=>({...l,isReady:!0})),a._formState.isReady=!0,o},[a]),J.useEffect(()=>a._disableForm(r.disabled),[a,r.disabled]),J.useEffect(()=>{r.mode&&(a._options.mode=r.mode),r.reValidateMode&&(a._options.reValidateMode=r.reValidateMode)},[a,r.mode,r.reValidateMode]),J.useEffect(()=>{r.errors&&(a._setErrors(r.errors),a._focusError())},[a,r.errors]),J.useEffect(()=>{r.shouldUnregister&&a._subjects.state.next({values:a._getWatch()})},[a,r.shouldUnregister]),J.useEffect(()=>{if(a._proxyFormState.isDirty){const o=a._getDirty();o!==s.isDirty&&a._subjects.state.next({isDirty:o})}},[a,s.isDirty]),J.useEffect(()=>{r.values&&!Le(r.values,t.current)?(a._reset(r.values,{keepFieldsRef:!0,...a._options.resetOptions}),t.current=r.values,i(o=>({...o}))):a._resetDefaultValues()},[a,r.values]),J.useEffect(()=>{a._state.mount||(a._setValid(),a._state.mount=!0),a._state.watch&&(a._state.watch=!1,a._subjects.state.next({...a._formState})),a._removeUnmounted()}),e.current.formState=$l(s,a),e.current}const en=(r,e,t)=>{if(r&&"reportValidity"in r){const s=T(t,e);r.setCustomValidity(s&&s.message||""),r.reportValidity()}},ui=(r,e)=>{for(const t in e.fields){const s=e.fields[t];s&&s.ref&&"reportValidity"in s.ref?en(s.ref,t,r):s&&s.refs&&s.refs.forEach(i=>en(i,t,r))}},Kl=(r,e)=>{e.shouldUseNativeValidation&&ui(r,e);const t={};for(const s in r){const i=T(e.fields,s),a=Object.assign(r[s]||{},{ref:i&&i.ref});if(Jl(e.names||Object.keys(r),s)){const o=Object.assign({},T(t,s));q(o,"root",a),q(t,s,o)}else q(t,s,a)}return t},Jl=(r,e)=>{const t=tn(e);return r.some(s=>tn(s).match(`^${t}\\.\\d+`))};function tn(r){return r.replace(/\]|\[/g,"")}function hi(r,e,t){return t===void 0&&(t={}),function(s,i,a){try{return Promise.resolve(function(o,l){try{var c=(e!=null&&e.context,Promise.resolve(r[t.mode==="sync"?"validateSync":"validate"](s,Object.assign({abortEarly:!1},e,{context:i}))).then(function(d){return a.shouldUseNativeValidation&&ui({},a),{values:t.raw?Object.assign({},s):d,errors:{}}}))}catch(d){return l(d)}return c&&c.then?c.then(void 0,l):c}(0,function(o){if(!o.inner)throw o;return{values:{},errors:Kl((l=o,c=!a.shouldUseNativeValidation&&a.criteriaMode==="all",(l.inner||[]).reduce(function(d,u){if(d[u.path]||(d[u.path]={message:u.message,type:u.type}),c){var h=d[u.path].types,m=h&&h[u.type];d[u.path]=ri(u.path,c,d,u.type,m?[].concat(m,u.message):u.message)}return d},{})),a)};var l,c}))}catch(o){return Promise.reject(o)}}}function Qe(r){this._maxSize=r,this.clear()}Qe.prototype.clear=function(){this._size=0,this._values=Object.create(null)};Qe.prototype.get=function(r){return this._values[r]};Qe.prototype.set=function(r,e){return this._size>=this._maxSize&&this.clear(),r in this._values||this._size++,this._values[r]=e};var Yl=/[^.^\]^[]+|(?=\[\]|\.\.)/g,fi=/^\d+$/,Zl=/^\d/,Ql=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,Xl=/^\s*(['"]?)(.*?)(\1)\s*$/,er=512,sn=new Qe(er),rn=new Qe(er),nn=new Qe(er),Je={Cache:Qe,split:Rs,normalizePath:ys,setter:function(r){var e=ys(r);return rn.get(r)||rn.set(r,function(s,i){for(var a=0,o=e.length,l=s;a<o-1;){var c=e[a];if(c==="__proto__"||c==="constructor"||c==="prototype")return s;l=l[e[a++]]}l[e[a]]=i})},getter:function(r,e){var t=ys(r);return nn.get(r)||nn.set(r,function(i){for(var a=0,o=t.length;a<o;)if(i!=null||!e)i=i[t[a++]];else return;return i})},join:function(r){return r.reduce(function(e,t){return e+(tr(t)||fi.test(t)?"["+t+"]":(e?".":"")+t)},"")},forEach:function(r,e,t){ec(Array.isArray(r)?r:Rs(r),e,t)}};function ys(r){return sn.get(r)||sn.set(r,Rs(r).map(function(e){return e.replace(Xl,"$2")}))}function Rs(r){return r.match(Yl)||[""]}function ec(r,e,t){var s=r.length,i,a,o,l;for(a=0;a<s;a++)i=r[a],i&&(rc(i)&&(i='"'+i+'"'),l=tr(i),o=!l&&/^\d+$/.test(i),e.call(t,i,l,o,a,r))}function tr(r){return typeof r=="string"&&r&&["'",'"'].indexOf(r.charAt(0))!==-1}function tc(r){return r.match(Zl)&&!r.match(fi)}function sc(r){return Ql.test(r)}function rc(r){return!tr(r)&&(tc(r)||sc(r))}const nc=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,ts=r=>r.match(nc)||[],ss=r=>r[0].toUpperCase()+r.slice(1),sr=(r,e)=>ts(r).join(e).toLowerCase(),mi=r=>ts(r).reduce((e,t)=>`${e}${e?t[0].toUpperCase()+t.slice(1).toLowerCase():t.toLowerCase()}`,""),ic=r=>ss(mi(r)),ac=r=>sr(r,"_"),oc=r=>sr(r,"-"),lc=r=>ss(sr(r," ")),cc=r=>ts(r).map(ss).join(" ");var bs={words:ts,upperFirst:ss,camelCase:mi,pascalCase:ic,snakeCase:ac,kebabCase:oc,sentenceCase:lc,titleCase:cc},rr={exports:{}};rr.exports=function(r){return gi(dc(r),r)};rr.exports.array=gi;function gi(r,e){var t=r.length,s=new Array(t),i={},a=t,o=uc(e),l=hc(r);for(e.forEach(function(d){if(!l.has(d[0])||!l.has(d[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});a--;)i[a]||c(r[a],a,new Set);return s;function c(d,u,h){if(h.has(d)){var m;try{m=", node was:"+JSON.stringify(d)}catch{m=""}throw new Error("Cyclic dependency"+m)}if(!l.has(d))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(d));if(!i[u]){i[u]=!0;var p=o.get(d)||new Set;if(p=Array.from(p),u=p.length){h.add(d);do{var j=p[--u];c(j,l.get(j),h)}while(u);h.delete(d)}s[--t]=d}}}function dc(r){for(var e=new Set,t=0,s=r.length;t<s;t++){var i=r[t];e.add(i[0]),e.add(i[1])}return Array.from(e)}function uc(r){for(var e=new Map,t=0,s=r.length;t<s;t++){var i=r[t];e.has(i[0])||e.set(i[0],new Set),e.has(i[1])||e.set(i[1],new Set),e.get(i[0]).add(i[1])}return e}function hc(r){for(var e=new Map,t=0,s=r.length;t<s;t++)e.set(r[t],t);return e}var fc=rr.exports;const mc=Wi(fc),gc=Object.prototype.toString,pc=Error.prototype.toString,xc=RegExp.prototype.toString,yc=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",bc=/^Symbol\((.*)\)(.*)$/;function vc(r){return r!=+r?"NaN":r===0&&1/r<0?"-0":""+r}function an(r,e=!1){if(r==null||r===!0||r===!1)return""+r;const t=typeof r;if(t==="number")return vc(r);if(t==="string")return e?`"${r}"`:r;if(t==="function")return"[Function "+(r.name||"anonymous")+"]";if(t==="symbol")return yc.call(r).replace(bc,"Symbol($1)");const s=gc.call(r).slice(8,-1);return s==="Date"?isNaN(r.getTime())?""+r:r.toISOString(r):s==="Error"||r instanceof Error?"["+pc.call(r)+"]":s==="RegExp"?xc.call(r):null}function Ue(r,e){let t=an(r,e);return t!==null?t:JSON.stringify(r,function(s,i){let a=an(this[s],e);return a!==null?a:i},2)}function pi(r){return r==null?[]:[].concat(r)}let xi,yi,bi,wc=/\$\{\s*(\w+)\s*\}/g;xi=Symbol.toStringTag;class on{constructor(e,t,s,i){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[xi]="Error",this.name="ValidationError",this.value=t,this.path=s,this.type=i,this.errors=[],this.inner=[],pi(e).forEach(a=>{if(le.isError(a)){this.errors.push(...a.errors);const o=a.inner.length?a.inner:[a];this.inner.push(...o)}else this.errors.push(a)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}yi=Symbol.hasInstance;bi=Symbol.toStringTag;class le extends Error{static formatError(e,t){const s=t.label||t.path||"this";return t=Object.assign({},t,{path:s,originalPath:t.path}),typeof e=="string"?e.replace(wc,(i,a)=>Ue(t[a])):typeof e=="function"?e(t):e}static isError(e){return e&&e.name==="ValidationError"}constructor(e,t,s,i,a){const o=new on(e,t,s,i);if(a)return o;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[bi]="Error",this.name=o.name,this.message=o.message,this.type=o.type,this.value=o.value,this.path=o.path,this.errors=o.errors,this.inner=o.inner,Error.captureStackTrace&&Error.captureStackTrace(this,le)}static[yi](e){return on[Symbol.hasInstance](e)||super[Symbol.hasInstance](e)}}let Ne={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:r,type:e,value:t,originalValue:s})=>{const i=s!=null&&s!==t?` (cast from the value \`${Ue(s,!0)}\`).`:".";return e!=="mixed"?`${r} must be a \`${e}\` type, but the final value was: \`${Ue(t,!0)}\``+i:`${r} must match the configured type. The validated value was: \`${Ue(t,!0)}\``+i}},ue={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},jc={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},Fs={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},_c={isValue:"${path} field must be ${value}"},Ft={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},Nc={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},kc={notType:r=>{const{path:e,value:t,spec:s}=r,i=s.types.length;if(Array.isArray(t)){if(t.length<i)return`${e} tuple value has too few items, expected a length of ${i} but got ${t.length} for value: \`${Ue(t,!0)}\``;if(t.length>i)return`${e} tuple value has too many items, expected a length of ${i} but got ${t.length} for value: \`${Ue(t,!0)}\``}return le.formatError(Ne.notType,r)}};Object.assign(Object.create(null),{mixed:Ne,string:ue,number:jc,date:Fs,object:Ft,array:Nc,boolean:_c,tuple:kc});const nr=r=>r&&r.__isYupSchema__;class qt{static fromOptions(e,t){if(!t.then&&!t.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:s,then:i,otherwise:a}=t,o=typeof s=="function"?s:(...l)=>l.every(c=>c===s);return new qt(e,(l,c)=>{var d;let u=o(...l)?i:a;return(d=u==null?void 0:u(c))!=null?d:c})}constructor(e,t){this.fn=void 0,this.refs=e,this.refs=e,this.fn=t}resolve(e,t){let s=this.refs.map(a=>a.getValue(t==null?void 0:t.value,t==null?void 0:t.parent,t==null?void 0:t.context)),i=this.fn(s,e,t);if(i===void 0||i===e)return e;if(!nr(i))throw new TypeError("conditions must return a schema object");return i.resolve(t)}}const Pt={context:"$",value:"."};function Sc(r,e){return new Be(r,e)}class Be{constructor(e,t={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof e!="string")throw new TypeError("ref must be a string, got: "+e);if(this.key=e.trim(),e==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===Pt.context,this.isValue=this.key[0]===Pt.value,this.isSibling=!this.isContext&&!this.isValue;let s=this.isContext?Pt.context:this.isValue?Pt.value:"";this.path=this.key.slice(s.length),this.getter=this.path&&Je.getter(this.path,!0),this.map=t.map}getValue(e,t,s){let i=this.isContext?s:this.isValue?e:t;return this.getter&&(i=this.getter(i||{})),this.map&&(i=this.map(i)),i}cast(e,t){return this.getValue(e,t==null?void 0:t.parent,t==null?void 0:t.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(e){return e&&e.__isYupRef}}Be.prototype.__isYupRef=!0;const Ge=r=>r==null;function it(r){function e({value:t,path:s="",options:i,originalValue:a,schema:o},l,c){const{name:d,test:u,params:h,message:m,skipAbsent:p}=r;let{parent:j,context:x,abortEarly:y=o.spec.abortEarly,disableStackTrace:S=o.spec.disableStackTrace}=i;const b={value:t,parent:j,context:x};function w(M={}){const I=vi(Object.assign({value:t,originalValue:a,label:o.spec.label,path:M.path||s,spec:o.spec,disableStackTrace:M.disableStackTrace||S},h,M.params),b),L=new le(le.formatError(M.message||m,I),t,I.path,M.type||d,I.disableStackTrace);return L.params=I,L}const E=y?l:c;let O={path:s,parent:j,type:d,from:i.from,createError:w,resolve(M){return wi(M,b)},options:i,originalValue:a,schema:o};const P=M=>{le.isError(M)?E(M):M?c(null):E(w())},F=M=>{le.isError(M)?E(M):l(M)};if(p&&Ge(t))return P(!0);let G;try{var re;if(G=u.call(O,t,O),typeof((re=G)==null?void 0:re.then)=="function"){if(i.sync)throw new Error(`Validation test of type: "${O.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(G).then(P,F)}}catch(M){F(M);return}P(G)}return e.OPTIONS=r,e}function vi(r,e){if(!r)return r;for(const t of Object.keys(r))r[t]=wi(r[t],e);return r}function wi(r,e){return Be.isRef(r)?r.getValue(e.value,e.parent,e.context):r}function Ec(r,e,t,s=t){let i,a,o;return e?(Je.forEach(e,(l,c,d)=>{let u=c?l.slice(1,l.length-1):l;r=r.resolve({context:s,parent:i,value:t});let h=r.type==="tuple",m=d?parseInt(u,10):0;if(r.innerType||h){if(h&&!d)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${o}" must contain an index to the tuple element, e.g. "${o}[0]"`);if(t&&m>=t.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${l}, in the path: ${e}. because there is no value at that index. `);i=t,t=t&&t[m],r=h?r.spec.types[m]:r.innerType}if(!d){if(!r.fields||!r.fields[u])throw new Error(`The schema does not contain the path: ${e}. (failed at: ${o} which is a type: "${r.type}")`);i=t,t=t&&t[u],r=r.fields[u]}a=u,o=c?"["+l+"]":"."+l}),{schema:r,parent:i,parentPath:a}):{parent:i,parentPath:e,schema:r}}class Wt extends Set{describe(){const e=[];for(const t of this.values())e.push(Be.isRef(t)?t.describe():t);return e}resolveAll(e){let t=[];for(const s of this.values())t.push(e(s));return t}clone(){return new Wt(this.values())}merge(e,t){const s=this.clone();return e.forEach(i=>s.add(i)),t.forEach(i=>s.delete(i)),s}}function ct(r,e=new Map){if(nr(r)||!r||typeof r!="object")return r;if(e.has(r))return e.get(r);let t;if(r instanceof Date)t=new Date(r.getTime()),e.set(r,t);else if(r instanceof RegExp)t=new RegExp(r),e.set(r,t);else if(Array.isArray(r)){t=new Array(r.length),e.set(r,t);for(let s=0;s<r.length;s++)t[s]=ct(r[s],e)}else if(r instanceof Map){t=new Map,e.set(r,t);for(const[s,i]of r.entries())t.set(s,ct(i,e))}else if(r instanceof Set){t=new Set,e.set(r,t);for(const s of r)t.add(ct(s,e))}else if(r instanceof Object){t={},e.set(r,t);for(const[s,i]of Object.entries(r))t[s]=ct(i,e)}else throw Error(`Unable to clone ${r}`);return t}function Tc(r){if(!(r!=null&&r.length))return;const e=[];let t="",s=!1,i=!1;for(let a=0;a<r.length;a++){const o=r[a];if(o==="["&&!i){t&&(e.push(...t.split(".").filter(Boolean)),t=""),s=!0;continue}if(o==="]"&&!i){t&&(/^\d+$/.test(t)?e.push(t):e.push(t.replace(/^"|"$/g,"")),t=""),s=!1;continue}if(o==='"'){i=!i;continue}if(o==="."&&!s&&!i){t&&(e.push(t),t="");continue}t+=o}return t&&e.push(...t.split(".").filter(Boolean)),e}function Ac(r,e){const t=e?`${e}.${r.path}`:r.path;return r.errors.map(s=>({message:s,path:Tc(t)}))}function ji(r,e){var t;if(!((t=r.inner)!=null&&t.length)&&r.errors.length)return Ac(r,e);const s=e?`${e}.${r.path}`:r.path;return r.inner.flatMap(i=>ji(i,s))}class Se{constructor(e){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new Wt,this._blacklist=new Wt,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(Ne.notType)}),this.type=e.type,this._typeCheck=e.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},e==null?void 0:e.spec),this.withMutation(t=>{t.nonNullable()})}get _type(){return this.type}clone(e){if(this._mutate)return e&&Object.assign(this.spec,e),this;const t=Object.create(Object.getPrototypeOf(this));return t.type=this.type,t._typeCheck=this._typeCheck,t._whitelist=this._whitelist.clone(),t._blacklist=this._blacklist.clone(),t.internalTests=Object.assign({},this.internalTests),t.exclusiveTests=Object.assign({},this.exclusiveTests),t.deps=[...this.deps],t.conditions=[...this.conditions],t.tests=[...this.tests],t.transforms=[...this.transforms],t.spec=ct(Object.assign({},this.spec,e)),t}label(e){let t=this.clone();return t.spec.label=e,t}meta(...e){if(e.length===0)return this.spec.meta;let t=this.clone();return t.spec.meta=Object.assign(t.spec.meta||{},e[0]),t}withMutation(e){let t=this._mutate;this._mutate=!0;let s=e(this);return this._mutate=t,s}concat(e){if(!e||e===this)return this;if(e.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${e.type}`);let t=this,s=e.clone();const i=Object.assign({},t.spec,s.spec);return s.spec=i,s.internalTests=Object.assign({},t.internalTests,s.internalTests),s._whitelist=t._whitelist.merge(e._whitelist,e._blacklist),s._blacklist=t._blacklist.merge(e._blacklist,e._whitelist),s.tests=t.tests,s.exclusiveTests=t.exclusiveTests,s.withMutation(a=>{e.tests.forEach(o=>{a.test(o.OPTIONS)})}),s.transforms=[...t.transforms,...s.transforms],s}isType(e){return e==null?!!(this.spec.nullable&&e===null||this.spec.optional&&e===void 0):this._typeCheck(e)}resolve(e){let t=this;if(t.conditions.length){let s=t.conditions;t=t.clone(),t.conditions=[],t=s.reduce((i,a)=>a.resolve(i,e),t),t=t.resolve(e)}return t}resolveOptions(e){var t,s,i,a;return Object.assign({},e,{from:e.from||[],strict:(t=e.strict)!=null?t:this.spec.strict,abortEarly:(s=e.abortEarly)!=null?s:this.spec.abortEarly,recursive:(i=e.recursive)!=null?i:this.spec.recursive,disableStackTrace:(a=e.disableStackTrace)!=null?a:this.spec.disableStackTrace})}cast(e,t={}){let s=this.resolve(Object.assign({value:e},t)),i=t.assert==="ignore-optionality",a=s._cast(e,t);if(t.assert!==!1&&!s.isType(a)){if(i&&Ge(a))return a;let o=Ue(e),l=Ue(a);throw new TypeError(`The value of ${t.path||"field"} could not be cast to a value that satisfies the schema type: "${s.type}". 

attempted value: ${o} 
`+(l!==o?`result of cast: ${l}`:""))}return a}_cast(e,t){let s=e===void 0?e:this.transforms.reduce((i,a)=>a.call(this,i,e,this),e);return s===void 0&&(s=this.getDefault(t)),s}_validate(e,t={},s,i){let{path:a,originalValue:o=e,strict:l=this.spec.strict}=t,c=e;l||(c=this._cast(c,Object.assign({assert:!1},t)));let d=[];for(let u of Object.values(this.internalTests))u&&d.push(u);this.runTests({path:a,value:c,originalValue:o,options:t,tests:d},s,u=>{if(u.length)return i(u,c);this.runTests({path:a,value:c,originalValue:o,options:t,tests:this.tests},s,i)})}runTests(e,t,s){let i=!1,{tests:a,value:o,originalValue:l,path:c,options:d}=e,u=x=>{i||(i=!0,t(x,o))},h=x=>{i||(i=!0,s(x,o))},m=a.length,p=[];if(!m)return h([]);let j={value:o,originalValue:l,path:c,options:d,schema:this};for(let x=0;x<a.length;x++){const y=a[x];y(j,u,function(b){b&&(Array.isArray(b)?p.push(...b):p.push(b)),--m<=0&&h(p)})}}asNestedTest({key:e,index:t,parent:s,parentPath:i,originalParent:a,options:o}){const l=e??t;if(l==null)throw TypeError("Must include `key` or `index` for nested validations");const c=typeof l=="number";let d=s[l];const u=Object.assign({},o,{strict:!0,parent:s,value:d,originalValue:a[l],key:void 0,[c?"index":"key"]:l,path:c||l.includes(".")?`${i||""}[${c?l:`"${l}"`}]`:(i?`${i}.`:"")+e});return(h,m,p)=>this.resolve(u)._validate(d,u,m,p)}validate(e,t){var s;let i=this.resolve(Object.assign({},t,{value:e})),a=(s=t==null?void 0:t.disableStackTrace)!=null?s:i.spec.disableStackTrace;return new Promise((o,l)=>i._validate(e,t,(c,d)=>{le.isError(c)&&(c.value=d),l(c)},(c,d)=>{c.length?l(new le(c,d,void 0,void 0,a)):o(d)}))}validateSync(e,t){var s;let i=this.resolve(Object.assign({},t,{value:e})),a,o=(s=t==null?void 0:t.disableStackTrace)!=null?s:i.spec.disableStackTrace;return i._validate(e,Object.assign({},t,{sync:!0}),(l,c)=>{throw le.isError(l)&&(l.value=c),l},(l,c)=>{if(l.length)throw new le(l,e,void 0,void 0,o);a=c}),a}isValid(e,t){return this.validate(e,t).then(()=>!0,s=>{if(le.isError(s))return!1;throw s})}isValidSync(e,t){try{return this.validateSync(e,t),!0}catch(s){if(le.isError(s))return!1;throw s}}_getDefault(e){let t=this.spec.default;return t==null?t:typeof t=="function"?t.call(this,e):ct(t)}getDefault(e){return this.resolve(e||{})._getDefault(e)}default(e){return arguments.length===0?this._getDefault():this.clone({default:e})}strict(e=!0){return this.clone({strict:e})}nullability(e,t){const s=this.clone({nullable:e});return s.internalTests.nullable=it({message:t,name:"nullable",test(i){return i===null?this.schema.spec.nullable:!0}}),s}optionality(e,t){const s=this.clone({optional:e});return s.internalTests.optionality=it({message:t,name:"optionality",test(i){return i===void 0?this.schema.spec.optional:!0}}),s}optional(){return this.optionality(!0)}defined(e=Ne.defined){return this.optionality(!1,e)}nullable(){return this.nullability(!0)}nonNullable(e=Ne.notNull){return this.nullability(!1,e)}required(e=Ne.required){return this.clone().withMutation(t=>t.nonNullable(e).defined(e))}notRequired(){return this.clone().withMutation(e=>e.nullable().optional())}transform(e){let t=this.clone();return t.transforms.push(e),t}test(...e){let t;if(e.length===1?typeof e[0]=="function"?t={test:e[0]}:t=e[0]:e.length===2?t={name:e[0],test:e[1]}:t={name:e[0],message:e[1],test:e[2]},t.message===void 0&&(t.message=Ne.default),typeof t.test!="function")throw new TypeError("`test` is a required parameters");let s=this.clone(),i=it(t),a=t.exclusive||t.name&&s.exclusiveTests[t.name]===!0;if(t.exclusive&&!t.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return t.name&&(s.exclusiveTests[t.name]=!!t.exclusive),s.tests=s.tests.filter(o=>!(o.OPTIONS.name===t.name&&(a||o.OPTIONS.test===i.OPTIONS.test))),s.tests.push(i),s}when(e,t){!Array.isArray(e)&&typeof e!="string"&&(t=e,e=".");let s=this.clone(),i=pi(e).map(a=>new Be(a));return i.forEach(a=>{a.isSibling&&s.deps.push(a.key)}),s.conditions.push(typeof t=="function"?new qt(i,t):qt.fromOptions(i,t)),s}typeError(e){let t=this.clone();return t.internalTests.typeError=it({message:e,name:"typeError",skipAbsent:!0,test(s){return this.schema._typeCheck(s)?!0:this.createError({params:{type:this.schema.type}})}}),t}oneOf(e,t=Ne.oneOf){let s=this.clone();return e.forEach(i=>{s._whitelist.add(i),s._blacklist.delete(i)}),s.internalTests.whiteList=it({message:t,name:"oneOf",skipAbsent:!0,test(i){let a=this.schema._whitelist,o=a.resolveAll(this.resolve);return o.includes(i)?!0:this.createError({params:{values:Array.from(a).join(", "),resolved:o}})}}),s}notOneOf(e,t=Ne.notOneOf){let s=this.clone();return e.forEach(i=>{s._blacklist.add(i),s._whitelist.delete(i)}),s.internalTests.blacklist=it({message:t,name:"notOneOf",test(i){let a=this.schema._blacklist,o=a.resolveAll(this.resolve);return o.includes(i)?this.createError({params:{values:Array.from(a).join(", "),resolved:o}}):!0}}),s}strip(e=!0){let t=this.clone();return t.spec.strip=e,t}describe(e){const t=(e?this.resolve(e):this).clone(),{label:s,meta:i,optional:a,nullable:o}=t.spec;return{meta:i,label:s,optional:a,nullable:o,default:t.getDefault(e),type:t.type,oneOf:t._whitelist.describe(),notOneOf:t._blacklist.describe(),tests:t.tests.filter((c,d,u)=>u.findIndex(h=>h.OPTIONS.name===c.OPTIONS.name)===d).map(c=>{const d=c.OPTIONS.params&&e?vi(Object.assign({},c.OPTIONS.params),e):c.OPTIONS.params;return{name:c.OPTIONS.name,params:d}})}}get"~standard"(){const e=this;return{version:1,vendor:"yup",async validate(s){try{return{value:await e.validate(s,{abortEarly:!1})}}catch(i){if(i instanceof le)return{issues:ji(i)};throw i}}}}}Se.prototype.__isYupSchema__=!0;for(const r of["validate","validateSync"])Se.prototype[`${r}At`]=function(e,t,s={}){const{parent:i,parentPath:a,schema:o}=Ec(this,e,t,s.context);return o[r](i&&i[a],Object.assign({},s,{parent:i,path:e}))};for(const r of["equals","is"])Se.prototype[r]=Se.prototype.oneOf;for(const r of["not","nope"])Se.prototype[r]=Se.prototype.notOneOf;const Cc=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function Oc(r){const e=Is(r);if(!e)return Date.parse?Date.parse(r):Number.NaN;if(e.z===void 0&&e.plusMinus===void 0)return new Date(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond).valueOf();let t=0;return e.z!=="Z"&&e.plusMinus!==void 0&&(t=e.hourOffset*60+e.minuteOffset,e.plusMinus==="+"&&(t=0-t)),Date.UTC(e.year,e.month,e.day,e.hour,e.minute+t,e.second,e.millisecond)}function Is(r){var e,t;const s=Cc.exec(r);return s?{year:Ae(s[1]),month:Ae(s[2],1)-1,day:Ae(s[3],1),hour:Ae(s[4]),minute:Ae(s[5]),second:Ae(s[6]),millisecond:s[7]?Ae(s[7].substring(0,3)):0,precision:(e=(t=s[7])==null?void 0:t.length)!=null?e:void 0,z:s[8]||void 0,plusMinus:s[9]||void 0,hourOffset:Ae(s[10]),minuteOffset:Ae(s[11])}:null}function Ae(r,e=0){return Number(r)||e}let $c=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Pc=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,Rc=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,Fc="^\\d{4}-\\d{2}-\\d{2}",Ic="\\d{2}:\\d{2}:\\d{2}",Dc="(([+-]\\d{2}(:?\\d{2})?)|Z)",Lc=new RegExp(`${Fc}T${Ic}(\\.\\d+)?${Dc}$`),Uc=r=>Ge(r)||r===r.trim(),Mc={}.toString();function Ke(){return new _i}class _i extends Se{constructor(){super({type:"string",check(e){return e instanceof String&&(e=e.valueOf()),typeof e=="string"}}),this.withMutation(()=>{this.transform((e,t,s)=>{if(!s.spec.coerce||s.isType(e)||Array.isArray(e))return e;const i=e!=null&&e.toString?e.toString():e;return i===Mc?e:i})})}required(e){return super.required(e).withMutation(t=>t.test({message:e||Ne.required,name:"required",skipAbsent:!0,test:s=>!!s.length}))}notRequired(){return super.notRequired().withMutation(e=>(e.tests=e.tests.filter(t=>t.OPTIONS.name!=="required"),e))}length(e,t=ue.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(s){return s.length===this.resolve(e)}})}min(e,t=ue.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(s){return s.length>=this.resolve(e)}})}max(e,t=ue.max){return this.test({name:"max",exclusive:!0,message:t,params:{max:e},skipAbsent:!0,test(s){return s.length<=this.resolve(e)}})}matches(e,t){let s=!1,i,a;return t&&(typeof t=="object"?{excludeEmptyString:s=!1,message:i,name:a}=t:i=t),this.test({name:a||"matches",message:i||ue.matches,params:{regex:e},skipAbsent:!0,test:o=>o===""&&s||o.search(e)!==-1})}email(e=ue.email){return this.matches($c,{name:"email",message:e,excludeEmptyString:!0})}url(e=ue.url){return this.matches(Pc,{name:"url",message:e,excludeEmptyString:!0})}uuid(e=ue.uuid){return this.matches(Rc,{name:"uuid",message:e,excludeEmptyString:!1})}datetime(e){let t="",s,i;return e&&(typeof e=="object"?{message:t="",allowOffset:s=!1,precision:i=void 0}=e:t=e),this.matches(Lc,{name:"datetime",message:t||ue.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:t||ue.datetime_offset,params:{allowOffset:s},skipAbsent:!0,test:a=>{if(!a||s)return!0;const o=Is(a);return o?!!o.z:!1}}).test({name:"datetime_precision",message:t||ue.datetime_precision,params:{precision:i},skipAbsent:!0,test:a=>{if(!a||i==null)return!0;const o=Is(a);return o?o.precision===i:!1}})}ensure(){return this.default("").transform(e=>e===null?"":e)}trim(e=ue.trim){return this.transform(t=>t!=null?t.trim():t).test({message:e,name:"trim",test:Uc})}lowercase(e=ue.lowercase){return this.transform(t=>Ge(t)?t:t.toLowerCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Ge(t)||t===t.toLowerCase()})}uppercase(e=ue.uppercase){return this.transform(t=>Ge(t)?t:t.toUpperCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Ge(t)||t===t.toUpperCase()})}}Ke.prototype=_i.prototype;let Bc=new Date(""),Vc=r=>Object.prototype.toString.call(r)==="[object Date]";class rs extends Se{constructor(){super({type:"date",check(e){return Vc(e)&&!isNaN(e.getTime())}}),this.withMutation(()=>{this.transform((e,t,s)=>!s.spec.coerce||s.isType(e)||e===null?e:(e=Oc(e),isNaN(e)?rs.INVALID_DATE:new Date(e)))})}prepareParam(e,t){let s;if(Be.isRef(e))s=e;else{let i=this.cast(e);if(!this._typeCheck(i))throw new TypeError(`\`${t}\` must be a Date or a value that can be \`cast()\` to a Date`);s=i}return s}min(e,t=Fs.min){let s=this.prepareParam(e,"min");return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(i){return i>=this.resolve(s)}})}max(e,t=Fs.max){let s=this.prepareParam(e,"max");return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(i){return i<=this.resolve(s)}})}}rs.INVALID_DATE=Bc;rs.prototype;function qc(r,e=[]){let t=[],s=new Set,i=new Set(e.map(([o,l])=>`${o}-${l}`));function a(o,l){let c=Je.split(o)[0];s.add(c),i.has(`${l}-${c}`)||t.push([l,c])}for(const o of Object.keys(r)){let l=r[o];s.add(o),Be.isRef(l)&&l.isSibling?a(l.path,o):nr(l)&&"deps"in l&&l.deps.forEach(c=>a(c,o))}return mc.array(Array.from(s),t).reverse()}function ln(r,e){let t=1/0;return r.some((s,i)=>{var a;if((a=e.path)!=null&&a.includes(s))return t=i,!0}),t}function Ni(r){return(e,t)=>ln(r,e)-ln(r,t)}const Wc=(r,e,t)=>{if(typeof r!="string")return r;let s=r;try{s=JSON.parse(r)}catch{}return t.isType(s)?s:r};function It(r){if("fields"in r){const e={};for(const[t,s]of Object.entries(r.fields))e[t]=It(s);return r.setFields(e)}if(r.type==="array"){const e=r.optional();return e.innerType&&(e.innerType=It(e.innerType)),e}return r.type==="tuple"?r.optional().clone({types:r.spec.types.map(It)}):"optional"in r?r.optional():r}const zc=(r,e)=>{const t=[...Je.normalizePath(e)];if(t.length===1)return t[0]in r;let s=t.pop(),i=Je.getter(Je.join(t),!0)(r);return!!(i&&s in i)};let cn=r=>Object.prototype.toString.call(r)==="[object Object]";function dn(r,e){let t=Object.keys(r.fields);return Object.keys(e).filter(s=>t.indexOf(s)===-1)}const Hc=Ni([]);function ir(r){return new ki(r)}class ki extends Se{constructor(e){super({type:"object",check(t){return cn(t)||typeof t=="function"}}),this.fields=Object.create(null),this._sortErrors=Hc,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{e&&this.shape(e)})}_cast(e,t={}){var s;let i=super._cast(e,t);if(i===void 0)return this.getDefault(t);if(!this._typeCheck(i))return i;let a=this.fields,o=(s=t.stripUnknown)!=null?s:this.spec.noUnknown,l=[].concat(this._nodes,Object.keys(i).filter(h=>!this._nodes.includes(h))),c={},d=Object.assign({},t,{parent:c,__validating:t.__validating||!1}),u=!1;for(const h of l){let m=a[h],p=h in i;if(m){let j,x=i[h];d.path=(t.path?`${t.path}.`:"")+h,m=m.resolve({value:x,context:t.context,parent:c});let y=m instanceof Se?m.spec:void 0,S=y==null?void 0:y.strict;if(y!=null&&y.strip){u=u||h in i;continue}j=!t.__validating||!S?m.cast(i[h],d):i[h],j!==void 0&&(c[h]=j)}else p&&!o&&(c[h]=i[h]);(p!==h in c||c[h]!==i[h])&&(u=!0)}return u?c:i}_validate(e,t={},s,i){let{from:a=[],originalValue:o=e,recursive:l=this.spec.recursive}=t;t.from=[{schema:this,value:o},...a],t.__validating=!0,t.originalValue=o,super._validate(e,t,s,(c,d)=>{if(!l||!cn(d)){i(c,d);return}o=o||d;let u=[];for(let h of this._nodes){let m=this.fields[h];!m||Be.isRef(m)||u.push(m.asNestedTest({options:t,key:h,parent:d,parentPath:t.path,originalParent:o}))}this.runTests({tests:u,value:d,originalValue:o,options:t},s,h=>{i(h.sort(this._sortErrors).concat(c),d)})})}clone(e){const t=super.clone(e);return t.fields=Object.assign({},this.fields),t._nodes=this._nodes,t._excludedEdges=this._excludedEdges,t._sortErrors=this._sortErrors,t}concat(e){let t=super.concat(e),s=t.fields;for(let[i,a]of Object.entries(this.fields)){const o=s[i];s[i]=o===void 0?a:o}return t.withMutation(i=>i.setFields(s,[...this._excludedEdges,...e._excludedEdges]))}_getDefault(e){if("default"in this.spec)return super._getDefault(e);if(!this._nodes.length)return;let t={};return this._nodes.forEach(s=>{var i;const a=this.fields[s];let o=e;(i=o)!=null&&i.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[s]})),t[s]=a&&"getDefault"in a?a.getDefault(o):void 0}),t}setFields(e,t){let s=this.clone();return s.fields=e,s._nodes=qc(e,t),s._sortErrors=Ni(Object.keys(e)),t&&(s._excludedEdges=t),s}shape(e,t=[]){return this.clone().withMutation(s=>{let i=s._excludedEdges;return t.length&&(Array.isArray(t[0])||(t=[t]),i=[...s._excludedEdges,...t]),s.setFields(Object.assign(s.fields,e),i)})}partial(){const e={};for(const[t,s]of Object.entries(this.fields))e[t]="optional"in s&&s.optional instanceof Function?s.optional():s;return this.setFields(e)}deepPartial(){return It(this)}pick(e){const t={};for(const s of e)this.fields[s]&&(t[s]=this.fields[s]);return this.setFields(t,this._excludedEdges.filter(([s,i])=>e.includes(s)&&e.includes(i)))}omit(e){const t=[];for(const s of Object.keys(this.fields))e.includes(s)||t.push(s);return this.pick(t)}from(e,t,s){let i=Je.getter(e,!0);return this.transform(a=>{if(!a)return a;let o=a;return zc(a,e)&&(o=Object.assign({},a),s||delete o[e],o[t]=i(a)),o})}json(){return this.transform(Wc)}exact(e){return this.test({name:"exact",exclusive:!0,message:e||Ft.exact,test(t){if(t==null)return!0;const s=dn(this.schema,t);return s.length===0||this.createError({params:{properties:s.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(e=!0,t=Ft.noUnknown){typeof e!="boolean"&&(t=e,e=!0);let s=this.test({name:"noUnknown",exclusive:!0,message:t,test(i){if(i==null)return!0;const a=dn(this.schema,i);return!e||a.length===0||this.createError({params:{unknown:a.join(", ")}})}});return s.spec.noUnknown=e,s}unknown(e=!0,t=Ft.noUnknown){return this.noUnknown(!e,t)}transformKeys(e){return this.transform(t=>{if(!t)return t;const s={};for(const i of Object.keys(t))s[e(i)]=t[i];return s})}camelCase(){return this.transformKeys(bs.camelCase)}snakeCase(){return this.transformKeys(bs.snakeCase)}constantCase(){return this.transformKeys(e=>bs.snakeCase(e).toUpperCase())}describe(e){const t=(e?this.resolve(e):this).clone(),s=super.describe(e);s.fields={};for(const[a,o]of Object.entries(t.fields)){var i;let l=e;(i=l)!=null&&i.value&&(l=Object.assign({},l,{parent:l.value,value:l.value[a]})),s.fields[a]=o.describe(l)}return s}}ir.prototype=ki.prototype;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Gc={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kc=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),U=(r,e)=>{const t=C.forwardRef(({color:s="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:l="",children:c,...d},u)=>C.createElement("svg",{ref:u,...Gc,width:i,height:i,stroke:s,strokeWidth:o?Number(a)*24/Number(i):a,className:["lucide",`lucide-${Kc(r)}`,l].join(" "),...d},[...e.map(([h,m])=>C.createElement(h,m)),...Array.isArray(c)?c:[c]]));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Si=U("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jc=U("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=U("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=U("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=U("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=U("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ei=U("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zc=U("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=U("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=U("Factory",[["path",{d:"M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"159hny"}],["path",{d:"M17 18h1",key:"uldtlt"}],["path",{d:"M12 18h1",key:"s9uhes"}],["path",{d:"M7 18h1",key:"1neino"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qc=U("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ti=U("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xc=U("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=U("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=U("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ed=U("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const td=U("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ai=U("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sd=U("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=U("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rd=U("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const un=U("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nd=U("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=U("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=U("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const id=U("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ad=U("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=U("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=U("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=U("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ci=U("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const od=U("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=U("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),ld=ir({email:Ke().email("Invalid email").required("Email is required"),password:Ke().min(6,"Password must be at least 6 characters").required("Password is required")}),cd=()=>{const[r,e]=C.useState(!1),[t,s]=C.useState(null),{signIn:i}=we(),a=Ms(),{register:o,handleSubmit:l,formState:{errors:c}}=di({resolver:hi(ld)}),d=async u=>{try{e(!0),s(null);const{error:h}=await i(u.email,u.password);if(h)throw h;a("/dashboard")}catch(h){s(h.message)}finally{e(!1)}};return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"max-w-md w-full space-y-8",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"flex justify-center",children:n.jsx("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 p-3 rounded-full",children:n.jsx(ed,{className:"h-8 w-8 text-white"})})}),n.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Sign in to your account"}),n.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Or"," ",n.jsx(Nn,{to:"/register",className:"font-medium text-green-600 hover:text-green-500",children:"create a new account"})]})]}),n.jsxs("form",{className:"mt-8 space-y-6",onSubmit:l(d),children:[t&&n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center space-x-2",children:[n.jsx(Si,{className:"h-5 w-5 text-red-500"}),n.jsx("span",{className:"text-red-700",children:t})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),n.jsxs("div",{className:"mt-1 relative",children:[n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(Ai,{className:"h-5 w-5 text-gray-400"})}),n.jsx("input",{...o("email"),type:"email",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter your email"})]}),c.email&&n.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.email.message})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),n.jsxs("div",{className:"mt-1 relative",children:[n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(Us,{className:"h-5 w-5 text-gray-400"})}),n.jsx("input",{...o("password"),type:"password",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter your password"})]}),c.password&&n.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.password.message})]})]}),n.jsx("div",{children:n.jsx("button",{type:"submit",disabled:r,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:r?"Signing in...":"Sign in"})})]})]})})},dd=ir({fullName:Ke().required("Full name is required"),email:Ke().email("Invalid email").required("Email is required"),password:Ke().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:Ke().oneOf([Sc("password")],"Passwords must match").required("Please confirm your password")}),ud=()=>{const[r,e]=C.useState(!1),[t,s]=C.useState(null),[i,a]=C.useState(!1),{signUp:o}=we(),l=Ms(),{register:c,handleSubmit:d,formState:{errors:u}}=di({resolver:hi(dd)}),h=async m=>{try{e(!0),s(null);const{error:p}=await o(m.email,m.password,m.fullName);if(p)throw p;a(!0),setTimeout(()=>l("/login"),2e3)}catch(p){s(p.message)}finally{e(!1)}};return i?n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:n.jsx("div",{className:"max-w-md w-full text-center",children:n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[n.jsx("div",{className:"flex justify-center mb-4",children:n.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:n.jsx(hn,{className:"h-8 w-8 text-green-600"})})}),n.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Registration Successful!"}),n.jsx("p",{className:"text-gray-600",children:"Please check your email to verify your account."})]})})}):n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"max-w-md w-full space-y-8",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"flex justify-center",children:n.jsx("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 p-3 rounded-full",children:n.jsx(hn,{className:"h-8 w-8 text-white"})})}),n.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Create your account"}),n.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Or"," ",n.jsx(Nn,{to:"/login",className:"font-medium text-green-600 hover:text-green-500",children:"sign in to your existing account"})]})]}),n.jsxs("form",{className:"mt-8 space-y-6",onSubmit:d(h),children:[t&&n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center space-x-2",children:[n.jsx(Si,{className:"h-5 w-5 text-red-500"}),n.jsx("span",{className:"text-red-700",children:t})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),n.jsxs("div",{className:"mt-1 relative",children:[n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(Ci,{className:"h-5 w-5 text-gray-400"})}),n.jsx("input",{...c("fullName"),type:"text",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter your full name"})]}),u.fullName&&n.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.fullName.message})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),n.jsxs("div",{className:"mt-1 relative",children:[n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(Ai,{className:"h-5 w-5 text-gray-400"})}),n.jsx("input",{...c("email"),type:"email",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter your email"})]}),u.email&&n.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.email.message})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),n.jsxs("div",{className:"mt-1 relative",children:[n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(Us,{className:"h-5 w-5 text-gray-400"})}),n.jsx("input",{...c("password"),type:"password",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter your password"})]}),u.password&&n.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.password.message})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),n.jsxs("div",{className:"mt-1 relative",children:[n.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n.jsx(Us,{className:"h-5 w-5 text-gray-400"})}),n.jsx("input",{...c("confirmPassword"),type:"password",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Confirm your password"})]}),u.confirmPassword&&n.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.confirmPassword.message})]})]}),n.jsx("div",{children:n.jsx("button",{type:"submit",disabled:r,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:r?"Creating account...":"Create account"})})]})]})})},hd=()=>{var d;const{user:r,signOut:e,isAdmin:t}=we(),s=Ms(),i=_n(),a=async()=>{try{await e(),s("/login")}catch(u){console.error("Error signing out:",u)}},o=[{id:"calculations",label:"Calculations",icon:Pe,path:"/dashboard/calculations"},{id:"estimations",label:"Estimations",icon:lr,path:"/dashboard/estimations"},{id:"recommendations",label:"Recommendations",icon:zt,path:"/dashboard/recommendations"},{id:"history",label:"History",icon:Qc,path:"/dashboard/history"}],l=[{id:"admin",label:"Admin Panel",icon:nd,path:"/dashboard/admin"}],c=u=>i.pathname===u;return n.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50",children:[n.jsx("header",{className:"bg-white shadow-lg sticky top-0 z-50",children:n.jsx("div",{className:"max-w-7xl mx-auto px-4",children:n.jsxs("div",{className:"flex items-center justify-between h-16",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Ye,{className:"h-8 w-8 text-green-500"}),n.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-green-600 to-blue-600 bg-clip-text text-transparent",children:"Energy Audit Pro"})]}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[n.jsx(Ci,{className:"h-5 w-5"}),n.jsx("span",{className:"text-sm font-medium",children:((d=r==null?void 0:r.user_metadata)==null?void 0:d.full_name)||(r==null?void 0:r.email)}),t&&n.jsx("span",{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full",children:"Admin"})]}),n.jsxs("button",{onClick:a,className:"flex items-center space-x-2 text-gray-600 hover:text-red-600 transition-colors duration-200",children:[n.jsx(td,{className:"h-5 w-5"}),n.jsx("span",{className:"text-sm",children:"Sign Out"})]})]})]})})}),n.jsx("nav",{className:"bg-white shadow-sm border-t border-gray-200",children:n.jsx("div",{className:"max-w-7xl mx-auto px-4",children:n.jsxs("div",{className:"flex space-x-1 overflow-x-auto py-2",children:[o.map(u=>{const h=u.icon;return n.jsxs("button",{onClick:()=>s(u.path),className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all duration-200 whitespace-nowrap ${c(u.path)?"bg-gradient-to-r from-green-500 to-blue-500 text-white shadow-md":"text-gray-600 hover:bg-gray-100 hover:text-gray-800"}`,children:[n.jsx(h,{className:"h-4 w-4"}),n.jsx("span",{className:"font-medium",children:u.label})]},u.id)}),t&&l.map(u=>{const h=u.icon;return n.jsxs("button",{onClick:()=>s(u.path),className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all duration-200 whitespace-nowrap ${c(u.path)?"bg-gradient-to-r from-red-500 to-pink-500 text-white shadow-md":"text-red-600 hover:bg-red-50 hover:text-red-700"}`,children:[n.jsx(h,{className:"h-4 w-4"}),n.jsx("span",{className:"font-medium",children:u.label})]},u.id)})]})})}),n.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:n.jsx(zi,{})}),n.jsx("footer",{className:"bg-gray-800 text-white py-6 mt-12",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-4 text-center",children:[n.jsx("p",{className:"text-gray-300",children:"Energy Audit Pro - Comprehensive energy analysis and recommendations for sustainable living"}),n.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Calculate  Analyze  Optimize  Save Energy"})]})})]})},cr=[{threshold:30,rate:1.9},{threshold:75,rate:3},{threshold:125,rate:4.5},{threshold:225,rate:6},{threshold:400,rate:8.75},{threshold:1/0,rate:9.75}],dr=[{threshold:50,rate:5.4},{threshold:100,rate:7.65},{threshold:300,rate:9.05},{threshold:500,rate:9.6},{threshold:1/0,rate:10.15}],fn=75,at={industry_general:{LT:6.7,"11kV":{high_demand:{peak:7.8,off_peak:5.55,normal:6.3},low_demand:{peak:7.3,off_peak:5.55,normal:6.3}},"33kV":{high_demand:{peak:7.35,off_peak:5.1,normal:5.85},low_demand:{peak:7,off_peak:5.1,normal:5.85}},"132kV":{high_demand:{peak:6.9,off_peak:4.65,normal:5.4},low_demand:{peak:6.85,off_peak:4.65,normal:5.4}},"220kV":{high_demand:{peak:6.85,off_peak:4.6,normal:5.35},low_demand:{peak:6.8,off_peak:4.6,normal:5.35}}},seasonal_off_season:{LT:7.45,"11kV":7.65,"33kV":7,"132kV":6.7,"220kV":6.65},energy_intensive:{LT:3.75,"11kV":5.8,"33kV":5.35,"132kV":4.95,"220kV":4.9},cottage_industries:{LT:0},industrial_colonies:{"11kV":14.6,"33kV":5.35,"132kV":7,"220kV":7}};function ut(r,e){let t=0,s=0;const i=[];for(let a=0;a<e.length;a++){const{threshold:o,rate:l}=e[a];if(r<=s)break;const c=Math.min(r,o)-s;if(c>0){const d=c*l;t+=d;const u=s+1,h=Math.min(r,o),m=u===h?`${u}`:`${u}-${h}`;i.push({slab:m,units:c,rate:l,amount:d})}s=o}return{bill:t,breakdown:i}}function Oi(r,e,t=.01){if(r<=0)return{units:0,actualBill:0,breakdown:[]};let s=0,i=r/Math.min(...e.map(o=>o.rate)),a={units:0,actualBill:0,breakdown:[]};for(;i<1e4;){const{bill:o}=ut(i,e);if(o>=r)break;i*=2}for(let o=0;o<100;o++){const l=(s+i)/2,{bill:c,breakdown:d}=ut(l,e);if(Math.abs(c-r)<=t)return{units:l,actualBill:c,breakdown:d};if(c<r?(s=l,a={units:l,actualBill:c,breakdown:d}):i=l,i-s<.01)break}return a}function fd(r){return Oi(r,cr)}function md(r){return Oi(r,dr)}function mn(r,e){const t=r.reduce((c,d)=>c+d.rating*d.quantity*d.hours,0),s=e.reduce((c,d)=>c+d.rating*d.quantity*d.hours,0),a=(t*30+s)/1e3,{bill:o,breakdown:l}=ut(a,cr);return{totalUnits:a,totalBill:o,breakdown:l}}function gn(r,e,t){const s=r.reduce((u,h)=>u+h.rating*h.quantity*h.hours,0),i=e.reduce((u,h)=>u+h.rating*h.quantity*h.hours,0),o=(s*30+i)/1e3;let l;switch(t){case"advertising":l=12.25;break;case"function_halls":l=12.25;break;case"startup_power":l=12.25;break;case"electric_vehicles":l=6.7;break;case"green_power":l=12.25;break;default:const{bill:u,breakdown:h}=ut(o,dr);return{totalUnits:o,totalBill:u,breakdown:h}}const c=o*l,d=[{slab:`${t.replace("_"," ").toUpperCase()}`,units:o,rate:l,amount:c}];return{totalUnits:o,totalBill:c,breakdown:d}}function pn(r,e,t="industry_general",s="LT",i="normal",a="high_demand"){const o=t==="cottage_industries"?0:e*fn;let l=0,c="",d="",u="";switch(t){case"industry_general":c="Industry (General)";const j=at.industry_general;if(s==="LT")l=j.LT,d="LT Supply";else{d=`${s} Supply`;const b=j[s];if(b&&typeof b=="object"){const w=b[a];w&&typeof w=="object"&&(l=w[i],u=`TOD (${a.replace("_"," ").replace(/\b\w/g,E=>E.toUpperCase())}) - ${i.replace("_"," ").replace(/\b\w/g,E=>E.toUpperCase())}`)}}break;case"seasonal_off_season":c="Seasonal Industries (off-season)",d=`${s} Supply`,l=at.seasonal_off_season[s]||0;break;case"energy_intensive":c="Energy Intensive Industries",d=`${s} Supply`,l=at.energy_intensive[s]||0;break;case"cottage_industries":c="Cottage Industries (up to 10 HP)",d="LT Supply (Free)",l=at.cottage_industries.LT;break;case"industrial_colonies":c="Industrial Colonies",d=`${s} Supply`,l=at.industrial_colonies[s]||0;break;default:c="Industry (General)",l=at.industry_general.LT,d="LT Supply"}const h=r*l,m=o+h,p=[];return o>0&&p.push({slab:"Fixed Charges",units:e,rate:fn,amount:o}),p.push({slab:t==="cottage_industries"?`Energy Charges (${c} - Free)`:`Energy Charges (${c})`,units:r,rate:l,amount:h}),{totalUnits:r,totalBill:m,fixedCharge:o,energyCharge:h,breakdown:p,category:c,supplyType:d,todType:u||void 0}}const xn={1:{min:65e3,max:85e3},2:{min:105e3,max:125e3},3:{min:15e4,max:17e4},4:{min:185e3,max:205e3},5:{min:23e4,max:25e4},6:{min:285e3,max:295e3},7:{min:315e3,max:325e3},8:{min:36e4,max:38e4},9:{min:405e3,max:415e3},10:{min:45e4,max:46e4}};function gd(r){if(r<=10&&xn[r]){const o=xn[r],l=Math.round((o.min+o.max)/2),c=`${o.min.toLocaleString()} - ${o.max.toLocaleString()}`;return{investment:l,costRange:c}}const t=r*46e3,s=r*45e3,i=r*47e3,a=`${s.toLocaleString()} - ${i.toLocaleString()}`;return{investment:t,costRange:a}}function pd(r,e="domestic"){if(!(r>4e3))return{recommendSolar:!1,requiredKW:0,estimatedGeneration:0,monthlyUnits:0,savings:0,investment:0,paybackPeriod:0,actualBill:0,breakdown:[],costRange:void 0};const s=e==="domestic"?fd(r):md(r),i=s.units,a=s.actualBill,o=s.breakdown,l=Math.max(1,Math.ceil(i/120)),c=l*4*30,d=Math.min(c,i*.9),u=Math.max(0,i-d),h=e==="domestic"?ut(u,cr):ut(u,dr),m=a-h.bill,{investment:p,costRange:j}=gd(l),x=p/(m*12);return{recommendSolar:!0,requiredKW:l,estimatedGeneration:c,monthlyUnits:i,savings:m,investment:p,paybackPeriod:x,actualBill:a,breakdown:o,costRange:j}}Bs.register(kn,Sn,Ki,En,Vs,qs,Tn);const ur=({data:r})=>{const e={labels:r.map(a=>a.slab),datasets:[{label:"Bill Amount ()",data:r.map(a=>a.amount),backgroundColor:["#10B981","#3B82F6","#F59E0B","#EF4444","#8B5CF6","#F97316"],borderColor:["#059669","#2563EB","#D97706","#DC2626","#7C3AED","#EA580C"],borderWidth:2}]},t={labels:r.map(a=>`${a.slab} units`),datasets:[{data:r.map(a=>a.amount),backgroundColor:["#10B981","#3B82F6","#F59E0B","#EF4444","#8B5CF6","#F97316"],borderWidth:2,borderColor:"#fff"}]},s={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:"Bill Breakdown by Tariff Slabs",font:{size:16,weight:"bold"}}},scales:{y:{beginAtZero:!0,ticks:{callback:function(a){return""+a.toLocaleString()}}}}},i={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"},title:{display:!0,text:"Bill Distribution",font:{size:16,weight:"bold"}},tooltip:{callbacks:{label:function(a){const o=a.parsed,l=a.dataset.data.reduce((d,u)=>d+u,0),c=(o/l*100).toFixed(1);return`${a.label}: ${o.toLocaleString()} (${c}%)`}}}}};return n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:n.jsx("div",{className:"h-80",children:n.jsx(Ji,{data:e,options:s})})}),n.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:n.jsx("div",{className:"h-80",children:n.jsx(Yi,{data:t,options:i})})})]})};Bs.register(Tn,Vs,qs);const hr=({dailyAppliances:r,occasionalAppliances:e})=>{const s=[...r.map(l=>({...l,type:"daily"})),...e.map(l=>({...l,type:"occasional"}))].map(l=>({name:l.name||"Unnamed",energy:l.type==="daily"?l.rating*l.quantity*l.hours*30:l.rating*l.quantity*l.hours,type:l.type})).filter(l=>l.energy>0);if(s.length===0)return n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Energy Distribution"}),n.jsx("div",{className:"flex items-center justify-center h-64 text-gray-500",children:"Add appliances to see energy distribution"})]});const i=["#10B981","#3B82F6","#F59E0B","#EF4444","#8B5CF6","#F97316","#06B6D4","#84CC16","#F43F5E","#6366F1","#14B8A6","#F59E0B"],a={labels:s.map(l=>l.name),datasets:[{data:s.map(l=>l.energy),backgroundColor:i.slice(0,s.length),borderColor:i.slice(0,s.length).map(l=>l+"80"),borderWidth:2}]},o={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{maxWidth:150,usePointStyle:!0}},title:{display:!0,text:"Monthly Energy Consumption by Appliance",font:{size:16,weight:"bold"}},tooltip:{callbacks:{label:function(l){const c=l.parsed,d=l.dataset.data.reduce((h,m)=>h+m,0),u=(c/d*100).toFixed(1);return`${l.label}: ${c.toLocaleString()} Wh (${u}%)`}}}}};return n.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:n.jsx("div",{className:"h-96",children:n.jsx(Zi,{data:a,options:o})})})},yn=({appliances:r,type:e,title:t,icon:s,addAppliance:i,removeAppliance:a,updateAppliance:o})=>n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(s,{className:"h-5 w-5 text-green-500"}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t})]}),n.jsxs("button",{onClick:()=>i(e),className:"flex items-center space-x-2 bg-gradient-to-r from-green-500 to-blue-500 text-white px-4 py-2 rounded-lg hover:shadow-md transition-all duration-200",children:[n.jsx(ar,{className:"h-4 w-4"}),n.jsx("span",{children:"Add Appliance"})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-gray-50",children:[n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Appliance"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Rating (W)"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Quantity"}),n.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:["Hours (",e==="daily"?"per day":"per month",")"]}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Energy (Wh)"}),n.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-700",children:"Action"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map((l,c)=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"text",value:l.name,onChange:d=>o(e,c,"name",d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Appliance name"})}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"number",value:l.rating,onChange:d=>o(e,c,"rating",parseFloat(d.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",min:"0"})}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"number",value:l.quantity,onChange:d=>o(e,c,"quantity",parseInt(d.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",min:"1"})}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"number",value:l.hours,onChange:d=>o(e,c,"hours",parseFloat(d.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",min:"0",step:"0.1"})}),n.jsx("td",{className:"px-4 py-3 text-gray-600",children:(l.rating*l.quantity*l.hours).toLocaleString()}),n.jsx("td",{className:"px-4 py-3 text-center",children:n.jsx("button",{onClick:()=>a(e,c),className:"text-red-500 hover:text-red-700 transition-colors duration-200",children:n.jsx(ns,{className:"h-4 w-4"})})})]},c))})]})})]}),bn=()=>{const{user:r}=we(),[e,t]=C.useState([{name:"LED Light",rating:10,quantity:5,hours:6},{name:"Fan",rating:75,quantity:3,hours:8}]),[s,i]=C.useState([{name:"Washing Machine",rating:500,quantity:1,hours:5}]),[a,o]=C.useState(mn(e,s)),l=h=>{const m={name:"",rating:0,quantity:1,hours:1};h==="daily"?t([...e,m]):i([...s,m])},c=(h,m)=>{if(h==="daily"){const p=e.filter((j,x)=>x!==m);t(p)}else{const p=s.filter((j,x)=>x!==m);i(p)}},d=(h,m,p,j)=>{if(h==="daily"){const x=[...e];x[m]={...x[m],[p]:j},t(x)}else{const x=[...s];x[m]={...x[m],[p]:j},i(x)}};J.useEffect(()=>{const h=mn(e,s);o(h),r&&(e.length>0||s.length>0)&&u(h)},[e,s]);const u=async h=>{try{await ae.from("calculation_history").insert({user_id:r==null?void 0:r.id,calculation_type:"domestic",inputs:{dailyAppliances:e,occasionalAppliances:s},results:h})}catch(m){console.error("Error saving calculation history:",m)}};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-xl p-6",children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Domestic Energy Calculator"}),n.jsx("p",{className:"text-green-100",children:"Calculate your monthly electricity bill based on your appliances usage"})]}),n.jsx(yn,{appliances:e,type:"daily",title:"Daily Appliances",icon:Ti,addAppliance:l,removeAppliance:c,updateAppliance:d}),n.jsx(yn,{appliances:s,type:"occasional",title:"Occasional Appliances",icon:Ye,addAppliance:l,removeAppliance:c,updateAppliance:d}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Bill Summary"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Total Monthly Units:"}),n.jsxs("span",{className:"font-semibold",children:[a.totalUnits.toFixed(2)," kWh"]})]}),n.jsxs("div",{className:"flex justify-between text-lg font-bold text-green-600",children:[n.jsx("span",{children:"Total Bill:"}),n.jsxs("span",{children:["",a.totalBill.toFixed(2)]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Tariff Breakdown"}),n.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:a.breakdown.map((h,m)=>n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[h.slab," units @ ",h.rate]}),n.jsxs("span",{className:"font-semibold",children:["",h.amount.toFixed(2)]})]},m))})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsx(ur,{data:a.breakdown}),n.jsx(hr,{dailyAppliances:e,occasionalAppliances:s})]})]})},vn=({appliances:r,type:e,title:t,icon:s,addAppliance:i,removeAppliance:a,updateAppliance:o})=>n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(s,{className:"h-5 w-5 text-blue-500"}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t})]}),n.jsxs("button",{onClick:()=>i(e),className:"flex items-center space-x-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white px-4 py-2 rounded-lg hover:shadow-md transition-all duration-200",children:[n.jsx(ar,{className:"h-4 w-4"}),n.jsx("span",{children:"Add Appliance"})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-gray-50",children:[n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Appliance"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Rating (W)"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Quantity"}),n.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:["Hours (",e==="daily"?"per day":"per month",")"]}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Energy (Wh)"}),n.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-700",children:"Action"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map((l,c)=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"text",value:l.name,onChange:d=>o(e,c,"name",d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Appliance name"})}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"number",value:l.rating,onChange:d=>o(e,c,"rating",parseFloat(d.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0"})}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"number",value:l.quantity,onChange:d=>o(e,c,"quantity",parseInt(d.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1"})}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"number",value:l.hours,onChange:d=>o(e,c,"hours",parseFloat(d.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"0.1"})}),n.jsx("td",{className:"px-4 py-3 text-gray-600",children:(l.rating*l.quantity*l.hours).toLocaleString()}),n.jsx("td",{className:"px-4 py-3 text-center",children:n.jsx("button",{onClick:()=>a(e,c),className:"text-red-500 hover:text-red-700 transition-colors duration-200",children:n.jsx(ns,{className:"h-4 w-4"})})})]},c))})]})})]}),xd=()=>{var j;const{user:r}=we(),[e,t]=C.useState([{name:"LED Light",rating:10,quantity:10,hours:8},{name:"Fan",rating:75,quantity:5,hours:10}]),[s,i]=C.useState([{name:"Air Conditioner",rating:1500,quantity:2,hours:20}]),[a,o]=C.useState("standard"),l=[{id:"standard",name:"Standard Commercial (Telescopic)",rate:0},{id:"advertising",name:"Advertising Hoardings",rate:12.25},{id:"function_halls",name:"Function Halls / Auditoriums",rate:12.25},{id:"startup_power",name:"Startup Power",rate:12.25},{id:"electric_vehicles",name:"Electric Vehicles / Charging Stations",rate:6.7},{id:"green_power",name:"Green Power",rate:12.25}],[c,d]=C.useState(gn(e,s,a)),u=x=>{const y={name:"",rating:0,quantity:1,hours:1};x==="daily"?t([...e,y]):i([...s,y])},h=(x,y)=>{if(x==="daily"){const S=e.filter((b,w)=>w!==y);t(S)}else{const S=s.filter((b,w)=>w!==y);i(S)}},m=(x,y,S,b)=>{if(x==="daily"){const w=[...e];w[y]={...w[y],[S]:b},t(w)}else{const w=[...s];w[y]={...w[y],[S]:b},i(w)}};J.useEffect(()=>{const x=gn(e,s,a);d(x),r&&(e.length>0||s.length>0)&&p(x)},[e,s,a]);const p=async x=>{try{await ae.from("calculation_history").insert({user_id:r==null?void 0:r.id,calculation_type:"commercial",inputs:{dailyAppliances:e,occasionalAppliances:s,commercialType:a},results:x})}catch(y){console.error("Error saving calculation history:",y)}};return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl p-6",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Ds,{className:"h-8 w-8"}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Commercial Energy Calculator"}),n.jsx("p",{className:"text-blue-100",children:"Calculate commercial electricity bills based on your appliances usage and commercial type"})]})]})}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Commercial Usage Type"}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Commercial Category"}),n.jsx("select",{value:a,onChange:x=>o(x.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:l.map(x=>n.jsxs("option",{value:x.id,children:[x.name," ",x.rate>0&&`(${x.rate}/unit)`]},x.id))})]}),n.jsx("div",{className:"flex items-center justify-center",children:n.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:n.jsxs("p",{className:"text-sm text-blue-800",children:[n.jsx("strong",{children:"Selected Rate:"})," ",a==="standard"?"Telescopic Tariff (0-50: 5.40, 51-100: 7.65, 101-300: 9.05, 301-500: 9.60, 500+: 10.15)":`${(j=l.find(x=>x.id===a))==null?void 0:j.rate}/unit`]})})})]})]}),n.jsx(vn,{appliances:e,type:"daily",title:"Daily Appliances",icon:Ds,addAppliance:u,removeAppliance:h,updateAppliance:m}),n.jsx(vn,{appliances:s,type:"occasional",title:"Occasional Appliances",icon:Ye,addAppliance:u,removeAppliance:h,updateAppliance:m}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Bill Summary"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Total Monthly Units:"}),n.jsxs("span",{className:"font-semibold",children:[c.totalUnits.toFixed(2)," kWh"]})]}),n.jsxs("div",{className:"flex justify-between text-lg font-bold text-blue-600",children:[n.jsx("span",{children:"Total Bill:"}),n.jsxs("span",{children:["",c.totalBill.toFixed(2)]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Tariff Breakdown"}),n.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:c.breakdown.map((x,y)=>n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[x.slab," @ ",x.rate]}),n.jsxs("span",{className:"font-semibold",children:["",x.amount.toFixed(2)]})]},y))})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsx(ur,{data:c.breakdown}),n.jsx(hr,{dailyAppliances:e,occasionalAppliances:s})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Commercial Tariff Structure"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-blue-50",children:[n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Consumer Category"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Energy Charges (/Unit)"})]})}),n.jsxs("tbody",{className:"divide-y divide-gray-200",children:[n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:"A(i): Commercial (050 units)"}),n.jsx("td",{className:"px-4 py-2",children:"5.40"})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:"A(i): Commercial (51100 units)"}),n.jsx("td",{className:"px-4 py-2",children:"7.65"})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:"A(i): Commercial (101300 units)"}),n.jsx("td",{className:"px-4 py-2",children:"9.05"})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:"A(i): Commercial (301500 units)"}),n.jsx("td",{className:"px-4 py-2",children:"9.60"})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:"A(i): Commercial (Above 500 units)"}),n.jsx("td",{className:"px-4 py-2",children:"10.15"})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:"Time of Day Tariff (TOD  Peak 6 PM to 10 PM)"}),n.jsx("td",{className:"px-4 py-2",children:""})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:"(ii) Advertising Hoardings"}),n.jsx("td",{className:"px-4 py-2",children:"12.25"})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:"(iii) Function halls / Auditoriums"}),n.jsx("td",{className:"px-4 py-2",children:"12.25"})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:"(B): Startup power"}),n.jsx("td",{className:"px-4 py-2",children:"12.25"})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:"(C): Electric Vehicles / Charging Stations"}),n.jsx("td",{className:"px-4 py-2",children:"6.70"})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:"(D): Green Power"}),n.jsx("td",{className:"px-4 py-2",children:"12.25"})]})]})]})}),n.jsx("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:n.jsxs("p",{className:"text-sm text-blue-800",children:[n.jsx("strong",{children:"Note:"})," Standard Commercial uses telescopic tariff structure. Special categories use flat rates as shown above."]})})]})]})},wn=({appliances:r,type:e,title:t,icon:s,addAppliance:i,removeAppliance:a,updateAppliance:o})=>n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(s,{className:"h-5 w-5 text-orange-500"}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t})]}),n.jsxs("button",{onClick:()=>i(e),className:"flex items-center space-x-2 bg-gradient-to-r from-orange-500 to-red-500 text-white px-4 py-2 rounded-lg hover:shadow-md transition-all duration-200",children:[n.jsx(ar,{className:"h-4 w-4"}),n.jsx("span",{children:"Add Equipment"})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-gray-50",children:[n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Equipment/Machine"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Rating (kW)"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Quantity"}),n.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:["Hours (",e==="daily"?"per day":"per month",")"]}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Energy (kWh)"}),n.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-700",children:"Action"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map((l,c)=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"text",value:l.name,onChange:d=>o(e,c,"name",d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Equipment name"})}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"number",value:l.rating/1e3,onChange:d=>o(e,c,"rating",(parseFloat(d.target.value)||0)*1e3),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",min:"0",step:"0.1"})}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"number",value:l.quantity,onChange:d=>o(e,c,"quantity",parseInt(d.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",min:"1"})}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"number",value:l.hours,onChange:d=>o(e,c,"hours",parseFloat(d.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",min:"0",step:"0.1"})}),n.jsx("td",{className:"px-4 py-3 text-gray-600",children:(l.rating*l.quantity*l.hours/1e3).toFixed(2)}),n.jsx("td",{className:"px-4 py-3 text-center",children:n.jsx("button",{onClick:()=>a(e,c),className:"text-red-500 hover:text-red-700 transition-colors duration-200",children:n.jsx(ns,{className:"h-4 w-4"})})})]},c))})]})})]}),yd=()=>{var H,ee,ne;const{user:r}=we(),[e,t]=C.useState([{name:"Motor (Production)",rating:5e3,quantity:2,hours:8},{name:"Lighting System",rating:500,quantity:10,hours:12},{name:"Ventilation Fan",rating:750,quantity:4,hours:10}]),[s,i]=C.useState([{name:"Heavy Machinery",rating:15e3,quantity:1,hours:40},{name:"Welding Equipment",rating:3e3,quantity:2,hours:20}]),[a,o]=C.useState(0),[l,c]=C.useState("industry_general"),[d,u]=C.useState("LT"),[h,m]=C.useState("normal"),[p,j]=C.useState("high_demand"),x=()=>{const A=e.reduce((me,K)=>me+K.rating*K.quantity*K.hours,0),V=s.reduce((me,K)=>me+K.rating*K.quantity*K.hours,0);return(A*30+V)/1e3},y=x(),[S,b]=C.useState(pn(y,a,l,d,h,p)),w=[{id:"industry_general",name:"A: Industry (General)",description:"General industrial consumers with LT and HT supply options including TOD pricing"},{id:"seasonal_off_season",name:"B: Seasonal Industries (off-season)",description:"Industries operating seasonally during off-season periods"},{id:"energy_intensive",name:"C: Energy Intensive Industries",description:"High energy consumption industries with preferential rates"},{id:"cottage_industries",name:"D: Cottage Industries (up to 10 HP)",description:"Small scale cottage industries - Free for Dhobighats per Government Order"},{id:"industrial_colonies",name:"Industrial Colonies",description:"Industrial residential colonies with special tariff structure"}],E=[{id:"LT",name:"LT Supply",description:"Low Tension Supply",available:["industry_general","seasonal_off_season","energy_intensive","cottage_industries"]},{id:"11kV",name:"11 kV Supply",description:"High Tension 11 kV",available:["industry_general","seasonal_off_season","energy_intensive","industrial_colonies"]},{id:"33kV",name:"33 kV Supply",description:"High Tension 33 kV",available:["industry_general","seasonal_off_season","energy_intensive","industrial_colonies"]},{id:"132kV",name:"132 kV Supply",description:"High Tension 132 kV",available:["industry_general","seasonal_off_season","energy_intensive","industrial_colonies"]},{id:"220kV",name:"220 kV Supply",description:"High Tension 220 kV",available:["industry_general","seasonal_off_season","energy_intensive","industrial_colonies"]}],O=[{id:"peak",name:"Peak Hours",description:"06:00-10:00 & 18:00-22:00",timeSlots:"Morning: 6 AM - 10 AM, Evening: 6 PM - 10 PM"},{id:"off_peak",name:"Off-Peak Hours",description:"10:00-15:00 & 00:00-06:00",timeSlots:"Afternoon: 10 AM - 3 PM, Night: 12 AM - 6 AM"},{id:"normal",name:"Normal Hours",description:"15:00-18:00 & 22:00-24:00",timeSlots:"Evening: 3 PM - 6 PM, Night: 10 PM - 12 AM"}],P=[{id:"high_demand",name:"High Grid Demand",description:"High electricity demand period with higher rates"},{id:"low_demand",name:"Low Grid Demand",description:"Low electricity demand period with preferential rates"}];J.useEffect(()=>{const A=x(),V=pn(A,a,l,d,h,p);b(V),r&&(e.length>0||s.length>0)&&F(V)},[e,s,a,l,d,h,p]);const F=async A=>{try{await ae.from("calculation_history").insert({user_id:r==null?void 0:r.id,calculation_type:"industrial",inputs:{dailyAppliances:e,occasionalAppliances:s,sanctionedLoad:a,category:l,supplyType:d,todType:h,demandType:p},results:A})}catch(V){console.error("Error saving calculation history:",V)}},Ee=()=>l==="industry_general"&&d!=="LT",G=()=>l==="cottage_industries",re=()=>E.filter(A=>A.available.includes(l));J.useEffect(()=>{var V;const A=re();A.some(ie=>ie.id===d)||u(((V=A[0])==null?void 0:V.id)||"LT")},[l]),J.useEffect(()=>{G()&&o(0)},[l]);const M=A=>{const V={name:"",rating:1e3,quantity:1,hours:A==="daily"?8:20};A==="daily"?t([...e,V]):i([...s,V])},I=(A,V)=>{if(A==="daily"){const ie=e.filter((me,K)=>K!==V);t(ie)}else{const ie=s.filter((me,K)=>K!==V);i(ie)}},L=(A,V,ie,me)=>{if(A==="daily"){const K=[...e];K[V]={...K[V],[ie]:me},t(K)}else{const K=[...s];K[V]={...K[V],[ie]:me},i(K)}};return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-xl p-6",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Ls,{className:"h-8 w-8"}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Industrial Energy Calculator"}),n.jsx("p",{className:"text-orange-100",children:"Calculate industrial electricity bills with comprehensive tariff categories and Time of Day pricing"})]})]})}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsxs("h3",{className:"text-lg font-semibold mb-4 text-gray-800 flex items-center",children:[n.jsx(Yc,{className:"h-5 w-5 mr-2 text-orange-500"}),"Industrial Category Selection"]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Industrial Category"}),n.jsx("select",{value:l,onChange:A=>c(A.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:w.map(A=>n.jsx("option",{value:A.id,children:A.name},A.id))}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(H=w.find(A=>A.id===l))==null?void 0:H.description})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Supply Type"}),n.jsx("select",{value:d,onChange:A=>u(A.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent",disabled:G(),children:re().map(A=>n.jsx("option",{value:A.id,children:A.name},A.id))}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(ee=re().find(A=>A.id===d))==null?void 0:ee.description}),G()&&n.jsx("p",{className:"text-sm text-green-600 mt-1 font-medium",children:"Only LT Supply available for Cottage Industries"})]})]})]}),Ee()&&n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsxs("h3",{className:"text-lg font-semibold mb-4 text-gray-800 flex items-center",children:[n.jsx(Ei,{className:"h-5 w-5 mr-2 text-orange-500"}),"Time of Day (TOD) Pricing"]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Demand Type"}),n.jsx("select",{value:p,onChange:A=>j(A.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:P.map(A=>n.jsx("option",{value:A.id,children:A.name},A.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Period"}),n.jsx("select",{value:h,onChange:A=>m(A.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:O.map(A=>n.jsx("option",{value:A.id,children:A.name},A.id))}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(ne=O.find(A=>A.id===h))==null?void 0:ne.timeSlots})]})]})]}),n.jsx(wn,{appliances:e,type:"daily",title:"Daily Industrial Equipment",icon:Ls,addAppliance:M,removeAppliance:I,updateAppliance:L}),n.jsx(wn,{appliances:s,type:"occasional",title:"Occasional/Heavy Equipment",icon:Ye,addAppliance:M,removeAppliance:I,updateAppliance:L}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Bill Summary"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Total Monthly Units:"}),n.jsxs("span",{className:"font-semibold",children:[y.toFixed(2)," kWh"]})]}),n.jsxs("div",{className:"flex justify-between text-lg font-bold text-blue-600",children:[n.jsx("span",{children:"Total Bill:"}),n.jsxs("span",{children:["",S.totalBill.toFixed(2)]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Tariff Breakdown"}),n.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:S.breakdown.map((A,V)=>n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[A.slab," @ ",A.rate]}),n.jsxs("span",{className:"font-semibold",children:["",A.amount.toFixed(2)]})]},V))})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsx(ur,{data:S.breakdown}),n.jsx(hr,{dailyAppliances:e,occasionalAppliances:s})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Industrial Tariff Structure"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-orange-50",children:[n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Consumer Category"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"LT Supply (Rs./Unit)"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"HT Supply (Rs./Unit)"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"11 kV"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"33 kV"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"132 kV"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"220 kV"})]})}),n.jsxs("tbody",{className:"divide-y divide-gray-200",children:[n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:"A: Industry (General)"}),n.jsx("td",{className:"px-4 py-2",children:"6.70"}),n.jsx("td",{className:"px-4 py-2",children:"TOD"}),n.jsx("td",{className:"px-4 py-2",children:"TOD"}),n.jsx("td",{className:"px-4 py-2",children:"TOD"}),n.jsx("td",{className:"px-4 py-2",children:"TOD"}),n.jsx("td",{className:"px-4 py-2",children:"TOD"})]}),n.jsxs("tr",{className:"bg-gray-50",children:[n.jsx("td",{className:"px-4 py-2 pl-6 text-sm",children:"TOD (High Grid Demand)  Peak (0610 & 1822)"}),n.jsx("td",{className:"px-4 py-2",children:""}),n.jsx("td",{className:"px-4 py-2",children:""}),n.jsx("td",{className:"px-4 py-2",children:"7.80"}),n.jsx("td",{className:"px-4 py-2",children:"7.35"}),n.jsx("td",{className:"px-4 py-2",children:"6.90"}),n.jsx("td",{className:"px-4 py-2",children:"6.85"})]}),n.jsxs("tr",{className:"bg-gray-50",children:[n.jsx("td",{className:"px-4 py-2 pl-6 text-sm",children:"TOD (High Grid Demand)  Off-Peak (1015 & 0006)"}),n.jsx("td",{className:"px-4 py-2",children:""}),n.jsx("td",{className:"px-4 py-2",children:""}),n.jsx("td",{className:"px-4 py-2",children:"5.55"}),n.jsx("td",{className:"px-4 py-2",children:"5.10"}),n.jsx("td",{className:"px-4 py-2",children:"4.65"}),n.jsx("td",{className:"px-4 py-2",children:"4.60"})]}),n.jsxs("tr",{className:"bg-gray-50",children:[n.jsx("td",{className:"px-4 py-2 pl-6 text-sm",children:"TOD (High Grid Demand)  Normal (1518 & 2224)"}),n.jsx("td",{className:"px-4 py-2",children:""}),n.jsx("td",{className:"px-4 py-2",children:""}),n.jsx("td",{className:"px-4 py-2",children:"6.30"}),n.jsx("td",{className:"px-4 py-2",children:"5.85"}),n.jsx("td",{className:"px-4 py-2",children:"5.40"}),n.jsx("td",{className:"px-4 py-2",children:"5.35"})]}),n.jsxs("tr",{className:"bg-gray-50",children:[n.jsx("td",{className:"px-4 py-2 pl-6 text-sm",children:"TOD (Low Grid Demand)  Peak (0610 & 1822)"}),n.jsx("td",{className:"px-4 py-2",children:""}),n.jsx("td",{className:"px-4 py-2",children:""}),n.jsx("td",{className:"px-4 py-2",children:"7.30"}),n.jsx("td",{className:"px-4 py-2",children:"7.00"}),n.jsx("td",{className:"px-4 py-2",children:"6.85"}),n.jsx("td",{className:"px-4 py-2",children:"6.80"})]}),n.jsxs("tr",{className:"bg-gray-50",children:[n.jsx("td",{className:"px-4 py-2 pl-6 text-sm",children:"TOD (Low Grid Demand)  Off-Peak (1015 & 0006)"}),n.jsx("td",{className:"px-4 py-2",children:""}),n.jsx("td",{className:"px-4 py-2",children:""}),n.jsx("td",{className:"px-4 py-2",children:"5.55"}),n.jsx("td",{className:"px-4 py-2",children:"5.10"}),n.jsx("td",{className:"px-4 py-2",children:"4.65"}),n.jsx("td",{className:"px-4 py-2",children:"4.60"})]}),n.jsxs("tr",{className:"bg-gray-50",children:[n.jsx("td",{className:"px-4 py-2 pl-6 text-sm",children:"TOD (Low Grid Demand)  Normal (1518 & 2224)"}),n.jsx("td",{className:"px-4 py-2",children:""}),n.jsx("td",{className:"px-4 py-2",children:""}),n.jsx("td",{className:"px-4 py-2",children:"6.30"}),n.jsx("td",{className:"px-4 py-2",children:"5.85"}),n.jsx("td",{className:"px-4 py-2",children:"5.40"}),n.jsx("td",{className:"px-4 py-2",children:"5.35"})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:"B: Seasonal Industries (off-season)"}),n.jsx("td",{className:"px-4 py-2",children:"7.45"}),n.jsx("td",{className:"px-4 py-2",children:"7.65"}),n.jsx("td",{className:"px-4 py-2",children:"7.00"}),n.jsx("td",{className:"px-4 py-2",children:"6.70"}),n.jsx("td",{className:"px-4 py-2",children:"6.65"}),n.jsx("td",{className:"px-4 py-2",children:"6.65"})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:"C: Energy Intensive Industries"}),n.jsx("td",{className:"px-4 py-2",children:"3.75"}),n.jsx("td",{className:"px-4 py-2",children:"5.80"}),n.jsx("td",{className:"px-4 py-2",children:"5.35"}),n.jsx("td",{className:"px-4 py-2",children:"4.95"}),n.jsx("td",{className:"px-4 py-2",children:"4.90"}),n.jsx("td",{className:"px-4 py-2",children:"4.90"})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 font-medium text-orange-700",children:"D: Cottage Industries (up to 10 HP)"}),n.jsx("td",{className:"px-4 py-2 text-green-600 font-bold",children:"Free (Dhobighats - Govt. Order)"}),n.jsx("td",{className:"px-4 py-2",children:""}),n.jsx("td",{className:"px-4 py-2",children:""}),n.jsx("td",{className:"px-4 py-2",children:""}),n.jsx("td",{className:"px-4 py-2",children:""}),n.jsx("td",{className:"px-4 py-2",children:""})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:"Industrial Colonies"}),n.jsx("td",{className:"px-4 py-2",children:""}),n.jsx("td",{className:"px-4 py-2",children:"14.60"}),n.jsx("td",{className:"px-4 py-2",children:"5.35"}),n.jsx("td",{className:"px-4 py-2",children:"7.00"}),n.jsx("td",{className:"px-4 py-2",children:"7.00"}),n.jsx("td",{className:"px-4 py-2",children:"7.00"})]})]})]})}),n.jsxs("div",{className:"mt-4 grid md:grid-cols-2 gap-4",children:[n.jsx("div",{className:"p-4 bg-orange-50 rounded-lg",children:n.jsxs("p",{className:"text-sm text-orange-800",children:[n.jsx("strong",{children:"Fixed Charges:"})," 75 per kW per month for all industrial categories except cottage industries (free)."]})}),n.jsx("div",{className:"p-4 bg-blue-50 rounded-lg",children:n.jsxs("p",{className:"text-sm text-blue-800",children:[n.jsx("strong",{children:"TOD Pricing:"})," Time of Day pricing applies only to Industry (General) with HT supply (11kV, 33kV, 132kV, 220kV)."]})})]})]})]})},bd=()=>{var i;const[r,e]=C.useState("domestic"),t=[{id:"domestic",label:"Domestic",icon:Ti,component:bn},{id:"commercial",label:"Commercial",icon:Ds,component:xd},{id:"industrial",label:"Industrial",icon:Ls,component:yd}],s=((i=t.find(a=>a.id===r))==null?void 0:i.component)||bn;return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"flex flex-wrap gap-2",children:t.map(a=>{const o=a.icon;return n.jsxs("button",{onClick:()=>e(a.id),className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all duration-200 ${r===a.id?"bg-gradient-to-r from-green-500 to-blue-500 text-white shadow-md":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-200"}`,children:[n.jsx(o,{className:"h-4 w-4"}),n.jsx("span",{className:"font-medium",children:a.label})]},a.id)})}),n.jsx(s,{})]})};Bs.register(kn,Sn,Qi,Xi,En,Vs,qs);const vd=({initialInvestment:r,monthlySavings:e,paybackPeriod:t,projectLifetime:s=10})=>{const i=s||Math.ceil(t)+2,a=Math.max(1,i*12),l=Math.max(1,Math.ceil(a/240)),c=J.useMemo(()=>{const p=[];for(let j=1;j<=a;j+=l)p.push(j);return p},[a,l]),d=J.useMemo(()=>c.map(p=>e*p),[c,e]),u=J.useMemo(()=>d.map(p=>p-r),[d,r]),h=J.useMemo(()=>({labels:c.map(p=>`${Math.floor((p-1)/12)}Y ${(p-1)%12}M`),datasets:[{label:"Cumulative Savings ()",data:d,borderColor:"#10B981",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.1,fill:!1},{label:"Initial Investment ()",data:c.map(()=>r),borderColor:"#EF4444",backgroundColor:"rgba(239, 68, 68, 0.1)",borderDash:[5,5],tension:0,fill:!1},{label:"Net Value ()",data:u,borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.1,fill:"origin"}]}),[c,d,u,r]),m={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:`Payback Analysis - Break-even at ${t.toFixed(1)} years (${i}-year project)`,font:{size:16,weight:"bold"}},tooltip:{callbacks:{label:function(p){return`${p.dataset.label}: ${p.parsed.y.toLocaleString()}`}}}},scales:{x:{title:{display:!0,text:"Time Period"},ticks:{maxTicksLimit:12}},y:{title:{display:!0,text:"Amount ()"},ticks:{callback:function(p){return""+p.toLocaleString()}}}},interaction:{intersect:!1}};return n.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:n.jsx("div",{className:"h-96",children:n.jsx(ea,{data:h,options:m})})})},wd=()=>{const{user:r}=we(),[e,t]=C.useState(5e5),[s,i]=C.useState(96e3),[a,o]=C.useState(8e3),[l,c]=C.useState(10),[d,u]=C.useState(8),h=C.useMemo(()=>{if(e>0&&s>0){const y=e/s,S=s*l,b=y,w=s/e*100,E=(S-e)/e*100,O=S-e;return{paybackPeriod:y,totalSavings25Years:S,breakEvenYear:b,annualROI:w,cumulativeROI25Years:E,netProfit25Years:O}}return{paybackPeriod:0,totalSavings25Years:0,breakEvenYear:0,annualROI:0,cumulativeROI25Years:0,netProfit25Years:0}},[e,s,l]);C.useEffect(()=>{if(!r||e<=0||s<=0)return;const y=setTimeout(()=>{x({installationCost:e,annualSaving:s,projectLifetime:l,discountRate:d},h)},800);return()=>clearTimeout(y)},[r,e,s,l,d,h]),C.useEffect(()=>{o(s/12)},[s]);const m=y=>`${y.toLocaleString("en-IN")}`,p=y=>`${y.toFixed(2)}%`,j=y=>y<1?`${(y*12).toFixed(1)} months`:`${y.toFixed(1)} years`;C.useMemo(()=>{const y=[];for(let S=1;S<=l;S++){const b=s*S,w=b-e,E=(b-e)/e*100;y.push({year:S,cumulativeSavings:b,netPosition:w,roi:E,isBreakEven:S>=h.breakEvenYear})}return y},[s,e,h.breakEvenYear,l]);const x=async(y,S)=>{try{await ae.from("estimation_history").insert({user_id:r==null?void 0:r.id,estimation_type:"unified",inputs:y,results:S})}catch(b){console.error("Error saving estimation history:",b)}};return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl p-6",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(lr,{className:"h-8 w-8"}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Unified Solar Investment Estimator"}),n.jsx("p",{className:"text-blue-100",children:"Comprehensive analysis with all financial metrics and visualizations"})]})]})}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsxs("h3",{className:"text-lg font-semibold mb-4 text-gray-800 flex items-center",children:[n.jsx(Zc,{className:"h-5 w-5 mr-2 text-green-500"}),"Investment Parameters"]}),n.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Installation Cost ()"}),n.jsx("input",{type:"number",value:e,onChange:y=>t(parseFloat(y.target.value)||0),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0",placeholder:"Enter installation cost"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Annual Saving ()"}),n.jsx("input",{type:"number",value:s,onChange:y=>i(parseFloat(y.target.value)||0),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0",placeholder:"Enter annual savings"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Lifetime (years)"}),n.jsx("input",{type:"number",value:l,onChange:y=>c(parseInt(y.target.value)||0),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"1",placeholder:"Project lifetime"})]})]}),n.jsxs("div",{className:"mt-6",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Discount Rate (%)"}),n.jsx("input",{type:"number",value:d,onChange:y=>u(parseFloat(y.target.value)||0),className:"w-full md:w-1/3 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0",max:"20",step:"0.1",placeholder:"Discount rate"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-blue-500",children:[n.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[n.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:n.jsx(Ei,{className:"h-6 w-6 text-blue-600"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Payback Period"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:j(h.paybackPeriod)}),n.jsx("div",{className:"text-sm text-gray-600 mb-3",children:"Time to recover investment"}),n.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:n.jsxs("div",{className:"text-sm text-blue-700",children:[n.jsxs("div",{children:["Monthly: ",m(s/12)]}),n.jsxs("div",{children:["Annual: ",m(s)]})]})})]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-green-500",children:[n.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[n.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:n.jsx(Jc,{className:"h-6 w-6 text-green-600"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Cost Benefit"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:m(h.totalSavings25Years)}),n.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:["Total savings over ",l," ",l===1?"year":"years"]}),n.jsx("div",{className:"bg-green-50 p-3 rounded-lg",children:n.jsxs("div",{className:"text-sm text-green-700",children:[n.jsxs("div",{children:["Net Profit: ",m(h.netProfit25Years)]}),n.jsxs("div",{children:["Benefit Ratio: ",(h.totalSavings25Years/e).toFixed(2),":1"]})]})})]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-orange-500",children:[n.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[n.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:n.jsx(id,{className:"h-6 w-6 text-orange-600"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Break-even"})]}),n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"text-3xl font-bold text-orange-600 mb-2",children:["Year ",h.breakEvenYear.toFixed(1)]}),n.jsx("div",{className:"text-sm text-gray-600 mb-3",children:"When savings = investment"}),n.jsx("div",{className:"bg-orange-50 p-3 rounded-lg",children:n.jsxs("div",{className:"text-sm text-orange-700",children:[n.jsxs("div",{children:["Break-even: ",j(h.breakEvenYear)]}),n.jsxs("div",{children:["After: ",m(e)]})]})})]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-purple-500",children:[n.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[n.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:n.jsx(sd,{className:"h-6 w-6 text-purple-600"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Return on Investment"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:p(h.annualROI)}),n.jsx("div",{className:"text-sm text-gray-600 mb-3",children:"Annual return rate"}),n.jsx("div",{className:"bg-purple-50 p-3 rounded-lg",children:n.jsxs("div",{className:"text-sm text-purple-700",children:[n.jsxs("div",{children:["25-year ROI: ",p(h.cumulativeROI25Years)]}),n.jsxs("div",{children:["Net Profit: ",m(h.netProfit25Years)]})]})})]})]})]}),n.jsx("div",{className:"space-y-6",children:n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Payback Period Analysis"}),n.jsx("div",{className:"h-96",children:n.jsx(vd,{initialInvestment:e,monthlySavings:a,paybackPeriod:h.paybackPeriod,projectLifetime:l})})]})}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Investment Timeline Analysis"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Year"}),n.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-700",children:"Annual Savings"}),n.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-700",children:"Cumulative Savings"}),n.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-700",children:"Net Position"}),n.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-700",children:"ROI"})]})}),n.jsx("tbody",{children:[1,2,3,4,5,10,15,20,25].filter(y=>y<=l).map(y=>{const S=s,b=S*y,w=b-e,E=y>=h.breakEvenYear,O=(b-e)/e*100;return n.jsxs("tr",{className:`border-b border-gray-100 ${E?"bg-green-50":""}`,children:[n.jsxs("td",{className:"py-3 px-4 font-medium",children:["Year ",y,E&&y===Math.ceil(h.breakEvenYear)&&n.jsx("span",{className:"ml-2 text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full",children:"Break-even"})]}),n.jsx("td",{className:"py-3 px-4 text-right",children:m(S)}),n.jsx("td",{className:"py-3 px-4 text-right",children:m(b)}),n.jsx("td",{className:`py-3 px-4 text-right font-semibold ${w>=0?"text-green-600":"text-red-600"}`,children:m(w)}),n.jsx("td",{className:`py-3 px-4 text-right ${O>=0?"text-green-600":"text-red-600"}`,children:p(O)})]},y)})})]})})]}),n.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Key Investment Insights"}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),n.jsxs("span",{className:"text-sm text-gray-700",children:[n.jsx("strong",{children:"Payback Period:"})," Your investment will be recovered in ",j(h.paybackPeriod)]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),n.jsxs("span",{className:"text-sm text-gray-700",children:[n.jsxs("strong",{children:[l,"-Year Benefit:"]})," Total savings of ",m(h.totalSavings25Years)," over system lifetime"]})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),n.jsxs("span",{className:"text-sm text-gray-700",children:[n.jsx("strong",{children:"Break-even Point:"})," You'll start profiting from year ",h.breakEvenYear.toFixed(1)]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),n.jsxs("span",{className:"text-sm text-gray-700",children:[n.jsx("strong",{children:"Annual ROI:"})," ",p(h.annualROI)," return on your investment"]})]})]})]})]})]})},jd=()=>n.jsx("div",{className:"space-y-6",children:n.jsx(wd,{})}),jn=()=>{const r=[{category:"Lighting System",icon:zt,color:"yellow",tips:["One of the best energy-saving devices is the light switch. Turn off lights when not required.","Use automatic devices like infrared sensors, motion sensors, timers, dimmers and solar cells to control lighting.","Use task lighting to focus light only where needed instead of lighting entire rooms.","Dirty tube lights and bulbs can absorb up to 50% of light; dust them regularly.","Fluorescent tubes and CFLs are up to 5x more efficient than ordinary bulbs and can save ~70% electricity.","Incandescent bulbs convert ~90% of energy to heat, not light; avoid them.","Replace incandescent bulbs with CFLs/LEDs; CFLs can use up to 75% less electricity.","A 15W CFL can produce the same light as a 60W incandescent bulb."]},{category:"Room Air Conditioners",icon:ad,color:"red",tips:["Use ceiling or table fans first; they cost far less to operate than ACs.","Reduce AC use up to 40% by shading windows and walls; plant trees and shrubs.","Set AC thermostat to 25C; each degree above 22C can save ~35% energy.","Use ceiling or room fans with AC to feel cooler at higher set points.","Cool and dehumidify rooms with timers; a good AC needs ~30 minutes.","Keep doors to air-conditioned rooms closed as often as possible.","Clean AC filters monthly to maintain airflow and efficiency.","Consider replacing old, inefficient ACs; newer models are more efficient over lifecycle."]},{category:"Refrigerators",icon:Ye,color:"blue",tips:["Keep refrigerators away from heat sources like sunlight, ovens, and ranges; check door seals with a flashlight test.","Ensure space around the fridge for airflow; trapped heat increases energy use.","Allow adequate air circulation inside; avoid overpacking.","Plan before opening the door to minimize open time.","Cool and cover hot foods before storing to reduce energy use and condensation.","Keep rubber door seals clean and tight; replace if they fail the paper test.","Clean condenser coils regularly to help the motor run efficiently.","Defrost manual units regularly; ice build-up insulates and reduces cooling power."]},{category:"Water Heater",icon:or,color:"orange",tips:["Insulate hot water pipes, especially in unheated areas (never insulate plastic pipes).","Reduce thermostat from 60C to 50C to save over 18% energy."]},{category:"Microwave Ovens & Electric Kettles",icon:Ye,color:"blue",tips:["Microwaves can cut cooking energy by up to 50% versus conventional ovens for small quantities.","Place larger/thicker items on the outer edge for even microwave cooking.","Use electric kettles for heating water; they are more efficient than cooktops.","Choose kettles with auto shut-off and heat-resistant handles.","Clean kettles regularly with boiling water and vinegar to remove deposits.","Dont overfill kettles; heat only the amount of water needed."]},{category:"Computers",icon:od,color:"green",tips:["Turn off home office equipment when not in use; always-on devices can use significant power.","If leaving computers on, at least turn off the monitor; it uses over half the systems energy.","Enable sleep-mode on computers/monitors/copiers to cut energy by ~40%.","Unplug battery chargers when not charging; they draw power continuously.","Screen savers do not save energy; shutting down reduces wear and saves power."]}],e=s=>({yellow:"bg-yellow-50 border-yellow-200 text-yellow-800",blue:"bg-blue-50 border-blue-200 text-blue-800",red:"bg-red-50 border-red-200 text-red-800",green:"bg-green-50 border-green-200 text-green-800",orange:"bg-orange-50 border-orange-200 text-orange-800"})[s]||"bg-gray-50 border-gray-200 text-gray-800",t=s=>({yellow:"text-yellow-600",blue:"text-blue-600",red:"text-red-600",green:"text-green-600",orange:"text-orange-600"})[s]||"text-gray-600";return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-xl p-6",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(zt,{className:"h-8 w-8"}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Recommendations"}),n.jsx("p",{className:"text-green-100",children:"Expert recommendations to reduce your energy consumption and bills"})]})]})}),n.jsx("div",{className:"grid gap-6",children:r.map((s,i)=>{const a=s.icon;return n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[n.jsx("div",{className:`p-3 rounded-lg ${e(s.color)}`,children:n.jsx(a,{className:`h-6 w-6 ${t(s.color)}`})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:s.category})]}),n.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:s.tips.map((o,l)=>n.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[n.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mt-2 flex-shrink-0"}),n.jsx("p",{className:"text-gray-700 text-sm",children:o})]},l))})]},i)})}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-800",children:"Top Actionable Energy-Saving Wins"}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:"1"}),n.jsx("div",{className:"text-lg font-semibold text-gray-800",children:"Set AC to 25C & Clean Filters"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Each degree above 22C saves ~35%. Clean filters monthly for efficiency."})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"2"}),n.jsx("div",{className:"text-lg font-semibold text-gray-800",children:"Switch to LEDs & Use Sensors"}),n.jsx("p",{className:"text-sm text-gray-600",children:"LEDs/CFLs cut lighting energy up to 70%. Add motion/timer controls."})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:"3"}),n.jsx("div",{className:"text-lg font-semibold text-gray-800",children:"Maintain Refrigerator Seals & Coils"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Tight door seals and clean condenser coils reduce runtime and power use."})]})]})]}),n.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 rounded-xl p-6 border border-blue-200",children:[n.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:"Recommendations"}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-3 text-sm",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("label",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",className:"rounded"}),n.jsx("span",{children:"Switch to LED lighting"})]}),n.jsxs("label",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",className:"rounded"}),n.jsx("span",{children:"Set AC to 24C or higher"})]}),n.jsxs("label",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",className:"rounded"}),n.jsx("span",{children:"Unplug unused electronics"})]}),n.jsxs("label",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",className:"rounded"}),n.jsx("span",{children:"Use ceiling fans with AC"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("label",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",className:"rounded"}),n.jsx("span",{children:"Install window films"})]}),n.jsxs("label",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",className:"rounded"}),n.jsx("span",{children:"Regular AC maintenance"})]}),n.jsxs("label",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",className:"rounded"}),n.jsx("span",{children:"Use timers for water heaters"})]}),n.jsxs("label",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",className:"rounded"}),n.jsx("span",{children:"Consider solar water heating"})]})]})]})]})]})},_d=()=>{const{user:r}=we(),[e,t]=C.useState(6e3),[s,i]=C.useState("domestic"),a=C.useMemo(()=>pd(e,s),[e,s]),o=a.monthlyUnits/30;C.useEffect(()=>{if(r&&e>0){const c=setTimeout(()=>{l({monthlyBill:e,tariffType:s},a)},800);return()=>clearTimeout(c)}},[r,e,s,a]);const l=async(c,d)=>{try{await ae.from("recommendation_history").insert({user_id:r==null?void 0:r.id,recommendation_type:"solar",inputs:c,results:d})}catch(u){console.error("Error saving recommendation history:",u)}};return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-xl p-6",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(or,{className:"h-8 w-8"}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Personalized Solar Recommendations"}),n.jsx("p",{className:"text-yellow-100",children:"Get customized solar solutions based on your electricity bill"})]})]})}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsxs("h3",{className:"text-lg font-semibold mb-4 text-gray-800 flex items-center",children:[n.jsx(Pe,{className:"h-5 w-5 mr-2 text-yellow-500"}),"Your Electricity Details"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tariff Type"}),n.jsxs("select",{value:s,onChange:c=>i(c.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent",children:[n.jsx("option",{value:"domestic",children:"Domestic"}),n.jsx("option",{value:"commercial",children:"Commercial"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Monthly Electricity Bill ()"}),n.jsx("input",{type:"number",value:e,onChange:c=>t(parseFloat(c.target.value)||0),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent",min:"0",placeholder:"Enter your monthly bill amount"})]})]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Recommendation Status"}),n.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-600",children:"Monthly Units (Calculated):"}),n.jsxs("span",{className:"font-semibold text-gray-800",children:[a.monthlyUnits.toFixed(1)," kWh"]})]}),n.jsxs("div",{className:"flex justify-between text-sm mt-1",children:[n.jsx("span",{className:"text-gray-600",children:"Daily Units:"}),n.jsxs("span",{className:"font-semibold text-gray-800",children:[o.toFixed(1)," kWh/day"]})]}),n.jsxs("div",{className:"flex justify-between text-sm mt-1",children:[n.jsx("span",{className:"text-gray-600",children:"Actual Bill (Verified):"}),n.jsxs("span",{className:"font-semibold text-gray-800",children:["",a.actualBill.toFixed(0)]})]}),n.jsxs("div",{className:"text-xs text-gray-500 mt-2 flex items-center",children:[n.jsx(Xc,{className:"h-3 w-3 mr-1"}),"Using accurate ",s," telescopic tariff calculation"]})]}),a.breakdown.length>0&&n.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[n.jsx("h4",{className:"text-sm font-semibold text-blue-800 mb-2",children:"Tariff Breakdown"}),n.jsx("div",{className:"space-y-1",children:a.breakdown.map((c,d)=>n.jsxs("div",{className:"flex justify-between text-xs",children:[n.jsxs("span",{className:"text-blue-600",children:["Units ",c.slab,": ",c.units.toFixed(1)," @ ",c.rate]}),n.jsxs("span",{className:"font-semibold text-blue-800",children:["",c.amount.toFixed(0)]})]},d))})]}),a.recommendSolar?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"text-center p-4 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg",children:[n.jsx("div",{className:"text-2xl font-bold text-orange-600 mb-1",children:" Solar Recommended"}),n.jsx("div",{className:"text-orange-700",children:"Perfect candidate for solar installation"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{className:"bg-green-50 p-3 rounded-lg text-center",children:[n.jsxs("div",{className:"text-lg font-bold text-green-600",children:[a.requiredKW," kW"]}),n.jsx("div",{className:"text-xs text-green-700",children:"System Size"})]}),n.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:[n.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[a.paybackPeriod.toFixed(1)," years"]}),n.jsx("div",{className:"text-xs text-blue-700",children:"Payback Period"})]})]})]}):n.jsxs("div",{className:"text-center p-6 bg-blue-50 rounded-lg",children:[n.jsx("div",{className:"text-lg font-semibold text-blue-800 mb-2",children:"Solar Not Recommended"}),n.jsxs("div",{className:"text-blue-700",children:["Your monthly bill is ",e.toLocaleString(),". Solar is typically cost-effective for bills above 4,000/month."]})]})]})]}),a.recommendSolar&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[n.jsx(Ye,{className:"h-5 w-5 text-yellow-500"}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"System Specifications"})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Required Capacity:"}),n.jsxs("span",{className:"font-semibold",children:[a.requiredKW," kW"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Monthly Generation:"}),n.jsxs("span",{className:"font-semibold",children:[a.estimatedGeneration.toFixed(0)," kWh"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Monthly Consumption:"}),n.jsxs("span",{className:"font-semibold",children:[a.monthlyUnits.toFixed(1)," kWh"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"System Type:"}),n.jsx("span",{className:"font-semibold",children:"Grid-tied"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Panel Type:"}),n.jsx("span",{className:"font-semibold",children:"Monocrystalline"})]})]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[n.jsx(lr,{className:"h-5 w-5 text-green-500"}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Financial Benefits"})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"System Size:"}),n.jsxs("span",{className:"font-semibold",children:[a.requiredKW," kW"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Investment Cost:"}),n.jsxs("span",{className:"font-semibold",children:["",a.investment.toLocaleString()]})]}),a.costRange&&n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600 text-sm",children:"Cost Range:"}),n.jsx("span",{className:"font-semibold text-sm text-blue-600",children:a.costRange})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Monthly Savings:"}),n.jsxs("span",{className:"font-semibold text-green-600",children:["",a.savings.toFixed(0)]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Current Bill:"}),n.jsxs("span",{className:"font-semibold",children:["",a.actualBill.toFixed(0)]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Post-Solar Bill:"}),n.jsxs("span",{className:"font-semibold text-green-600",children:["",(a.actualBill-a.savings).toFixed(0)]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Annual Savings:"}),n.jsxs("span",{className:"font-semibold text-green-600",children:["",(a.savings*12).toLocaleString()]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"25-year Savings:"}),n.jsxs("span",{className:"font-semibold text-green-600",children:["",(a.savings*12*25).toLocaleString("en-IN")]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:"Environmental Impact"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-green-600",children:"CO2 Reduction/Year"}),n.jsxs("div",{className:"font-bold text-green-800",children:[(a.estimatedGeneration*12*.82).toFixed(0)," kg"]})]}),n.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-blue-600",children:"Trees Equivalent"}),n.jsxs("div",{className:"font-bold text-blue-800",children:[Math.round(a.estimatedGeneration*12*.82/22)," trees"]})]}),n.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-purple-600",children:"Coal Offset/Year"}),n.jsxs("div",{className:"font-bold text-purple-800",children:[(a.estimatedGeneration*12*.4).toFixed(0)," kg"]})]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Installation Guidelines"}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Site Requirements"}),n.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[n.jsx("li",{children:" South-facing roof with minimal shading"}),n.jsxs("li",{children:[" Roof area: ",(a.requiredKW*80).toFixed(0)," sq ft minimum"]}),n.jsx("li",{children:" Roof age: Less than 10 years preferred"}),n.jsx("li",{children:" Structural capacity: 15-20 kg/sq meter"}),n.jsx("li",{children:" Clear access for maintenance"})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Next Steps"}),n.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[n.jsx("li",{children:" Get professional site assessment"}),n.jsx("li",{children:" Obtain multiple quotes from certified installers"}),n.jsx("li",{children:" Check for government subsidies and net metering"}),n.jsx("li",{children:" Ensure proper permits and approvals"}),n.jsx("li",{children:" Plan for system monitoring and maintenance"})]})]})]})]}),n.jsxs("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 rounded-xl p-6 border border-yellow-200",children:[n.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-800",children:"Government Incentives"}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold text-orange-800",children:"Central Government Subsidy"}),n.jsx("div",{className:"text-sm text-orange-700",children:"Up to 40% subsidy for residential systems up to 3kW"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold text-yellow-800",children:"Net Metering Benefits"}),n.jsx("div",{className:"text-sm text-yellow-700",children:"Sell excess power back to the grid at attractive rates"})]})]})]})]})]})},Nd=()=>{var i;const[r,e]=C.useState("general"),t=[{id:"general",label:"General Tips",icon:zt,component:jn},{id:"solar",label:"Solar Analysis",icon:or,component:_d}],s=((i=t.find(a=>a.id===r))==null?void 0:i.component)||jn;return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"flex gap-2",children:t.map(a=>{const o=a.icon;return n.jsxs("button",{onClick:()=>e(a.id),className:`flex items-center space-x-2 px-6 py-3 rounded-lg transition-all duration-200 ${r===a.id?"bg-gradient-to-r from-yellow-500 to-orange-500 text-white shadow-md":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-200"}`,children:[n.jsx(o,{className:"h-5 w-5"}),n.jsx("span",{className:"font-medium",children:a.label})]},a.id)})}),n.jsx(s,{})]})},kd=()=>{const{user:r}=we(),[e,t]=C.useState("calculations"),[s,i]=C.useState([]),[a,o]=C.useState([]),[l,c]=C.useState([]),[d,u]=C.useState(!0),[h,m]=C.useState(null);C.useEffect(()=>{r&&(p(),j(),x())},[r]);const p=async()=>{try{const{data:b,error:w}=await ae.from("calculation_history").select("*").eq("user_id",r==null?void 0:r.id).order("created_at",{ascending:!1});if(w)throw w;i(b||[])}catch(b){console.error("Error fetching calculation history:",b)}finally{u(!1)}},j=async()=>{try{const{data:b,error:w}=await ae.from("estimation_history").select("*").eq("user_id",r==null?void 0:r.id).order("created_at",{ascending:!1});if(w)throw w;o(b||[])}catch(b){console.error("Error fetching estimation history:",b)}},x=async()=>{try{const{data:b,error:w}=await ae.from("recommendation_history").select("*").eq("user_id",r==null?void 0:r.id).order("created_at",{ascending:!1});if(w)throw w;c(b||[])}catch(b){console.error("Error fetching recommendation history:",b)}},y=async b=>{try{const{error:w}=await ae.from("calculation_history").delete().eq("id",b);if(w)throw w;i(s.filter(E=>E.id!==b))}catch(w){console.error("Error deleting history item:",w)}},S=b=>{switch(b){case"domestic":return"bg-green-100 text-green-800";case"commercial":return"bg-blue-100 text-blue-800";case"industrial":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}};return d?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-xl p-6",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(Pe,{className:"h-8 w-8"}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"History"}),n.jsx("p",{className:"text-green-100",children:"View and manage your past calculations, estimations, and recommendations"})]})]})}),n.jsxs("div",{className:"bg-white rounded-xl shadow p-2 flex space-x-2",children:[n.jsx("button",{onClick:()=>t("calculations"),className:`px-4 py-2 rounded-lg text-sm font-medium ${e==="calculations"?"bg-green-600 text-white":"bg-gray-100 text-gray-800"}`,children:"Calculations"}),n.jsx("button",{onClick:()=>t("estimations"),className:`px-4 py-2 rounded-lg text-sm font-medium ${e==="estimations"?"bg-green-600 text-white":"bg-gray-100 text-gray-800"}`,children:"Estimations"}),n.jsx("button",{onClick:()=>t("recommendations"),className:`px-4 py-2 rounded-lg text-sm font-medium ${e==="recommendations"?"bg-green-600 text-white":"bg-gray-100 text-gray-800"}`,children:"Recommendations"})]}),e==="calculations"&&(s.length===0?n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[n.jsx(Pe,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No calculations yet"}),n.jsx("p",{className:"text-gray-600",children:"Start by creating your first energy calculation!"})]}):n.jsx("div",{className:"grid gap-4",children:s.map(b=>{var w,E,O,P,F,Ee,G,re;return n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Pe,{className:"h-5 w-5 text-gray-500"}),n.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${S(b.calculation_type)}`,children:b.calculation_type.charAt(0).toUpperCase()+b.calculation_type.slice(1)})]}),n.jsxs("div",{className:"flex items-center space-x-2 text-gray-500",children:[n.jsx(vs,{className:"h-4 w-4"}),n.jsx("span",{className:"text-sm",children:new Date(b.created_at).toLocaleDateString()})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>m(b),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200",children:n.jsx(ws,{className:"h-4 w-4"})}),n.jsx("button",{onClick:()=>y(b.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200",children:n.jsx(ns,{className:"h-4 w-4"})})]})]}),n.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Total Units"}),n.jsxs("div",{className:"font-semibold",children:[((E=(w=b.results)==null?void 0:w.totalUnits)==null?void 0:E.toFixed(2))||"N/A"," kWh"]})]}),n.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Total Bill"}),n.jsxs("div",{className:"font-semibold text-green-600",children:["",((P=(O=b.results)==null?void 0:O.totalBill)==null?void 0:P.toFixed(2))||"N/A"]})]}),b.calculation_type!=="domestic"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Fixed Charges"}),n.jsxs("div",{className:"font-semibold",children:["",((Ee=(F=b.results)==null?void 0:F.fixedCharge)==null?void 0:Ee.toFixed(2))||"N/A"]})]}),n.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Energy Charges"}),n.jsxs("div",{className:"font-semibold",children:["",((re=(G=b.results)==null?void 0:G.energyCharge)==null?void 0:re.toFixed(2))||"N/A"]})]})]})]})]},b.id)})})),e==="estimations"&&(a.length===0?n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[n.jsx(Pe,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No estimations yet"}),n.jsx("p",{className:"text-gray-600",children:"Run the Unified Estimator to generate history."})]}):n.jsx("div",{className:"grid gap-4",children:a.map(b=>{var w,E,O,P,F;return n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Pe,{className:"h-5 w-5 text-gray-500"}),n.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-purple-100 text-purple-800",children:b.estimation_type})]}),n.jsxs("div",{className:"flex items-center space-x-2 text-gray-500",children:[n.jsx(vs,{className:"h-4 w-4"}),n.jsx("span",{className:"text-sm",children:new Date(b.created_at).toLocaleDateString()})]})]}),n.jsx("div",{className:"flex items-center space-x-2",children:n.jsx("button",{onClick:()=>m(b),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200",children:n.jsx(ws,{className:"h-4 w-4"})})})]}),n.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Payback Period"}),n.jsxs("div",{className:"font-semibold",children:[((E=(w=b.results)==null?void 0:w.paybackPeriod)==null?void 0:E.toFixed(2))||"N/A"," years"]})]}),n.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Total Savings (25y)"}),n.jsxs("div",{className:"font-semibold text-green-600",children:["",((F=(P=(O=b.results)==null?void 0:O.totalSavings25Years)==null?void 0:P.toLocaleString)==null?void 0:F.call(P))||"N/A"]})]})]})]},b.id)})})),e==="recommendations"&&(l.length===0?n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[n.jsx(Pe,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No recommendations yet"}),n.jsx("p",{className:"text-gray-600",children:"Use the Solar Recommendations tool to generate history."})]}):n.jsx("div",{className:"grid gap-4",children:l.map(b=>{var w,E,O,P;return n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Pe,{className:"h-5 w-5 text-gray-500"}),n.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800",children:b.recommendation_type})]}),n.jsxs("div",{className:"flex items-center space-x-2 text-gray-500",children:[n.jsx(vs,{className:"h-4 w-4"}),n.jsx("span",{className:"text-sm",children:new Date(b.created_at).toLocaleDateString()})]})]}),n.jsx("div",{className:"flex items-center space-x-2",children:n.jsx("button",{onClick:()=>m(b),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200",children:n.jsx(ws,{className:"h-4 w-4"})})})]}),n.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Required kW"}),n.jsxs("div",{className:"font-semibold",children:[((w=b.results)==null?void 0:w.requiredKW)||"N/A"," kW"]})]}),n.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Monthly Savings"}),n.jsxs("div",{className:"font-semibold text-green-600",children:["",((P=(O=(E=b.results)==null?void 0:E.savings)==null?void 0:O.toFixed)==null?void 0:P.call(O,0))||"N/A"]})]})]})]},b.id)})})),h&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:n.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Details"}),n.jsx("button",{onClick:()=>m(null),className:"text-gray-500 hover:text-gray-700",children:""})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Type"}),n.jsx("div",{className:"font-semibold capitalize",children:h.calculation_type||h.estimation_type||h.recommendation_type})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-600",children:"Date"}),n.jsx("div",{className:"font-semibold",children:new Date(h.created_at).toLocaleString()})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Inputs"}),n.jsx("pre",{className:"bg-gray-50 p-3 rounded-lg text-sm overflow-x-auto",children:JSON.stringify(h.inputs,null,2)})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Results"}),n.jsx("pre",{className:"bg-gray-50 p-3 rounded-lg text-sm overflow-x-auto",children:JSON.stringify(h.results,null,2)})]})]})]})})})]})},Sd=()=>{const{user:r,isAdmin:e}=we(),[t,s]=C.useState([]),[i,a]=C.useState(!0);C.useState(null),C.useState({tariff_type:"domestic",tariff_data:{}}),C.useEffect(()=>{e&&o()},[e]);const o=async()=>{try{const{data:l,error:c}=await ae.from("tariff_settings").select("*").order("updated_at",{ascending:!1});if(c)throw c;s(l||[])}catch(l){console.error("Error fetching tariffs:",l)}finally{a(!1)}};return e?i?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"bg-gradient-to-r from-red-500 to-pink-500 text-white rounded-xl p-6",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx(un,{className:"h-8 w-8"}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Tariff Management"}),n.jsx("p",{className:"text-red-100",children:"Manage electricity tariff rates and structures"})]})]})}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Domestic Tariff Slabs"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-green-50",children:[n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Units Range"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Rate (/kWh)"}),n.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-700",children:"Actions"})]})}),n.jsxs("tbody",{className:"divide-y divide-gray-200",children:[n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2",children:"0-30"}),n.jsx("td",{className:"px-4 py-2",children:"1.90"}),n.jsx("td",{className:"px-4 py-2 text-center",children:n.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:n.jsx(de,{className:"h-4 w-4"})})})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2",children:"31-75"}),n.jsx("td",{className:"px-4 py-2",children:"3.00"}),n.jsx("td",{className:"px-4 py-2 text-center",children:n.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:n.jsx(de,{className:"h-4 w-4"})})})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2",children:"76-125"}),n.jsx("td",{className:"px-4 py-2",children:"4.50"}),n.jsx("td",{className:"px-4 py-2 text-center",children:n.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:n.jsx(de,{className:"h-4 w-4"})})})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2",children:"126-225"}),n.jsx("td",{className:"px-4 py-2",children:"6.00"}),n.jsx("td",{className:"px-4 py-2 text-center",children:n.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:n.jsx(de,{className:"h-4 w-4"})})})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2",children:"226-400"}),n.jsx("td",{className:"px-4 py-2",children:"8.75"}),n.jsx("td",{className:"px-4 py-2 text-center",children:n.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:n.jsx(de,{className:"h-4 w-4"})})})]}),n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2",children:"400"}),n.jsx("td",{className:"px-4 py-2",children:"9.75"}),n.jsx("td",{className:"px-4 py-2 text-center",children:n.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:n.jsx(de,{className:"h-4 w-4"})})})]})]})]})})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Commercial Tariff Structure"}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Fixed Charges"}),n.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{children:"Fixed Charge Rate:"}),n.jsx("span",{className:"font-semibold",children:"75/kW/month"}),n.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:n.jsx(de,{className:"h-4 w-4"})})]})})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Energy Charges"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-2 rounded",children:[n.jsx("span",{className:"text-sm",children:"0-50 units:"}),n.jsx("span",{className:"font-semibold",children:"5.40/kWh"}),n.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:n.jsx(de,{className:"h-4 w-4"})})]}),n.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-2 rounded",children:[n.jsx("span",{className:"text-sm",children:"51-100 units:"}),n.jsx("span",{className:"font-semibold",children:"7.65/kWh"}),n.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:n.jsx(de,{className:"h-4 w-4"})})]}),n.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-2 rounded",children:[n.jsx("span",{className:"text-sm",children:"101-300 units:"}),n.jsx("span",{className:"font-semibold",children:"9.05/kWh"}),n.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:n.jsx(de,{className:"h-4 w-4"})})]}),n.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-2 rounded",children:[n.jsx("span",{className:"text-sm",children:"301-500 units:"}),n.jsx("span",{className:"font-semibold",children:"9.60/kWh"}),n.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:n.jsx(de,{className:"h-4 w-4"})})]}),n.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-2 rounded",children:[n.jsx("span",{className:"text-sm",children:"500 units:"}),n.jsx("span",{className:"font-semibold",children:"10.15/kWh"}),n.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:n.jsx(de,{className:"h-4 w-4"})})]})]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Industrial Tariff Structure"}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsx("div",{className:"bg-orange-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"font-medium",children:"Fixed Charges:"}),n.jsx("span",{className:"font-semibold",children:"75/kW/month"}),n.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:n.jsx(de,{className:"h-4 w-4"})})]})}),n.jsx("div",{className:"bg-red-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"font-medium",children:"Energy Charges:"}),n.jsx("span",{className:"font-semibold",children:"6.70/kWh"}),n.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:n.jsx(de,{className:"h-4 w-4"})})]})})]})]}),n.jsx("div",{className:"flex justify-end",children:n.jsxs("button",{className:"flex items-center space-x-2 bg-gradient-to-r from-green-500 to-blue-500 text-white px-6 py-3 rounded-lg hover:shadow-md transition-all duration-200",children:[n.jsx(rd,{className:"h-5 w-5"}),n.jsx("span",{children:"Save All Changes"})]})}),n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Recent Tariff Changes"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Domestic Slab 1 Rate Updated"}),n.jsx("div",{className:"text-sm text-gray-500",children:"Changed from 1.85 to 1.90"})]}),n.jsx("div",{className:"text-sm text-gray-500",children:"2 days ago"})]}),n.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Commercial Fixed Charge Updated"}),n.jsx("div",{className:"text-sm text-gray-500",children:"Changed from 70 to 75 per kW"})]}),n.jsx("div",{className:"text-sm text-gray-500",children:"1 week ago"})]})]})]})]}):n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[n.jsx("div",{className:"text-red-500 mb-4",children:n.jsx(un,{className:"h-16 w-16 mx-auto"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Access Denied"}),n.jsx("p",{className:"text-gray-600",children:"You need admin privileges to access this page."})]})};function Ed(){return n.jsx(Sl,{children:n.jsx(Hi,{children:n.jsxs(Gi,{children:[n.jsx(je,{path:"/login",element:n.jsx(cd,{})}),n.jsx(je,{path:"/register",element:n.jsx(ud,{})}),n.jsxs(je,{path:"/dashboard",element:n.jsx(Br,{children:n.jsx(hd,{})}),children:[n.jsx(je,{index:!0,element:n.jsx(Dt,{to:"/dashboard/calculations",replace:!0})}),n.jsx(je,{path:"calculations",element:n.jsx(bd,{})}),n.jsx(je,{path:"estimations",element:n.jsx(jd,{})}),n.jsx(je,{path:"recommendations",element:n.jsx(Nd,{})}),n.jsx(je,{path:"history",element:n.jsx(kd,{})}),n.jsx(je,{path:"admin",element:n.jsx(Br,{requireAdmin:!0,children:n.jsx(Sd,{})})})]}),n.jsx(je,{path:"/",element:n.jsx(Dt,{to:"/dashboard",replace:!0})})]})})})}On(document.getElementById("root")).render(n.jsx(C.StrictMode,{children:n.jsx(Ed,{})}));
